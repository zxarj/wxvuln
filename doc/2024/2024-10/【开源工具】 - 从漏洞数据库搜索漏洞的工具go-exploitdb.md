#  ã€å¼€æºå·¥å…·ã€‘ - ä»æ¼æ´æ•°æ®åº“æœç´¢æ¼æ´çš„å·¥å…·go-exploitdb   
åŸåˆ› å®¬å®¤å¸é˜  åŸ‹è—é…±æ²¹ç“¶   2024-10-18 20:27  
  
# ã€å¼€æºå·¥å…·ã€‘ - ä»æ¼æ´æ•°æ®åº“æœç´¢æ¼æ´çš„å·¥å…·go-exploitdb  
## ã€ğŸ””ã€‘äº’è”ç½‘èµ„æ–™/å·¥å…·ï¼Œå®‰å…¨æ€§æœªçŸ¥ï¼Œéœ€è¦è‡ªè¡Œç ”åˆ¤å®‰å…¨æ€§ã€‚  
  
è¿™æ˜¯ä¸€ä¸ªä»æŸäº›æ¼æ´æ•°æ®åº“ä¸­æœç´¢æ¼æ´çš„å·¥å…·ã€‚æ¼æ´è¢«æ’å…¥åˆ° sqlite æ•°æ®åº“ï¼ˆgo-exploitdbï¼‰ä¸­ï¼Œå¯ä»¥é€šè¿‡å‘½ä»¤è¡Œç•Œé¢è¿›è¡Œæœç´¢ã€‚åœ¨æœåŠ¡å™¨æ¨¡å¼ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ç®€å•çš„Web APIã€‚å¦‚ä»¥ä¸‹æ¼æ´æ•°æ®åº“:  
1. ExploitDB(OffectiveSecurity) é€šè¿‡ CVE ç¼–å·æˆ–æ¼æ´åˆ©ç”¨æ•°æ®åº“ IDã€‚  
  
1. GitHub å­˜å‚¨åº“  
  
1. å¾ˆæ£’çš„ Cve Poc  
  
1. inTheWild DB  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/aOiar7mEUNlqwkRNMZBRvTNFUjIPoGeRUhBpG0eShNscpC0OwebHywWib9WnPIBe47nmyLHKTaTE21kM9dCOIyZA/640?wx_fmt=png&from=appmsg "")  
### Docker éƒ¨ç½²  
  
æœ‰ä¸€ä¸ªå¯ç”¨çš„ Docker é•œåƒâ€œdocker pull vulsio/go-exploitdbâ€ã€‚ä½¿ç”¨å®¹å™¨æ—¶ï¼Œå®ƒé‡‡ç”¨ä¸æ™®é€šå‘½ä»¤è¡Œç›¸åŒçš„å‚æ•°ã€‚  
### æœ¬åœ°éƒ¨ç½²å®‰è£…  
#### è¦æ±‚  
  
go-exploitdb éœ€è¦ä»¥ä¸‹è½¯ä»¶åŒ…ã€‚  
- git  
  
- SQLite3ã€MySQLã€PostgreSQLã€Redis  
  
- æœ€æ–°ç‰ˆæœ¬çš„go  
  
- https://golang.org/doc/installd  
  
#### å®‰è£… go-exploitdb  
```
$ mkdir -p $GOPATH/src/github.com/vulsio
$ cd $GOPATH/src/github.com/vulsio
$ git clone https://github.com/vulsio/go-exploitdb.git
$ cd go-exploitdb
$ make install

```  
### ç”¨æ³•ï¼šè·å–å’Œæ’å…¥exp  
```
$ go-exploitdb fetch --help
Fetch the data of exploit

Usage:
  go-exploitdb fetch [command]

Available Commands:
  awesomepoc  Fetch the data of Awesome Poc
  exploitdb   Fetch the data of offensive security exploit db
  githubrepos Fetch the data of github repos
  inthewild   Fetch the data of inTheWild Poc

Flags:
      --batch-size int   The number of batch size to insert. (default 500)
  -h, --help             help for fetch

Global Flags:
      --config string       config file (default is $HOME/.go-exploitdb.yaml)
      --dbpath string       /path/to/sqlite3 or SQL connection string
      --dbtype string       Database type to store data in (sqlite3, mysql, postgres or redis supported)
      --debug               debug mode (default: false)
      --debug-sql           SQL debug mode
      --http-proxy string   http://proxy-url:port (default: empty)
      --log-dir string      /path/to/log
      --log-json            output log as JSON
      --log-to-file         output log to file

Use "go-exploitdb fetch [command] --help" for more information about a command.

```  
#### è·å–å¹¶æ’å…¥Offensive Security ExploitDB  
```
$ go-exploitdb fetch exploitdb
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/aOiar7mEUNlqwkRNMZBRvTNFUjIPoGeRUWYQFmuYswSc6SpnlUicpyODKeryiaXFJxlvdib9nCbKoKLAaT25FwHNHQ/640?wx_fmt=png&from=appmsg "")  
### ç”¨æ³•ï¼šæœç´¢exp  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/aOiar7mEUNlqwkRNMZBRvTNFUjIPoGeRUOLib5RYF0lHiaazLxSy19Chn2KwsQZN9UeS39iaOjR5DibyLMsbxGeWiczg/640?wx_fmt=png&from=appmsg "")  
```
$ go-exploitdb search -h

Search the data of exploit

Usage:
  go-exploitdb search [flags]

Flags:
  -h, --help            help for search
      --param string   All Exploits: None  |  by CVE: [CVE-xxxx]  | by ID: [xxxx]  (default: None)
      --type string    All Exploits by CVE: CVE  |  by ID: ID (default: CVE)

Global Flags:
      --config string       config file (default is $HOME/.go-exploitdb.yaml)
      --dbpath string       /path/to/sqlite3 or SQL connection string
      --dbtype string       Database type to store data in (sqlite3, mysql, postgres or redis supported)
      --debug               debug mode (default: false)
      --debug-sql           SQL debug mode
      --http-proxy string   http://proxy-url:port (default: empty)
      --log-dir string      /path/to/log
      --log-json            output log as JSON
      --log-to-file         output log to file

```  
#### é€šè¿‡ CVE æœç´¢æ¼æ´ï¼ˆä¾‹å¦‚ CVE-2009-4091ï¼‰  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/aOiar7mEUNlqwkRNMZBRvTNFUjIPoGeRUWYQFmuYswSc6SpnlUicpyODKeryiaXFJxlvdib9nCbKoKLAaT25FwHNHQ/640?wx_fmt=png&from=appmsg "")  
```
$ go-exploitdb search --type CVE --param CVE-2009-4091

Results:
---------------------------------------

[*]CVE-ExploitID Reference:
  CVE: CVE-2009-4091
  Exploit Type: OffensiveSecurity
  Exploit Unique ID: 10180
  URL: https://www.exploit-db.com/exploits/10180
  Description: Simplog 0.9.3.2 - Multiple Vulnerabilities

[*]Exploit Detail Info:
  [*]OffensiveSecurity:
  - Document:
    Path: https://gitlab.com/exploit-database/exploitdb/-/tree/main/exploits/php/webapps/10180.txt
    File Type: webapps
---------------------------------------

```  
#### é€šè¿‡ ExploitDB-ID æœç´¢æ¼æ´ï¼ˆä¾‹å¦‚ ExploitDB-IDï¼š10180ï¼‰  
```
$ go-exploitdb search --type ID --param 10180

Results:
---------------------------------------

[*]CVE-ExploitID Reference:
  CVE: CVE-2009-4091
  Exploit Type: OffensiveSecurity
  Exploit Unique ID: 10180
  URL: https://www.exploit-db.com/exploits/10180
  Description: Simplog 0.9.3.2 - Multiple Vulnerabilities

[*]Exploit Detail Info:
  [*]OffensiveSecurity:
  - Document:
    Path: https://gitlab.com/exploit-database/exploitdb/-/tree/main/exploits/php/webapps/10180.txt
    File Type: webapps
---------------------------------------

[*]CVE-ExploitID Reference:
  CVE: CVE-2009-4092
  Exploit Type: OffensiveSecurity
  Exploit Unique ID: 10180
  URL: https://www.exploit-db.com/exploits/10180
  Description: Simplog 0.9.3.2 - Multiple Vulnerabilities

[*]Exploit Detail Info:
  [*]OffensiveSecurity:
  - Document:
    Path: https://gitlab.com/exploit-database/exploitdb/-/tree/main/exploits/php/webapps/10180.txt
    File Type: webapps
---------------------------------------

[*]CVE-ExploitID Reference:
  CVE: CVE-2009-4093
  Exploit Type: OffensiveSecurity
  Exploit Unique ID: 10180
  URL: https://www.exploit-db.com/exploits/10180
  Description: Simplog 0.9.3.2 - Multiple Vulnerabilities

[*]Exploit Detail Info:
  [*]OffensiveSecurity:
  - Document:
    Path: https://gitlab.com/exploit-database/exploitdb/-/tree/main/exploits/php/webapps/10180.txt
    File Type: webapps
---------------------------------------

```  
### ç”¨æ³•ï¼šä»¥æœåŠ¡å™¨æ¨¡å¼å¯åŠ¨ go-exploitdb  
```
$ go-exploitdb server -h

Start go-exploitdb HTTP server

Usage:
  go-exploitdb server [flags]

Flags:
      --bind string   HTTP server bind to IP address (default: loop back interface
  -h, --help          help for server
      --port string   HTTP server port number (default: 1326

Global Flags:
      --config string       config file (default is $HOME/.go-exploitdb.yaml)
      --dbpath string       /path/to/sqlite3 or SQL connection string
      --dbtype string       Database type to store data in (sqlite3, mysql, postgres or redis supported)
      --debug               debug mode (default: false)
      --debug-sql           SQL debug mode
      --http-proxy string   http://proxy-url:port (default: empty)
      --log-dir string      /path/to/log
      --log-json            output log as JSON
      --log-to-file         output log to file

```  
#### å¯åŠ¨æœåŠ¡å™¨  
```
$ go-exploitdb server
INFO[09-30|15:05:57] Starting HTTP Server...
INFO[09-30|15:05:57] Listening...                             URL=127.0.0.1:1326

```  
#### æœç´¢ CURL è·å–çš„ CVE æ¼æ´ï¼ˆä¾‹å¦‚ CVE-2006-2896ï¼‰  
```
$ curl http://127.0.0.1:1326/cves/CVE-2006-2896 | jq

  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:100   666  100   666    0     0  39340      0 --:--:-- --:--:-- --:--:-- 41625
[
  {
    "ID": 325173,
    "exploit_type": "OffensiveSecurity",
    "exploit_unique_id": "1875",
    "url": "https://www.exploit-db.com/exploits/1875",
    "description": "FunkBoard CF0.71 - 'profile.php' Remote User Pass Change",
    "cve_id": "CVE-2006-2896",
    "offensive_security": {
      "ID": 325173,
      "ExploitID": 325173,
      "exploit_unique_id": "1875",
      "document": {
        "OffensiveSecurityID": 325173,
        "exploit_unique_id": "1875",
        "document_url": "https://gitlab.com/exploit-database/exploitdb/-/tree/main/exploits/php/webapps/1875.html",
        "description": "FunkBoard CF0.71 - 'profile.php' Remote User Pass Change",
        "date": "0001-01-01T00:00:00Z",
        "author": "ajann",
        "type": "webapps",
        "platform": "php",
        "port": ""
      },
      "shell_code": null,
    }
  }
]

```  
#### é€šè¿‡å”¯ä¸€ ID æœç´¢æ¼æ´ï¼ˆä¾‹å¦‚æ¼æ´å”¯ä¸€ IDï¼š10180ï¼‰  
```
$ curl http://127.0.0.1:1326/id/10180 | jq
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:100  1936  100  1936    0     0  52643      0 --:--:-- --:--:-- --:--:-- 53777
[
  {
    "ID": 334917,
    "exploit_type": "OffensiveSecurity",
    "exploit_unique_id": "10180",
    "url": "https://www.exploit-db.com/exploits/10180",
    "description": "Simplog 0.9.3.2 - Multiple Vulnerabilities",
    "cve_id": "CVE-2009-4091",
    "offensive_security": {
      "ID": 334917,
      "ExploitID": 334917,
      "exploit_unique_id": "10180",
      "document": {
        "OffensiveSecurityID": 334917,
        "exploit_unique_id": "10180",
        "document_url": "https://gitlab.com/exploit-database/exploitdb/-/tree/main/exploits/php/webapps/10180.txt",
        "description": "Simplog 0.9.3.2 - Multiple Vulnerabilities",
        "date": "0001-01-01T00:00:00Z",
        "author": "Amol Naik",
        "type": "webapps",
        "platform": "php",
        "port": ""
      },
      "shell_code": null,
    }
  },
  {
    "ID": 334918,
    "exploit_type": "OffensiveSecurity",
    "exploit_unique_id": "10180",
    "url": "https://www.exploit-db.com/exploits/10180",
    "description": "Simplog 0.9.3.2 - Multiple Vulnerabilities",
    "cve_id": "CVE-2009-4092",
    "offensive_security": {
      "ID": 334917,
      "ExploitID": 334917,
      "exploit_unique_id": "10180",
      "document": {
        "OffensiveSecurityID": 334917,
        "exploit_unique_id": "10180",
        "document_url": "https://gitlab.com/exploit-database/exploitdb/-/tree/main/exploits/php/webapps/10180.txt",
        "description": "Simplog 0.9.3.2 - Multiple Vulnerabilities",
        "date": "0001-01-01T00:00:00Z",
        "author": "Amol Naik",
        "type": "webapps",
        "platform": "php",
        "port": ""
      },
      "shell_code": null,
    }
  },
  {
    "ID": 334919,
    "exploit_type": "OffensiveSecurity",
    "exploit_unique_id": "10180",
    "url": "https://www.exploit-db.com/exploits/10180",
    "description": "Simplog 0.9.3.2 - Multiple Vulnerabilities",
    "cve_id": "CVE-2009-4093",
    "offensive_security": {
      "ID": 334917,
      "ExploitID": 334917,
      "exploit_unique_id": "10180",
      "document": {
        "OffensiveSecurityID": 334917,
        "exploit_unique_id": "10180",
        "document_url": "https://gitlab.com/exploit-database/exploitdb/-/tree/main/exploits/php/webapps/10180.txt",
        "description": "Simplog 0.9.3.2 - Multiple Vulnerabilities",
        "date": "0001-01-01T00:00:00Z",
        "author": "Amol Naik",
        "type": "webapps",
        "platform": "php",
        "port": ""
      },
      "shell_code": null,
    }
  }
]

```  
## å‚è€ƒé“¾æ¥  
1. go-exploitdb: https://github.com/vulsio/go-exploitdb  
  
1. awesome-cve-poc: https://github.com/qazbnm456/awesome-cve-poc  
  
1. github search: https://github.com/search?o=desc&q=CVE&s=&type=Repositories  
  
1. inthewilddb: https://github.com/gmatuz/inthewilddb  
  
1. ExploitDB(OffectiveSecurity): https://www.exploit-db.com/  
  
â€  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/aOiar7mEUNlqIeYPL63ftuHYOg5LA6Izamo9VLniaX7pBCa2ATgAoIhOm8DuWwGa17csZQkM3fvZ9vjLCZnI37xA/640?wx_fmt=jpeg&from=appmsg "")  
  
  
