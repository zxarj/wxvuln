#  ã€Œæ¨å®‰æ—©æŠ¥ã€0812 | bhè®®é¢˜èŠ‚é€‰ã€çº¢è“å·¥å…·ã€æ¼æ´æƒ…æŠ¥   
bggsec  ç”²æ–¹å®‰å…¨å»ºè®¾   2024-08-12 17:52  
  

	#  2024-08-12Â ã€Œçº¢è“çƒ­ç‚¹ã€æ¯å¤©å¿«äººä¸€æ­¥  

	>   
>   
> 
			1. æ¨é€ã€Œæ–°ã€çƒ­ã€èµã€ï¼Œå¸®éƒ¨åˆ†äººé˜…è¯»ææ•ˆ
			2. å­¦æœ‰ç²¾è¯»æµ…è¯»æ·±è¯»ï¼Œè‰ºæœ‰ä¼šç†Ÿç²¾ç»åŒ–ï¼Œè§‰çŸ¥æ­¤äº‹é‡èº¬è¡Œã€‚æ¨é€åªåœ¨æµ…è¯»é¢„è§ˆ
			3. æœºè¯»ä¸ºä¸»ï¼Œäººå·¥è¾…åŠ©ï¼Œæ¯æ—¥æ•°ä¸‡ç½‘ç«™ï¼Œ10wæ¨ç‰¹é€Ÿè¯»
			4. æ¨é€å¯èƒ½å¤§ä¼—æˆ–å°ä¼—ï¼Œä¸ä»£è¡¨æœ¬äººåå¥½æˆ–è®¤å¯
			5. å› æ¸²æŸ“å’Œå¤–é“¾åŸå› ï¼Œå…¬ä¼—å·ç”²æ–¹å®‰å…¨å»ºè®¾å‘é€æ—¥æŠ¥æˆ–æ—¥æœŸ,å¦‚20240812è·å–å›¾æ–‡è¯„è®ºç‰ˆpdf
		  
>   
  
### ç›®å½•  
>   
> 0x01 ã€2024-0806ã€‘ä½¿ç”¨SeTcbPrivilegeç‰¹æƒè¿›è¡Œä»¤ç‰Œæ“ä½œæ•™ç¨‹0x02 ã€2024-0807ã€‘Kibanaå‘å¸ƒç´§æ€¥å®‰å…¨è¡¥ä¸ä¿®å¤ä¸¥é‡æ¼æ´0x03 ã€2024-0808ã€‘æ­ç§˜æœ‰æ•ˆçš„ç½‘ç»œå®šæ—¶æ”»å‡»0x04 ã€2024-0808ã€‘åˆ©ç”¨ç”µå­é‚®ä»¶è§£ææ¼æ´ç»•è¿‡è®¿é—®æ§åˆ¶0x05 ã€2024-0808ã€‘GhostWriteæ¼æ´åˆ©ç”¨æ¼”ç¤º0x06 ã€2024-0808ã€‘0.0.0.0 Dayæ¼æ´ï¼šæµè§ˆå™¨ä¸­åˆ©ç”¨æœ¬åœ°ä¸»æœºAPI0x07 ã€2024-0809ã€‘ç»Ÿæ²»æ‰€æœ‰æ¼æ´ï¼šåˆ©ç”¨Windowsé¢„è®¤è¯RCEæ¼æ´0x08 ã€2024-0809ã€‘MaLDAPtiveï¼šLDAPæœç´¢è¿‡æ»¤å™¨è§£æä¸æ··æ·†æ¡†æ¶0x09 ã€2024-0809ã€‘OpenVPNæ¼æ´è¢«å‘ç°å¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œå’Œæƒé™æå‡0x0a ã€2024-0809ã€‘Apache HTTPæœåŠ¡å™¨ä¸­çš„æ··æ·†æ”»å‡»æ¼æ´åˆ†æ0x0b ã€2024-0812ã€‘æ·±å…¥æ¢è®¨Windows DLLåŠ è½½æœºåˆ¶0x0c ã€2024-0812ã€‘TrickDumpï¼šæ— Minidumpæ–‡ä»¶çš„lsassè¿›ç¨‹å†…å­˜æŠ“å–å·¥å…·0x0d ã€2024-0812ã€‘Django SQL æ³¨å…¥æ¼æ´æ›å…‰0x0e ã€2024-0812ã€‘ä»£ç æ³¨å…¥å·¥å…·å®ç°æƒé™æå‡0x0f ã€2024-0812ã€‘Windowsè¿œç¨‹æ¡Œé¢è®¸å¯æœåŠ¡æ¼æ´åˆ†æ0x10 ã€2024-0812ã€‘L4LBå››å±‚è´Ÿè½½å‡è¡¡ä¸­çš„IPä¼ªé€ æ¼æ´è¯¦è§£  
  

	###  0x01 ä½¿ç”¨SeTcbPrivilegeç‰¹æƒè¿›è¡Œä»¤ç‰Œæ“ä½œæ•™ç¨‹  

	>   
> PowerOfTcbç½‘ç«™ä¸»è¦ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨SeTcbPrivilegeç‰¹æƒè¿›è¡Œä»¤ç‰Œæ“ä½œï¼ŒåŒ…æ‹¬ä¼šè¯IDã€æºã€å¼ºåˆ¶ç­–ç•¥å’Œå®Œæ•´æ€§çº§åˆ«çš„æ“ä½œï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨LSAå®¶æ—APIåˆ›å»ºç‰¹æ®Šçš„ç™»å½•ä»¤ç‰Œå’Œæ–°çš„SIDæ˜ å°„ï¼Œå¹¶æä¾›äº†å¤šä¸ªå·¥å…·æ¥æ¼”ç¤ºè¿™äº›æ“ä½œã€‚
		  
>   
  
  

	  

	
	![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTPn8COcg8AtzTuxtwp6PX0iahQCnn2ZxvCpFH48OpuOqJialicHbf07kw0w/640?from=appmsg "")  

	
	![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTPtfUDd9qbICyFR7dbXevKBP5xVFpsaCbBiao2miaQsgquBChQic4ib0KPyw/640?from=appmsg "")  

	
	![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTPMlLxYxtvwNljcQoI88fjGj7pZbZToXUg82N2Rc3YGBRNN7VmvxecGQ/640?from=appmsg "")  

	  
  
<<<å·¦å³æ»‘åŠ¨è§æ›´å¤š >>>  

	###  çƒ­è¯„   
- SeTcbPrivilege æ¼æ´ç ”ç©¶å·¥å…·å¼€æº  
  
- SeTcbPrivilege æ¼æ´å·¥å…·å¼€æº  
  

	  

		
	  

	###  å…³é”®ä¿¡æ¯ç‚¹   
- SeTcbPrivilegeæ˜¯ä¸€ä¸ªå¤šåŠŸèƒ½ç‰¹æƒï¼Œå¯ä»¥ç”¨äºå„ç§ä»¤ç‰Œæ“ä½œï¼ŒåŒ…æ‹¬ä½†ä¸é™äºä¼šè¯IDã€æºã€å¼ºåˆ¶ç­–ç•¥å’Œå®Œæ•´æ€§çº§åˆ«çš„ä¿®æ”¹ã€‚  
  
- ä½¿ç”¨SeTcbPrivilegeå¯ä»¥åˆ›å»ºç‰¹æ®Šçš„ç™»å½•ä»¤ç‰Œå’Œæ–°çš„SIDæ˜ å°„ï¼Œè¿™é€šå¸¸éœ€è¦LSAå®¶æ—APIã€‚  
  
- åœ¨åˆ›å»ºå…·æœ‰ç‰¹å®šä»¤ç‰Œçš„è¿›ç¨‹æ—¶ï¼ŒCreateProcessAsUserå’ŒCreateProcessWithTokenW APIæ˜¯é¦–é€‰çš„æ–¹æ³•ã€‚  
  
- ä½œè€…æä¾›çš„å·¥å…·CreateGUISessionProcessã€BackgroundShellã€DesktopShellã€S4ULogonShellã€ServiceShellå’ŒVirtualShellï¼Œéƒ½æ˜¯ç”¨æ¥æ¼”ç¤ºç‰¹æƒå’Œä»¤ç‰Œæ“ä½œçš„å®é™…åº”ç”¨ã€‚  
  

	
	  
ğŸ·ï¸: SeTcbPrivilege, ä»¤ç‰Œæ“ä½œ, ä¼šè¯ID, å¼ºåˆ¶ç­–ç•¥, å®Œæ•´æ€§çº§åˆ«  
###  0x02 Kibanaå‘å¸ƒç´§æ€¥å®‰å…¨è¡¥ä¸ä¿®å¤ä¸¥é‡æ¼æ´  

	>   
> Elasticå›¢é˜Ÿå‘å¸ƒäº†ä¸€ä¸ªå…³é”®çš„å®‰å…¨æ›´æ–°ï¼Œç”¨äºä¿®å¤Kibanaä¸­çš„ä¸¥é‡æ¼æ´CVE-2024-37287ï¼Œè¯¥æ¼æ´å¯èƒ½å¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚
		  
>   
  



	###  çƒ­è¯„   
- ç´§æ€¥ä¿®å¤ï¼Kibana ä¸¥é‡å®‰å…¨æ¼æ´ CVE-2024-37287 (CVSS 9.9)  
  
- ç´§æ€¥ä¿®å¤ï¼Kibanaä¸¥é‡æ¼æ´CVE-2024-37287  
  

	  

		
	  

	###  å…³é”®ä¿¡æ¯ç‚¹   
- CVE-2024-37287æ¼æ´å±å®³æ€§æé«˜ï¼šè¯¥æ¼æ´è¢«è¯„ä¸ºCVSSè¯„åˆ†9.9ï¼Œè¡¨æ˜å…¶å¯¹Kibanaç”¨æˆ·çš„å¨èƒæ½œåŠ›éå¸¸å¤§ã€‚  
  
- åŸå‹æ±¡æŸ“æ¼æ´å¯èƒ½å¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œï¼šæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¿é—®æœºå™¨å­¦ä¹ å’Œè­¦æŠ¥è¿æ¥å™¨åŠŸèƒ½ï¼Œä»¥åŠå¯¹å†…éƒ¨æœºå™¨å­¦ä¹ ç´¢å¼•çš„å†™å…¥è®¿é—®æƒé™ï¼Œåˆ©ç”¨åŸå‹æ±¡æŸ“æ¼æ´æ‰§è¡Œä»»æ„ä»£ç ã€‚  
  
- å¤šç§éƒ¨ç½²æ–¹å¼å—åˆ°å½±å“ï¼šåŒ…æ‹¬è‡ªç®¡ç†å®‰è£…ã€Dockeré•œåƒã€Elastic Cloudã€ECEå’ŒECKç­‰éƒ¨ç½²æ–¹å¼éƒ½å¯èƒ½å—åˆ°æ­¤æ¼æ´çš„å½±å“ã€‚  
  
- ç«‹å³å‡çº§è‡³æœ€æ–°ç‰ˆæœ¬çš„é‡è¦æ€§ï¼šç”¨æˆ·åº”ç«‹å³å‡çº§åˆ°Kibana 8.14.2æˆ–7.17.23ç‰ˆæœ¬ï¼Œä»¥ä¿æŠ¤è‡ªå·±å…å—æ½œåœ¨çš„æ”»å‡»ã€‚  
  

	
	  
ğŸ·ï¸: Kibana, æ¼æ´, å®‰å…¨æ›´æ–°, ä»£ç æ‰§è¡Œ, Elastic  
###  0x03 æ­ç§˜æœ‰æ•ˆçš„ç½‘ç»œå®šæ—¶æ”»å‡»  

	>   
> æœ¬æ–‡ä»‹ç»äº†å¦‚ä½•åˆ©ç”¨ç½‘ç»œå®šæ—¶æ”»å‡»æ¥æ­éœ²æœåŠ¡å™¨çš„éšè—ä¿¡æ¯ï¼ŒåŒ…æ‹¬é”™è¯¯é…ç½®ã€ç›²æ³¨å…¥æ¼æ´ã€éšè—è·¯ç”±ä»¥åŠå¹¿æ³›çš„éšè—æ”»å‡»é¢ã€‚
		  
>   
  
  

	  

	
	![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTPE2jtNDxIWNZkkcmIdO8iapYJjicslfta0pnr1bMQUrlyUt75fFw0y4hg/640?from=appmsg "")  

	
	![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTPytFzbrkRZqvmxia3JmIJOdwCiaGo3QNEwLq89PBtLtcJlMx3wzQLe6sg/640?from=appmsg "")  

	
	![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTPx8HhhzGosbb3MGoBkEUA761Z0dBU8uvicJVmpSgP6YWYJCBEbWeuthA/640?from=appmsg "")  

	  
  
<<<å·¦å³æ»‘åŠ¨è§æ›´å¤š >>>  

	###  çƒ­è¯„   
- æ­ç§˜ï¼šæœ‰æ•ˆçš„ç½‘é¡µè®¡æ—¶æ”»å‡»ç™½çš®ä¹¦å‘å¸ƒ  
  
- ç½‘ç»œè®¡æ—¶æ”»å‡»ï¼šåˆ©ç”¨ JSON é”™è¯¯å®ç°è¶…é«˜é€Ÿå“åº”  
  

	  

		
	  

	###  å…³é”®ä¿¡æ¯ç‚¹   
- å®šæ—¶æ”»å‡»çš„å®ç”¨æ€§ï¼šç½‘ç»œå®šæ—¶æ”»å‡»ä¸å†æ˜¯ç†è®ºä¸Šçš„å¨èƒï¼Œè€Œæ˜¯ä¸€ä¸ªå®é™…å¯è¡Œçš„æ”»å‡»æ‰‹æ®µï¼Œå¯ä»¥åœ¨é‡å¤–ç¯å¢ƒä¸­å‡†ç¡®åœ°æ£€æµ‹åˆ°æœåŠ¡å™¨çš„éšè—é—®é¢˜ã€‚  
  
- å®šæ—¶æ”»å‡»çš„æ™®éæ€§ï¼šæœåŠ¡å™¨ä¸Šå­˜åœ¨å¤§é‡çš„å®šæ—¶ä¿¡æ¯æ³„éœ²æ¼æ´ï¼Œè¿™äº›æ¼æ´æ™®éå­˜åœ¨äºç°ä»£ç½‘ç«™ä¸­ï¼Œä¸”å¾€å¾€è¢«å¿½è§†ã€‚  
  
- å®šæ—¶æ”»å‡»çš„è¿›æ­¥ï¼šéšç€æŠ€æœ¯çš„è¿›æ­¥ï¼Œå¦‚HTTP/2åè®®çš„åº”ç”¨å’Œå•åŒ…æ”»å‡»æŠ€æœ¯çš„å‘å±•ï¼Œå®šæ—¶æ”»å‡»å˜å¾—æ›´åŠ ç²¾ç¡®å’Œé«˜æ•ˆã€‚  
  
- å®šæ—¶æ”»å‡»çš„å¤šæ ·æ€§ï¼šå®šæ—¶æ”»å‡»å¯ä»¥ç”¨äºå‘ç°å¤šç§ç±»å‹çš„å®‰å…¨é—®é¢˜ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºéšè—å‚æ•°ã€æ³¨å…¥æ¼æ´ã€é”™è¯¯é…ç½®å’Œåå‘ä»£ç†æ¼æ´ã€‚  
  

	
	  
ğŸ·ï¸: ç½‘ç»œæ”»å‡», æœåŠ¡å™¨å®‰å…¨, æ¼æ´åˆ©ç”¨  
###  0x04 åˆ©ç”¨ç”µå­é‚®ä»¶è§£ææ¼æ´ç»•è¿‡è®¿é—®æ§åˆ¶  

	>   
> 
		  
>   
  
  

	  

	
	![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTPVMeIVec65rqmQCEvlrBUK8qTdm960MbKkR4c5NvO6RoYsRntCFhDQQ/640?from=appmsg "")  

	
	![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTPSWoGrVepumsgQbdlibibKOUSFrt5WkdIRluiaS2UO2pFnaxnIm0UHpfmw/640?from=appmsg "")  

	
	![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTPD6mUJI1dFbDmbNTMibhkia4rvnRyHkH3J16lwsp75CcL5Z66wtZSql4A/640?from=appmsg "")  

	  
  
<<<å·¦å³æ»‘åŠ¨è§æ›´å¤š >>>  

	###  çƒ­è¯„   
- ç”µå­é‚®ä»¶åœ°å€RFCè§„èŒƒï¼šä¸ºä½•ä¸åº”éµå¾ªï¼Ÿ  
  
- åˆ©ç”¨è§£æå™¨æ¼æ´ç»•è¿‡è®¿é—®æ§åˆ¶ï¼šæ‹†è§£é‚®ä»¶åŸå­  
  

	  

		
	  

	###  å…³é”®ä¿¡æ¯ç‚¹   
- ç”µå­é‚®ä»¶è§£æçš„å¤æ‚æ€§ï¼šç”µå­é‚®ä»¶åœ°å€çš„æ ¼å¼ç”±å¤šä¸ªRFCè§„å®šï¼Œè¿™äº›è§„å®šè¿‡äºå®½æ¾ï¼Œå¯¼è‡´è§£æå˜å¾—å¤æ‚ï¼Œå®¹æ˜“å‡ºç°å·®å¼‚ã€‚  
  
- è§£æå™¨å·®å¼‚çš„åˆ©ç”¨ï¼šä¸åŒçš„ç”µå­é‚®ä»¶è§£æå™¨å¯èƒ½ä¼šå¯¹åŒä¸€ç”µå­é‚®ä»¶åœ°å€è¿›è¡Œä¸åŒçš„è§£æï¼Œè¿™ç§å·®å¼‚å¯ä»¥è¢«æ¶æ„åˆ©ç”¨æ¥ç»•è¿‡è®¿é—®æ§åˆ¶ã€‚  
  
- ç¼–ç å•è¯å’ŒPunycodeçš„é£é™©ï¼šç”µå­é‚®ä»¶åœ°å€ä¸­çš„ç¼–ç å•è¯å’ŒPunycodeå¯ä»¥è¢«ç”¨æ¥æ¬ºéª—è§£æå™¨ï¼Œäº§ç”Ÿä¸å¯è§çš„å­—ç¬¦æˆ–è€…ä¼ªè£…æˆå…¶ä»–åŸŸåã€‚  
  
- è®¿é—®æ§åˆ¶çš„è„†å¼±æ€§ï¼šä¾èµ–ç”µå­é‚®ä»¶åŸŸåè¿›è¡Œè®¿é—®æ§åˆ¶æ˜¯ä¸å®‰å…¨çš„ï¼Œå› ä¸ºæ”»å‡»è€…å¯ä»¥é€šè¿‡å„ç§æŠ€æœ¯æ¥ä¼ªé€ æˆ–æ“çºµç”µå­é‚®ä»¶åœ°å€ã€‚  
  

	
	  
ğŸ·ï¸: ç”µå­é‚®ä»¶å®‰å…¨, è®¿é—®æ§åˆ¶, æ¼æ´åˆ©ç”¨  
###  0x05 GhostWriteæ¼æ´åˆ©ç”¨æ¼”ç¤º  

	>   
> GhostWrite æ˜¯ RISC-V æ¶æ„ä¸‹çš„ T-Head XuanTie C910 CPU ä¸­çš„ä¸€ä¸ªç¡¬ä»¶ç¼ºé™·ï¼Œè¯¥ç¼ºé™·å…è®¸æœªæˆæƒçš„æ”»å‡»è€…ç›´æ¥å†™å…¥ç‰©ç†å†…å­˜ï¼Œç»•è¿‡æ“ä½œç³»ç»Ÿçš„è¿›ç¨‹éš”ç¦»ï¼Œå¯¼è‡´è®¾å¤‡å®‰å…¨æ€§å—åˆ°ä¸¥é‡å¨èƒã€‚
		  
>   
  
  

	  

	
	![](https://mmbiz.qpic.cn/mmbiz_svg/98Nz5LFElxzdExAnJcAwRGbKicicibt9U9Ca8XnQbt4A1B3nknOq3llJ5L54E1bsriaejz4Jkm13BAdya9dR8zYwK3o0WOv9NRbj/640?from=appmsg "")  

	
	![](https://mmbiz.qpic.cn/mmbiz_svg/98Nz5LFElxzdExAnJcAwRGbKicicibt9U9CicLXTFfZgmnz8TKSDTJrfAhgLTor9rzgug8x8LJkRUibEQB9vmbIM4VtibibRmCAPQJN/640?from=appmsg "")  

	
	![](https://mmbiz.qpic.cn/mmbiz_svg/98Nz5LFElxzdExAnJcAwRGbKicicibt9U9CZxyqDgag5bJwXJRkjtibkw6WmULTwiaHyXVvLFiaNNpoS02yKRkj2dFDHrnYrkiamfDO/640?from=appmsg "")  

	  
  
<<<å·¦å³æ»‘åŠ¨è§æ›´å¤š >>>  

	###  çƒ­è¯„   
- ã€Œç¼–è€…æ³¨ã€:é˜¿é‡Œå·´å·´ ç„é“ CPU è¢«å¹²äº†ï¼Ÿç›´æ¥cpuæ¼æ´é€ƒé€¸è™šæ‹Ÿæœº  
  
- GhostWrite CPU æ¼æ´ï¼šæ‰“ç ´éš”ç¦»è¾¹ç•Œï¼Œå½±å“ RISC-V å¤„ç†å™¨  
  

	  

		
	  

	###  å…³é”®ä¿¡æ¯ç‚¹   
- RISC-V æ¶æ„çš„å¼€æ”¾æ€§ä¿ƒè¿›äº†ç”Ÿæ€ç³»ç»Ÿçš„ç¹è£ï¼Œä½†åŒæ—¶ä¹Ÿå¯èƒ½å¸¦æ¥äº†å®‰å…¨é£é™©ï¼Œå¦‚ GhostWrite è¿™æ ·çš„ç¡¬ä»¶ç¼ºé™·ã€‚  
  
- GhostWrite æ­ç¤ºäº†ç¡¬ä»¶çº§åˆ«çš„å®‰å…¨é—®é¢˜ï¼Œè¿™ç§ç¼ºé™·æ— æ³•é€šè¿‡è½¯ä»¶æ›´æ–°æ¥ä¿®å¤ï¼Œå¼ºè°ƒäº†ç¡¬ä»¶å®‰å…¨æ€§çš„é‡è¦æ€§ã€‚  
  
- å·®åˆ† CPU æ¨¡ç³Šæµ‹è¯•æ˜¯ä¸€ç§æœ‰æ•ˆçš„æ–¹æ³•æ¥å‘ç° CPU å®ç°ä¸­çš„å·®å¼‚å’Œæ¼æ´ã€‚  
  
- å¯¹äºäº‘æœåŠ¡æä¾›å•†å’Œç”¨æˆ·æ¥è¯´ï¼Œäº†è§£è‡ªå·±çš„ç¡¬ä»¶åŸºç¡€è®¾æ–½æ˜¯è‡³å…³é‡è¦çš„ï¼Œç‰¹åˆ«æ˜¯åœ¨ä½¿ç”¨å¼€æ”¾ ISA å¦‚ RISC-V æ—¶ã€‚  
  

	
	  
ğŸ·ï¸: GhostWrite, æ¼æ´åˆ©ç”¨, å†…æ ¸ä¿®æ”¹, rootæƒé™  
###  0x06 0.0.0.0 Dayæ¼æ´ï¼šæµè§ˆå™¨ä¸­åˆ©ç”¨æœ¬åœ°ä¸»æœºAPI  

	>   
> Oligo Security ç ”ç©¶å›¢é˜ŸæŠ«éœ²äº†â€œ0.0.0.0 Dayâ€æ¼æ´ï¼Œè¿™ä¸€æ¼æ´å…è®¸æ¶æ„ç½‘ç«™ç»•è¿‡æµè§ˆå™¨å®‰å…¨æœºåˆ¶ï¼Œä¸æœ¬åœ°ç½‘ç»œä¸Šçš„æœåŠ¡äº¤äº’ï¼Œå¯èƒ½å¯¼è‡´æ”»å‡»è€…è¿œç¨‹æ‰§è¡Œä»£ç ã€‚
		  
>   
  
  

	  

	
	![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTPia9CzW3gRibOfKoBvbhQBJsIr5s0A4aKPGG4icSzVnCaiaYlxWAqdKl0bQ/640?from=appmsg "")  

	
	![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTPzJbEkpWsaqGXPfcFia5PHfWGYbibdjEs4Ae5QiaxRa0gGcnKB6o0UTt3A/640?from=appmsg "")  

	
	![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTPKHyHfBRwH8j8egdhdX7eTIVicNh4ZYHWUcX6PZL0aBDzkXUOrSfpgibA/640?from=appmsg "")  

	  
  
<<<å·¦å³æ»‘åŠ¨è§æ›´å¤š >>>  

	###  çƒ­è¯„   
- å…³äº 0.0.0.0 æ—¥  
  
- ä»æµè§ˆå™¨åˆ©ç”¨æœ¬åœ°ä¸»æœº API  
  

	  

		
	  

	###  å…³é”®ä¿¡æ¯ç‚¹   
- æµè§ˆå™¨çš„å®‰å…¨æœºåˆ¶å®ç°ä¸ä¸€è‡´å’Œç¼ºä¹æ ‡å‡†åŒ–æ˜¯â€œ0.0.0.0 Dayâ€æ¼æ´å­˜åœ¨çš„æ ¹æœ¬åŸå› ã€‚  
  
- 0.0.0.0 Day æ¼æ´çš„å­˜åœ¨ä½¿å¾—æ¶æ„ç½‘ç«™èƒ½å¤Ÿæ”»å‡»æœ¬åœ°æœåŠ¡ï¼ŒåŒ…æ‹¬å¼€å‘ç¯å¢ƒã€æ“ä½œç³»ç»Ÿå’Œå†…éƒ¨ç½‘ç»œã€‚  
  
- å„ä¸»æµæµè§ˆå™¨æ­£åœ¨åŠªåŠ›ç¼“è§£è¿™ä¸€æ¼æ´ï¼Œä½†ç”±äºç¼ºä¹ç»Ÿä¸€æ ‡å‡†å’Œå¤æ‚çš„è¡¥ä¸è¿‡ç¨‹ï¼Œæ¼æ´ç›®å‰ä»ç„¶å¯ä»¥è¢«åˆ©ç”¨ã€‚  
  
- PNAï¼ˆPrivate Network Accessï¼‰æ˜¯ Google é¢†å¯¼çš„ä¸€ä¸ªé‡è¦åŠªåŠ›ï¼Œæ—¨åœ¨æ”¹è¿›å’ŒåŠ å¼ºæµè§ˆå™¨å¯¹ç§æœ‰ç½‘ç»œè®¿é—®çš„æ§åˆ¶ã€‚  
  

	
	  
ğŸ·ï¸: æ¼æ´, æµè§ˆå™¨å®‰å…¨, æœ¬åœ°ç½‘ç»œ, è¿œç¨‹æ‰§è¡Œä»£ç   
###  0x07 ç»Ÿæ²»æ‰€æœ‰æ¼æ´ï¼šåˆ©ç”¨Windowsé¢„è®¤è¯RCEæ¼æ´  

	>   
> è¯¥ç½‘é¡µæ­ç¤ºäº† Windows è¿œç¨‹æ¡Œé¢æœåŠ¡ä¸­çš„ä¸€ä¸ªä¸¥é‡æ¼æ´ï¼Œå³ CVE-2024-38077ï¼Œè¿™æ˜¯ä¸€ä¸ªå †æº¢å‡ºæ¼æ´ï¼Œå¯ä»¥å®ç°æ— éœ€è®¤è¯çš„è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆPreauth RCEï¼‰ï¼Œå½±å“ä» Windows Server 2000 åˆ° 2025 çš„æ‰€æœ‰ç‰ˆæœ¬ã€‚ä½œè€…é€šè¿‡åˆ†æå’Œæ¼æ´åˆ©ç”¨çš„ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•åœ¨ Windows Server 2025 ä¸Šåˆ©ç”¨è¿™ä¸€æ¼æ´æ¥å®ç° 0-click RCEï¼Œå¹¶å¼ºè°ƒäº†è¿™ä¸€æ¼æ´çš„ä¸¥é‡æ€§å’Œä¿®å¤çš„ç´§è¿«æ€§ã€‚
		  
>   
  



	###  çƒ­è¯„   
- MadLicenseï¼šåˆ©ç”¨0ç‚¹å‡»é¢„æˆæƒRCEæ¼æ´æ”»å‡»WindowsæœåŠ¡å™¨  
  
- å¾®è½¯ä½ä¼°ä¸¥é‡æ¼æ´ï¼šWindows Server 0-Click RCE æ¼æ´éœ€å¼•èµ·é‡è§†  
  

	  

		
	  

	###  å…³é”®ä¿¡æ¯ç‚¹   
- CVE-2024-38077 æ¼æ´çš„ä¸¥é‡æ€§ï¼šä½œè€…è®¤ä¸ºè¯¥æ¼æ´æå…¶ä¸¥é‡ï¼Œå› ä¸ºå®ƒå…è®¸æ”»å‡»è€…åœ¨ä¸éœ€è¦ä»»ä½•ç”¨æˆ·äº¤äº’çš„æƒ…å†µä¸‹è¿œç¨‹æ‰§è¡Œä»£ç ï¼Œè¿™è¿åäº† Microsoft å¯¹è¯¥æ¼æ´ä¸æ˜“è¢«åˆ©ç”¨çš„è¯„ä¼°ã€‚  
  
- æ¼æ´çš„æ™®éå½±å“ï¼šè¯¥æ¼æ´å½±å“äº†ä» Windows Server 2000 åˆ° 2025 çš„æ‰€æœ‰ç‰ˆæœ¬ï¼Œè¿™æ„å‘³ç€å¤§é‡çš„æœåŠ¡å™¨å¯èƒ½é¢ä¸´ç€è¢«åˆ©ç”¨çš„é£é™©ã€‚  
  
- æ¼æ´åˆ©ç”¨çš„å¯è¡Œæ€§ï¼šä½œè€…é€šè¿‡æä¾›çš„ä¼ªä»£ç ç¤ºä¾‹å’Œåˆ©ç”¨æˆåŠŸç‡çš„æ•°æ®ï¼Œè¯æ˜äº†è¯¥æ¼æ´çš„åˆ©ç”¨æ˜¯å¯è¡Œçš„ï¼Œå¹¶ä¸”æˆåŠŸç‡éå¸¸é«˜ã€‚  
  
- å®‰å…¨æªæ–½çš„é‡è¦æ€§ï¼šæ–‡ç« å¼ºè°ƒäº†å®æ–½å®‰å…¨æªæ–½çš„é‡è¦æ€§ï¼ŒåŒ…æ‹¬åŠæ—¶æ›´æ–°ç³»ç»Ÿã€ä½¿ç”¨æœ€æ–°çš„å®‰å…¨è¡¥ä¸ä»¥åŠç›‘æ§å¯èƒ½çš„å¼‚å¸¸è¡Œä¸ºã€‚  
  

	
	  
ğŸ·ï¸: Windows, è¿œç¨‹ä»£ç æ‰§è¡Œ, æ¼æ´åˆ©ç”¨, ç½‘ç»œå®‰å…¨, é¢„è®¤è¯  
###  0x08 MaLDAPtiveï¼šLDAPæœç´¢è¿‡æ»¤å™¨è§£æä¸æ··æ·†æ¡†æ¶  

	>   
> MaLDAPtive æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äº LDAP SearchFilter è§£æã€æ··æ·†ã€è§£æ··æ·†å’Œæ£€æµ‹çš„æ¡†æ¶ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªå®šåˆ¶çš„ C# LDAP è§£æå™¨å’Œä¸€ä¸ªçµæ´»çš„ PowerShell å°è£…ï¼Œä»¥æ”¯æŒæœ€å¤§ç¨‹åº¦çš„éšæœºåŒ–å’Œç®¡é“åŠŸèƒ½ã€‚
		  
>   
  
  

	  

	
	![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTP1CxjMO78BiaKml78UXtLnOtE3iamGibYmBAO2mcZVKDJmchsic5FoUySBA/640?from=appmsg "")  

	
	![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTP72WFaW0JBUQWJ3WxEu8BGtkr9yQVAxZyjYeIibhic9cMINSlgpVRU4tQ/640?from=appmsg "")  

	
	![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTPCh8NFDsib1cYqWH27UE82peodNibEiaWzcnbmFtHQkUTdJ47ibbKCE7ic7A/640?from=appmsg "")  

	  
  
<<<å·¦å³æ»‘åŠ¨è§æ›´å¤š >>>  

	###  çƒ­è¯„   
- MaLDAPtiveæ¡†æ¶ï¼šLDAPæœç´¢è¿‡æ»¤å™¨è§£æã€æ··æ·†ã€è§£æ··æ·†å’Œæ£€æµ‹  
  
- Black Hat å’Œ Defcon ä¼šè®®ç²¾å½©å›é¡¾  
  

	  

		
	  

	###  å…³é”®ä¿¡æ¯ç‚¹   
- MaLDAPtive çš„å¼€å‘å›¢é˜Ÿå¼ºè°ƒäº†å¯¹äºé˜²å¾¡è€…åœ¨é¢å¯¹ LDAP ç›¸å…³å¨èƒæ—¶çš„éœ€æ±‚ï¼Œé€šè¿‡åˆ†é˜¶æ®µçš„æ¡†æ¶å‘å¸ƒï¼Œä»–ä»¬å¸Œæœ›é˜²å¾¡è€…èƒ½å¤Ÿæœ‰è¶³å¤Ÿçš„æ—¶é—´æ¥è®¾ç½®å¿…è¦çš„ç›‘æ§å’Œæ£€æµ‹è§„åˆ™ã€‚ä»–ä»¬è®¤ä¸ºï¼Œé€šè¿‡æä¾›ä¸€ä¸ªå®Œæ•´çš„æ¡†æ¶ï¼Œå¯ä»¥å¸®åŠ©å®‰å…¨ä¸“ä¸šäººå‘˜æ›´å¥½åœ°ç†è§£å’Œåº”å¯¹ LDAP SearchFilter çš„æ··æ·†æŠ€æœ¯ã€‚MaLDAPtive çš„è®¾è®¡ç†å¿µæ˜¯æä¾›ä¸€ä¸ªå¼ºå¤§ã€çµæ´»ä¸”æ˜“äºä½¿ç”¨çš„å·¥å…·ï¼Œä»¥ä¾¿åœ¨å®é™…æ“ä½œä¸­èƒ½å¤Ÿå¿«é€Ÿå“åº”å’Œæ£€æµ‹æ¶æ„çš„ LDAP SearchFilterã€‚æ­¤å¤–ï¼Œå¼€å‘è€…è¿˜å¼ºè°ƒäº†åœ¨å®éªŒå®¤ç¯å¢ƒä¸­æ”¶é›† LDAP é¥æµ‹çš„é‡è¦æ€§ï¼Œå¹¶æä¾›äº†ä¸€ä¸ªç”¨äºå®‰è£…ã€é…ç½®å’ŒæŸ¥è¯¢ LDAP é¥æµ‹çš„æ¨¡å—ï¼Œä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜åœ¨ä¸å½±å“ç”Ÿäº§ç¯å¢ƒçš„æƒ…å†µä¸‹è¿›è¡Œæµ‹è¯•ã€‚  
  

	
	  
ğŸ·ï¸: LDAP, è§£æå™¨, æ··æ·†, ç½‘ç»œå®‰å…¨, C#  
###  0x09 OpenVPNæ¼æ´è¢«å‘ç°å¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œå’Œæƒé™æå‡  

	>   
> å¾®è½¯ç ”ç©¶äººå‘˜å‘ç°äº†å¤šä¸ªOpenVPNä¸­ç­‰ä¸¥é‡æ€§çš„æ¼æ´ï¼Œè¿™äº›æ¼æ´å¯ä»¥è¢«é“¾å¼åˆ©ç”¨ä»¥å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰å’Œæœ¬åœ°æƒé™æå‡ï¼ˆLPEï¼‰ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²ã€ç³»ç»Ÿè¢«ç ´åå’Œæœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯ã€‚
		  
>   
  
  

	  

	
	![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTPfN6ltmBAKmUkwAhpT0EQ7yUIZrlL1z1HqMRLico1rbicuOogwIGuNMNg/640?from=appmsg "")  

	  


	###  çƒ­è¯„   
- å¾®è½¯å¨èƒæƒ…æŠ¥åšå®¢å‘å¸ƒå…³äºæ¼æ´åˆ©ç”¨çš„æœ€æ–°æ–‡ç«   
  
- å¾®è½¯å‘ç°OpenVPNå¤šä¸ªæ¼æ´ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œå’Œæœ¬åœ°ææƒ  
  

	  

		
	  

	###  å…³é”®ä¿¡æ¯ç‚¹   
- OpenVPNæ˜¯ä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„å¼€æºVPNè§£å†³æ–¹æ¡ˆï¼Œè¢«é›†æˆåˆ°å„ç§è®¾å¤‡ä¸­ï¼ŒåŒ…æ‹¬è·¯ç”±å™¨ã€å›ºä»¶ã€PCã€ç§»åŠ¨è®¾å¤‡ç­‰ã€‚  
  
- æ”»å‡»è€…éœ€è¦ç”¨æˆ·è®¤è¯å’Œå¯¹OpenVPNå†…éƒ¨å·¥ä½œæœºåˆ¶ä»¥åŠæ“ä½œç³»ç»Ÿçš„æ·±å…¥äº†è§£æ¥åˆ©ç”¨è¿™äº›æ¼æ´ã€‚  
  
- å¾®è½¯åœ¨Black Hat USA 2024ä¸Šå±•ç¤ºäº†è¿™äº›æ¼æ´çš„ç ”ç©¶æˆæœå’Œæ”»å‡»é“¾çš„æ¼”ç¤ºã€‚  
  
- å¾®è½¯æä¾›äº†å…³äºå¦‚ä½•ä¿®è¡¥è¿™äº›æ¼æ´ä»¥åŠå¦‚ä½•å‡è½»å’Œæ£€æµ‹è¯•å›¾åˆ©ç”¨è¿™äº›æ¼æ´çš„å¨èƒçš„æŒ‡å¯¼ã€‚  
  

	
	  
ğŸ·ï¸: OpenVPN, æ¼æ´, è¿œç¨‹ä»£ç æ‰§è¡Œ, æƒé™æå‡, æ•°æ®æ³„éœ²  
###  0x0a Apache HTTPæœåŠ¡å™¨ä¸­çš„æ··æ·†æ”»å‡»æ¼æ´åˆ†æ  

	>   
> æœ¬æ–‡ä¸»è¦æ¢è®¨äº†Apache HTTP Serverä¸­å­˜åœ¨çš„Confusion Attacksï¼Œå³åˆ©ç”¨æ¨¡å—é—´å¯¹è¯·æ±‚å¤„ç†ç»“æ„çš„ç†è§£ä¸ä¸€è‡´è¿›è¡Œçš„æ”»å‡»ï¼Œå¹¶æ­ç¤ºäº†å¤šä¸ªæ¼æ´å’Œåˆ©ç”¨æŠ€æœ¯ã€‚
		  
>   
  
  

	  

	
	![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTPxZFKHy0YkkULreJpoon8fNUncOHVHgqJUTDQfvBFvBBXVC3mVR7IeA/640?from=appmsg "")  

	
	![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTPDvTupyUQtrnld96lxYq5IgL8V6kBR1bSpvI2AFOF4rLDMCdWfD5WBw/640?from=appmsg "")  

	
	![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTPn2o9kXhqNK0WML3EMfQVI6VzImBlU2YW7JbYLt1bGaWBT4uN2vvGLA/640?from=appmsg "")  

	  
  
<<<å·¦å³æ»‘åŠ¨è§æ›´å¤š >>>  

	###  çƒ­è¯„   
- Apache HTTP æœåŠ¡å™¨ä¸­çš„è¯­ä¹‰æ··æ·†æ”»å‡»ï¼šåˆ©ç”¨éšè—çš„æ­§ä¹‰  
  

	  

		
	  

	###  å…³é”®ä¿¡æ¯ç‚¹   
- Apache HTTP Serverçš„æ¨¡å—åŒ–è®¾è®¡å¸¦æ¥äº†å®‰å…¨é£é™©ï¼šç”±äºæ¨¡å—é—´å¯¹è¯·æ±‚å¤„ç†ç»“æ„çš„ç†è§£ä¸ä¸€è‡´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹è¿›è¡ŒConfusion Attacksã€‚  
  
- Filename Confusionæ”»å‡»ï¼šæ¨¡å—é—´å¯¹r->filenameçš„ç†è§£ä¸ä¸€è‡´ï¼Œå¯ä»¥å¯¼è‡´å®‰å…¨é—®é¢˜ï¼Œä¾‹å¦‚é€šè¿‡?æˆªæ–­RewriteRuleåé¢çš„è·¯å¾„æˆ–ç½‘å€ï¼Œæˆ–è€…è¯¯å¯¼RewriteFlagçš„è®¾ç½®ã€‚  
  
- DocumentRoot Confusionæ”»å‡»ï¼šæ¨¡å—é—´å¯¹DocumentRootçš„ç†è§£ä¸ä¸€è‡´ï¼Œå¯ä»¥å¯¼è‡´è®¤è¯å’Œè®¿é—®æ§åˆ¶ç»•è¿‡ï¼Œä¾‹å¦‚åˆ©ç”¨Filesè¯­æ³•å’Œmod_proxyçš„äº¤äº’ã€‚  
  
- Handler Confusionæ”»å‡»ï¼šåˆ©ç”¨Apache HTTP Serverä»1996å¹´å¼€å§‹å°±å­˜åœ¨çš„æŠ€æœ¯å€ºï¼Œå¦‚AddHandlerå’ŒAddTypeçš„æ··æ·†ä½¿ç”¨ï¼Œæ”»å‡»è€…å¯ä»¥è°ƒç”¨ä»»æ„çš„æ¨¡å—å¤„ç†å™¨ã€‚  
  

	
	  
ğŸ·ï¸: æ”»å‡», æœåŠ¡å™¨, æ¼æ´, Apache HTTP Server, ç½‘ç»œå®‰å…¨  
###  0x0b æ·±å…¥æ¢è®¨Windows DLLåŠ è½½æœºåˆ¶  

	>   
> è¿™ä¸ªç½‘ç«™çš„ä¸»è¦å†…å®¹æ˜¯å…³äºWindowsåŠ¨æ€é“¾æ¥åº“ï¼ˆDLLï¼‰åŠ è½½æœºåˆ¶çš„æ·±å…¥ç ”è®¨ä¼šï¼Œæ•™æˆå‚ä¸è€…å¦‚ä½•æ„å»ºè‡ªå·±çš„DLLåŠ è½½å™¨ï¼Œå¹¶æ·±å…¥äº†è§£DLLåŠ è½½è¿‡ç¨‹ä¸­çš„å†…éƒ¨ç»“æ„å’Œä¾èµ–è§£æã€‚
		  
>   
  
  

	  

	
	![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTPYEtqiaHcOfsiaL1ch4GZSGPH06kWOEicSSSd2BibyD74pZ926flWm2UWIA/640?from=appmsg "")  

	  


	###  çƒ­è¯„   
- Defcon 32 ç ”è®¨ä¼šï¼šæ„å»ºå®Œç¾ DLL åŠ è½½å™¨  
  
- Defcon32 Workshopï¼šæ‰“é€ å®Œç¾çš„DLLåŠ è½½å™¨  
  

	  

		
	  

	###  å…³é”®ä¿¡æ¯ç‚¹   
- Windows DLLåŠ è½½æœºåˆ¶æ˜¯ç³»ç»Ÿä¸­çš„æ ¸å¿ƒç»„ä»¶ï¼Œå¯¹äºå®‰è£…ã€è¿è¡Œã€ä½¿ç”¨æˆ–ç ´è§£ç³»ç»Ÿéƒ½è‡³å…³é‡è¦ã€‚  
  
- DLLåŠ è½½è¿‡ç¨‹æ¶‰åŠå¤æ‚çš„å†…éƒ¨ç»“æ„å’Œä¾èµ–è§£æï¼Œè¿™äº›çŸ¥è¯†å¯¹äºæ¶æ„è½¯ä»¶å¼€å‘è€…å’Œå®‰å…¨ç ”ç©¶äººå‘˜éƒ½æ˜¯å®è´µçš„ã€‚  
  
- æ„å»ºè‡ªå·±çš„DLLåŠ è½½å™¨éœ€è¦æ·±å…¥ç†è§£Windowså†…éƒ¨å’ŒWIN32APIï¼Œä»¥åŠå¯¹Cè¯­è¨€ç¼–ç¨‹å’Œé€†å‘å·¥ç¨‹çš„ç†Ÿç»ƒæŒæ¡ã€‚  
  
- ç ”è®¨ä¼šæä¾›äº†è¯¦ç»†çš„æŠ€æœ¯è¦æ±‚å’Œç›®å½•ç»“æ„ï¼Œä»¥ä¾¿å‚ä¸è€…èƒ½å¤Ÿæœ‰æ•ˆåœ°å®Œæˆæ´»åŠ¨å¹¶å­¦ä¹ æ„å»ºDLLåŠ è½½å™¨çš„æŠ€èƒ½ã€‚  
  

	
	  
ğŸ·ï¸: Windows, DLL, åŠ è½½æœºåˆ¶, ç ”è®¨ä¼š, ç¼–ç¨‹  
###  0x0c TrickDumpï¼šæ— Minidumpæ–‡ä»¶çš„lsassè¿›ç¨‹å†…å­˜æŠ“å–å·¥å…·  

	>   
> TrickDump æ˜¯ä¸€ä¸ªå…è®¸åœ¨ä¸ç”Ÿæˆ Minidump æ–‡ä»¶çš„æƒ…å†µä¸‹ï¼ŒæŠ“å– lsass è¿›ç¨‹å†…å­˜çš„å·¥å…·ï¼Œå®ƒç”Ÿæˆä¸‰ä¸ª JSON æ–‡ä»¶å’Œä¸€ä¸ªåŒ…å«å†…å­˜åŒºåŸŸè½¬å‚¨çš„ zip æ–‡ä»¶ã€‚
		  
>   
  
  

	  

	
	![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTPgo69VtFHhXsy5HswA97wjF4oL0D4pM06icfnJgkBS9IHDszeJXXQYQQ/640?from=appmsg "")  

	
	![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTPicuFevS4B2jGtC7wzSd7caOoASHdYWjzbNytekcqnvIZF9Ml4No3Lug/640?from=appmsg "")  

	
	![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTPCEgk6XfU05lasydcStTdMic7hTowR0qP8Yc6hp9GseWrjCtxx4rwtrA/640?from=appmsg "")  

	  
  
<<<å·¦å³æ»‘åŠ¨è§æ›´å¤š >>>  

	###  çƒ­è¯„   
- TrickDumpï¼šæ— éœ€ç”Ÿæˆå†…å­˜è½¬å‚¨æ–‡ä»¶å³å¯è½¬å‚¨ lsass  
  
- TrickDumpï¼šæ— éœ€ç”Ÿæˆå†…å­˜è½¬å‚¨æ–‡ä»¶å³å¯è½¬å‚¨ lsass  
  

	  

		
	  

	###  å…³é”®ä¿¡æ¯ç‚¹   
- TrickDump çš„è®¾è®¡ç›®çš„æ˜¯åœ¨ä¸å¼•èµ·è¿‡å¤šå®‰å…¨è­¦æŠ¥çš„æƒ…å†µä¸‹ï¼Œå®‰å…¨åœ°è½¬å‚¨ lsass è¿›ç¨‹çš„å†…å­˜ã€‚  
  
- è¯¥å·¥å…·çš„ä¼˜åŠ¿åœ¨äºä¸ä¼šåœ¨ç£ç›˜ã€å†…å­˜æˆ–ç½‘ç»œæµé‡ä¸­äº§ç”Ÿæœ‰æ•ˆçš„ Minidump æ–‡ä»¶ï¼Œé™ä½äº†è¢«æ£€æµ‹åˆ°çš„é£é™©ã€‚  
  
- TrickDump é€šè¿‡åˆ†ç¦»æ”»å‡»æ­¥éª¤ï¼Œä½¿ç”¨ä¸‰ä¸ªç‹¬ç«‹çš„ç¨‹åºæ¥æ‰§è¡Œä¸åŒçš„ä»»åŠ¡ï¼Œè¿›ä¸€æ­¥é™ä½äº†è¢«æ£€æµ‹çš„å¯èƒ½æ€§ã€‚  
  
- è¯¥å·¥å…·æ”¯æŒå¤šç§æ–¹æ³•æ¥è¦†ç›– ntdll.dll åº“ï¼Œä»¥é˜²æ­¢ API é’©å­çš„æ£€æµ‹ã€‚  
  

	
	  
ğŸ·ï¸: ç½‘ç»œå®‰å…¨, å·¥å…·, å†…å­˜æŠ“å–, lsassè¿›ç¨‹  
###  0x0d Django SQL æ³¨å…¥æ¼æ´æ›å…‰  

	>   
> GitHub å®‰å…¨æ•°æ®åº“æŠ«éœ²äº† Django å­˜åœ¨çš„ SQL æ³¨å…¥æ¼æ´ï¼ˆCVE-2024-42005ï¼‰ï¼Œå½±å“ Django ç‰ˆæœ¬ 5.0 ä¹‹å‰çš„ 5.0.8 ä»¥åŠ 4.2 ä¹‹å‰çš„ 4.2.15ã€‚è¯¥æ¼æ´æºäº QuerySet.values() å’Œ values_list() æ–¹æ³•åœ¨æ¨¡å‹ä¸­åŒ…å« JSONField æ—¶çš„å¤„ç†ä¸å½“ï¼Œå¯é€šè¿‡ä¼ é€’åŒ…å«æ¶æ„ JSON å¯¹è±¡å¯†é’¥çš„å‚æ•°æ¥åˆ©ç”¨ã€‚
		  
>   
  
  

	  

	
	![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTP95Qfcl2SpguMNwaKeaU9mNPHTUVxFmibcRUVKWNlcLnh2fQN1RGu7DQ/640?from=appmsg "")  

	  


	###  çƒ­è¯„   
- Django QuerySet æ–¹æ³•å­˜åœ¨ SQL æ³¨å…¥æ¼æ´  
  
- Django SQL æ³¨å…¥æ¼æ´ CVE-2024-42005  
  

	  

		
	  

	###  å…³é”®ä¿¡æ¯ç‚¹   
- Django å­˜åœ¨ SQL æ³¨å…¥æ¼æ´ï¼šCVE-2024-42005 æ­ç¤ºäº†åœ¨æŸäº›ç‰ˆæœ¬çš„ Django ä¸­ï¼ŒQuerySet.values() å’Œ values_list() æ–¹æ³•å­˜åœ¨å®‰å…¨æ¼æ´ã€‚  
  
- å½±å“ç‰ˆæœ¬èŒƒå›´ï¼šå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ Django 5.0 ä¹‹å‰çš„ 5.0.8 å’Œ 4.2 ä¹‹å‰çš„ 4.2.15ã€‚  
  
- æ¼æ´æ¥æºï¼šæ¼æ´æ˜¯ç”±äºåœ¨æ¨¡å‹ä¸­ä½¿ç”¨ JSONField æ—¶ï¼Œè¿™äº›æ–¹æ³•å¯¹ä¼ é€’çš„å‚æ•°å¤„ç†ä¸å½“ã€‚  
  
- ä¿®å¤æªæ–½ï¼šDjango å·²ç»å‘å¸ƒäº†ä¿®å¤ç‰ˆæœ¬ï¼Œåˆ†åˆ«æ˜¯ 5.0.8 å’Œ 4.2.15ï¼Œä»¥è§£å†³è¯¥é—®é¢˜ã€‚  
  

	
	  
ğŸ·ï¸: Django, SQLæ³¨å…¥, æ¼æ´, GitHub, å®‰å…¨  
###  0x0e ä»£ç æ³¨å…¥å·¥å…·å®ç°æƒé™æå‡  

	>   
> è¯¥ç½‘é¡µæä¾›äº†ä¸¤ç§ä»£ç æ³¨å…¥å·¥å…·ï¼Œåˆ†åˆ«ç”¨äºé€šè¿‡OfficeClickToRunæœåŠ¡å’ŒShimæ•°æ®ç»“æ„å®ç°æƒé™æå‡å’Œæ— éœ€æ³¨å†Œæ–°SDBæ–‡ä»¶å³å¯æ³¨å…¥DLLã€‚
		  
>   
  
  

	  

	
	![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTPAVIQ5YFtrfMT1L5APQJlLggbYcncYVlttPkF06Kliamdt4oRSNTZVNg/640?from=appmsg "")  

	  


	###  çƒ­è¯„   
- DEFCON 32 æ¼”è®²åˆ†äº«ï¼šå·¥å…·æºä»£ç å·²å…¬å¼€  
  
- DEFCON 32æ¼”è®²åˆ†äº«å·¥å…·æºç å…¬å¼€  
  

	  

		
	  

	###  å…³é”®ä¿¡æ¯ç‚¹   
- Office Injector åˆ©ç”¨OfficeClickToRunæœåŠ¡çš„RPCæ–¹æ³•ï¼Œå¯ä»¥å®ç°æƒé™æå‡ï¼Œå°†DLLæ³¨å…¥åˆ°SYSTEMæƒé™çš„è¿›ç¨‹ä¸­ã€‚  
  
- Shim Injector é€šè¿‡å†…å­˜ä¸­çš„Shimæ•°æ®ç»“æ„æ“ä½œï¼Œå®ç°äº†ä¸ä¾èµ–äºSDBæ–‡ä»¶çš„DLLæ³¨å…¥æ–¹æ³•ã€‚  
  
- è¿™äº›å·¥å…·çš„ä½¿ç”¨å¯èƒ½æ¶‰åŠåˆ°å®‰å…¨é£é™©ï¼Œå› ä¸ºå®ƒä»¬èƒ½å¤Ÿç»•è¿‡æ­£å¸¸çš„ç³»ç»Ÿæƒé™æ§åˆ¶ï¼Œè¿›è¡Œä»£ç æ³¨å…¥ã€‚  
  
- æåˆ°çš„æŠ€æœ¯å’Œæ–¹æ³•å¯èƒ½è¢«ç”¨äºæ¶æ„è½¯ä»¶å’Œæ”»å‡»ä¸­ï¼Œå› æ­¤å¯¹äºç³»ç»Ÿå®‰å…¨å’Œæ¶æ„ä»£ç æ£€æµ‹å…·æœ‰é‡è¦æ„ä¹‰ã€‚  
  

	
	  
ğŸ·ï¸: ä»£ç æ³¨å…¥, æƒé™æå‡, OfficeClickToRun, Shimæ•°æ®ç»“æ„  
###  0x0f Windowsè¿œç¨‹æ¡Œé¢è®¸å¯æœåŠ¡æ¼æ´åˆ†æ  

	>   
> ç½‘é¡µä¸»è¦åˆ†æäº†Windowsè¿œç¨‹æ¡Œé¢è®¸å¯è¯æœåŠ¡ä¸­çš„ä¸€ä¸ªå®‰å…¨æ¼æ´ï¼Œå¹¶è¯¦ç»†ä»‹ç»äº†æ¼æ´çš„åŸç†ã€ä¿®å¤å‰åçš„ä»£ç å·®å¼‚ï¼Œä»¥åŠå¦‚ä½•æ„é€ PoCæ¥åˆ©ç”¨è¯¥æ¼æ´ã€‚
		  
>   
  
  

	  

	
	![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTPfPNH3yicwia3zlv7uX8ia03ia7swibicSQsqJQO2ib6Adibo1W2gIedkcsFv1A/640?from=appmsg "")  

	
	![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTPIzsLWJiaiaAUQ3CoUZmhBbDHnE19nibDFk3BsicLhBTpttLEGoPYfrEPCw/640?from=appmsg "")  

	
	![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTPL3N5q1teNxkBbU3lt1FlA1vH0tZZ9icVqQvop7R3hFjr6jk3gc6CTIg/640?from=appmsg "")  

	  
  
<<<å·¦å³æ»‘åŠ¨è§æ›´å¤š >>>  

	###  çƒ­è¯„   
- ã€Œç¼–è€…æ³¨ã€:èµ›åšæ˜†ä»‘çš„ä¸€ä¸ªå°å“¥ï¼Œä¹‹å‰å†™çš„åˆ†æå’Œdemo. è¯¥rpcçš„ç›¸å…³æ£€æµ‹å’Œç‰¹å¾ç‚¹ï¼Œå…¶å®ä¸Šä¸ªæœˆè¡¥ä¸æ—¥ï¼Œå°±æœ‰ä¸å°‘å›½å¤–å…¬å¸å‘äº†çš„.  
  

	  

		
	  

	###  å…³é”®ä¿¡æ¯ç‚¹   
- Windowsè¿œç¨‹æ¡Œé¢è®¸å¯è¯æœåŠ¡å­˜åœ¨å®‰å…¨æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚  
  
- æ¼æ´çš„ root cause åœ¨äºlserver.dllä¸­çš„HashChallengeDataå‡½æ•°å¤„ç†ä¸å½“ï¼Œå¯¼è‡´ç¼“å†²åŒºæº¢å‡ºã€‚  
  
- é€šè¿‡å¯¹æ¯”ä¿®å¤å‰åçš„ä»£ç ï¼Œå¯ä»¥çœ‹å‡ºè¡¥ä¸å¢åŠ äº†å¯¹å‚æ•°å€¼çš„æ£€æŸ¥ï¼Œä»¥é˜²æ­¢è¶Šç•Œæ“ä½œã€‚  
  
- åˆ©ç”¨è¯¥æ¼æ´çš„PoCå¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šæ ¼å¼çš„æ•°æ®åŒ…å¹¶å‘é€ç»™æœåŠ¡ç«¯æ¥å®ç°ï¼Œè¿™è¡¨æ˜åœ¨å®é™…ç¯å¢ƒä¸­å¯èƒ½å­˜åœ¨è¢«åŠ¨æ”»å‡»çš„é£é™©ã€‚  
  

	
	  
ğŸ·ï¸: Windows, è¿œç¨‹æ¡Œé¢, æ¼æ´, RPCæœåŠ¡, å®‰å…¨åˆ†æ  
###  0x10	L4LBå››å±‚è´Ÿè½½å‡è¡¡ä¸­çš„IPä¼ªé€ æ¼æ´è¯¦è§£  

	>   
> æœ¬æ–‡è¯¦ç»†ä»‹ç»äº†L4LBå››å±‚è´Ÿè½½å‡è¡¡ä¸­çš„IPä¼ªé€ æ¼æ´ï¼Œæ¢è®¨äº†æ¼æ´çš„å‘ç°ã€å½±å“ã€åŸç†ä»¥åŠå¦‚ä½•ä¿®å¤ã€‚
		  
>   
  
  

	  

	
	![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTPtXDJHiafstDKIQZ5aicr6c6iaP8dwRbrdfsba7eJQCqlIOw6S4VlxY3FA/640?from=appmsg "")  

	
	![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTPAs102h4zjKj0PdUyv8vC89xbs79DfTA8SDBWX7KLZ9xrvjktPdewTA/640?from=appmsg "")  

	
	![](https://mmbiz.qpic.cn/sz_mmbiz_png/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTPlBhicMHGGdKMduSTP6H9Sic4rHhg0BSMIlI6k1Cd3Wib7Teg7Adx7sIng/640?from=appmsg "")  

	  
  
<<<å·¦å³æ»‘åŠ¨è§æ›´å¤š >>>  

	###  çƒ­è¯„   

	  

		
	  

	###  å…³é”®ä¿¡æ¯ç‚¹   
- L4LBå››å±‚è´Ÿè½½å‡è¡¡åœ¨FNATæ¨¡å¼ä¸‹æœªèƒ½æ¸…é™¤TCP Optionä¸­çš„æ¶æ„æ„é€ çš„TOAä¿¡æ¯ï¼Œå¯¼è‡´IPä¼ªé€ æ¼æ´çš„å­˜åœ¨ã€‚  
  
- IPä¼ªé€ å¯èƒ½å¯¼è‡´åŸºäºIPç­–ç•¥çš„å®‰å…¨ç³»ç»Ÿå®Œå…¨å¤±æ•ˆï¼Œé€ æˆæå¤§çš„é£é™©æŸå¤±ã€‚  
  
- æ¼æ´çš„å‘ç°æ˜¯åœ¨é›¶ä¿¡ä»»å››å±‚è´Ÿè½½å‡è¡¡äº§å“çš„ç ”å‘è¿‡ç¨‹ä¸­æ„å¤–å‘ç°çš„ã€‚  
  
- L4LBåœ¨å¤„ç†å®¢æˆ·ç«¯TCP Optionæ—¶çš„ç­–ç•¥å·®å¼‚æ˜¯å®‰å…¨é—®é¢˜çš„æ ¹æºã€‚  
  

	
	  
ğŸ·ï¸: è´Ÿè½½å‡è¡¡, IPä¼ªé€ , æ¼æ´ä¿®å¤, ç½‘ç»œå®‰å…¨  
  
  

	  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/icqm3vRUymZm3z7q1TPvLib48LK4zo4icTPdcicJ2iaibsG3ZGAKicGaIIsSA0mV9W9tarQpPic4pibeVVke0Cp7oria4P3g/640?wx_fmt=jpeg "")  

	  

		å¿«æ¥å’Œè€å¸æœºä»¬ä¸€èµ·å­¦ä¹ å§  
  
