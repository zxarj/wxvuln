#  ã€å·¥å…·åˆ†äº«ã€‘Swagger API Exploit 1.2 - ä¿¡æ¯æ³„éœ²åˆ©ç”¨å·¥å…·   
åŸåˆ› Mstir  æ˜Ÿæ‚¦å®‰å…¨   2025-01-19 07:00  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/lSQtsngIibibSOeF8DNKNAC3a6kgvhmWqvoQdibCCk028HCpd5q1pEeFjIhicyia0IcY7f2G9fpqaUm6ATDQuZZ05yw/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
ç‚¹å‡»ä¸Šæ–¹  
è“å­—  
å…³æ³¨æˆ‘ä»¬ å¹¶è®¾ä¸º  
æ˜Ÿæ ‡  
## 0x01 å·¥å…·ä»‹ç»  
  
è¿™æ˜¯ä¸€ä¸ª Swagger REST API ä¿¡æ¯æ³„éœ²åˆ©ç”¨å·¥å…·ã€‚ ä¸»è¦åŠŸèƒ½æœ‰ï¼š  
  
- éå†æ‰€æœ‰APIæ¥å£ï¼Œè‡ªåŠ¨å¡«å……å‚æ•°  
  
  
- å°è¯• GET / POST æ‰€æœ‰æ¥å£ï¼Œè¿”å› Response Code / Content-Type / Content-Length ï¼Œç”¨äºåˆ†ææ¥å£æ˜¯å¦å¯ä»¥æœªæˆæƒè®¿é—®åˆ©ç”¨  
  
- åˆ†ææ¥å£æ˜¯å¦å­˜åœ¨æ•æ„Ÿå‚æ•°ï¼Œä¾‹å¦‚urlå‚æ•°ï¼Œå®¹æ˜“å¼•å…¥å¤–ç½‘çš„SSRFæ¼æ´  
  
- æ£€æµ‹ APIè®¤è¯ç»•è¿‡æ¼æ´  
  
- åœ¨æœ¬åœ°ç›‘å¬ä¸€ä¸ªWeb Serverï¼Œæ‰“å¼€Swagger UIç•Œé¢ï¼Œä¾›åˆ†ææ¥å£ä½¿ç”¨  
  
- ä½¿ç”¨Chromeæ‰“å¼€æœ¬åœ°WebæœåŠ¡å™¨ï¼Œå¹¶ç¦ç”¨CORSï¼Œè§£å†³éƒ¨åˆ†APIæ¥å£æ— æ³•è·¨åŸŸè¯·æ±‚çš„é—®é¢˜  
  
- å½“å·¥å…·æ£€æµ‹åˆ°HTTPè®¤è¯ç»•è¿‡æ¼æ´æ—¶ï¼Œæœ¬åœ°æœåŠ¡å™¨æ‹¦æˆªAPIæ–‡æ¡£ï¼Œä¿®æ”¹pathï¼Œä»¥ä¾¿ç›´æ¥åœ¨Swagger UIä¸­è¿›è¡Œæµ‹è¯•  
  
éœ€è¦ä»‹å…¥åˆ†æ api_summary.txt æ–‡ä»¶ä¸­çš„å†…å®¹ æ‰«ææ‰€æœ‰APIé›†ï¼Œæ‰“å¼€Swagger UI  
  
```
python swagger-exp.py http://site.com/swagger-resources/
```  
  
**æ‰«æä¸€ä¸ªAPIé›†ï¼Œæ‰“å¼€Swagger UI**  
```
python swagger-exp.py http://site.com/v2/api-docs
```  
  
**åªæ‰“å¼€Swagger UIï¼Œä¸æ‰«ææ¥å£**  
```
python swagger-exp.py
```  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/uicic8KPZnD5c4VRVwgKiazuBLAeH7HEJMj0QYlpib64IcmLzczE2ic0pAVGd0vzibWYCcicPCcRc905YWibg0Se8QiaUAg/640?wx_fmt=png&from=appmsg "")  
  
```
root@localhost# python swagger-exp.py[14:50:06] Swagger UI Server on: http://127.0.0.1:51979[14:50:06] Open Swagger UI with chrome127.0.0.1 - - [19/Jan/2025 14:50:12] "GET / HTTP/1.1" 200 -127.0.0.1 - - [19/Jan/2025 14:50:12] "GET /static/validator HTTP/1.1" 200 -127.0.0.1 - - [19/Jan/2025 14:50:12] "GET /static/swagger-ui.css HTTP/1.1" 200 -127.0.0.1 - - [19/Jan/2025 14:50:12] "GET /static/swagger-ui-bundle.js HTTP/1.1" 200 -127.0.0.1 - - [19/Jan/2025 14:50:12] "GET /static/swagger-ui-standalone-preset.js HTTP/1.1" 200 -127.0.0.1 - - [19/Jan/2025 14:50:12] code 404, message File not found127.0.0.1 - - [19/Jan/2025 14:50:12] "GET /api-docs.json HTTP/1.1" 404 -127.0.0.1 - - [19/Jan/2025 14:50:12] code 404, message File not found127.0.0.1 - - [19/Jan/2025 14:50:12] "GET /favicon.ico HTTP/1.1" 404 -
```  
  
  
  
è®¿é—®å‘½ä»¤è¡Œç»™å‡ºçš„åœ°å€å³å¯è®¿é—®åˆ°Swagger API Exploit è¿›è¡Œæ„‰å¿«çš„æ¸—é€æµ‹è¯•äº†ï¼Œæˆ‘è¿™é‡Œæ˜¯ http://127.0.0.1:51979  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/uicic8KPZnD5c4VRVwgKiazuBLAeH7HEJMjnkKMQmKlNEORNWDaibhHOVwOZDFpZr7rGf2lGVS3FntxgBzdo0K41Uw/640?wx_fmt=png&from=appmsg "")  
## 0x02 Swagger API æ¥å£å¤§å…¨  
  
Swagger çš„æŒ‡çº¹æ˜¯ app="Swagger"  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/uicic8KPZnD5c4VRVwgKiazuBLAeH7HEJMjDia2Hep23JbqiakUqJEvbVpKsNwibASiaJXAMYn8IlxaYg59iaqDNJs7BaA/640?wx_fmt=png&from=appmsg "")  
  
```
/api/api-docs/api-docs/swagger.json/api.html/api/api-docs/api/apidocs/api/doc/api/swagger/api/swagger-ui/api/swagger-ui.html/api/swagger-ui.html//api/swagger-ui.json/api/swagger.json/api/swagger//api/swagger/ui/api/swagger/ui//api/swaggerui/api/swaggerui//api/v1//api/v1/api-docs/api/v1/apidocs/api/v1/swagger/api/v1/swagger-ui/api/v1/swagger-ui.html/api/v1/swagger-ui.json/api/v1/swagger.json/api/v1/swagger//api/v2/api/v2/api-docs/api/v2/apidocs/api/v2/swagger/api/v2/swagger-ui/api/v2/swagger-ui.html/api/v2/swagger-ui.json/api/v2/swagger.json/api/v2/swagger//api/v3/apidocs/apidocs/swagger.json/doc.html/docs//druid/index.html/graphql/libs/swaggerui/libs/swaggerui//spring-security-oauth-resource/swagger-ui.html/spring-security-rest/api/swagger-ui.html/sw/swagger-ui.html/swagger/swagger-resources/swagger-resources/configuration/security/swagger-resources/configuration/security//swagger-resources/configuration/ui/swagger-resources/configuration/ui//swagger-ui/swagger-ui.html/swagger-ui.html#/api-memory-controller/swagger-ui.html//swagger-ui.json/swagger-ui/swagger.json/swagger.json/swagger.yml/swagger//swagger/index.html/swagger/static/index.html/swagger/swagger-ui.html/swagger/ui//Swagger/ui/index/swagger/ui/index/swagger/v1/swagger.json/swagger/v2/swagger.json/template/swagger-ui.html/user/swagger-ui.html/user/swagger-ui.html//v1.x/swagger-ui.html/v1/api-docs/v1/swagger.json/v2/api-docs/v3/api-docs
```  
  
## 0x03 å·¥å…·ä¸‹è½½  
  
**æ ‡ç­¾:ä»£ç å®¡è®¡ï¼Œ0dayï¼Œæ¸—é€æµ‹è¯•ï¼Œç³»ç»Ÿï¼Œé€šç”¨ï¼Œ0dayï¼Œé—²é±¼ï¼Œè½¬è½¬**  
  
å·¥å…·  
**å…³æ³¨å…¬ä¼—å·å‘é€ 250119 è·å–!**  
  
  
  
****  
**å¼€äº†ä¸ªæ˜Ÿæ‚¦å®‰å…¨å…¬å¼€äº¤æµ2ç¾¤ï¼ŒğŸˆ²å‘å…¬ä¼—å·ï¼Œçº¯ç²¹ç ”ç©¶æŠ€æœ¯ï¼Œè¿˜ä¼šæ‹‰ä¸€äº›å¤§ä½¬ï¼Œå¸Œæœ›å¤§å®¶å¤šå¤šäº¤æµ.**  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/uicic8KPZnD5cVY95H7tSkdBibeP8gaCafQlIAGvwMjWViahIHLVzvxa8IXjkL69q5Uic6ymkEMuDfAQRia8AZYL6A2Q/640?wx_fmt=jpeg&from=appmsg "")  
  
**å…è´£å£°æ˜:****æ–‡ç« ä¸­æ¶‰åŠçš„ç¨‹åº(æ–¹æ³•)å¯èƒ½å¸¦æœ‰æ”»å‡»æ€§ï¼Œä»…ä¾›å®‰å…¨ç ”ç©¶ä¸æ•™å­¦ä¹‹ç”¨ï¼Œè¯»è€…å°†å…¶ä¿¡æ¯åšå…¶ä»–ç”¨é€”ï¼Œç”±è¯»è€…æ‰¿æ‹…å…¨éƒ¨æ³•å¾‹åŠè¿å¸¦è´£ä»»ï¼Œæ–‡ç« ä½œè€…å’Œæœ¬å…¬ä¼—å·ä¸æ‰¿æ‹…ä»»ä½•æ³•å¾‹åŠè¿å¸¦è´£ä»»ï¼Œæœ›å‘¨çŸ¥ï¼ï¼!**  
  
