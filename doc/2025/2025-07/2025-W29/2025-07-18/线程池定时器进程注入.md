> **åŸæ–‡é“¾æ¥**: https://mp.weixin.qq.com/s?__biz=MzAxMjYyMzkwOA==&mid=2247531828&idx=1&sn=4381a27123c22b6fb996e14610172733

#  çº¿ç¨‹æ± å®šæ—¶å™¨è¿›ç¨‹æ³¨å…¥  
 Otså®‰å…¨   2025-07-18 02:34  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/bL2iaicTYdZn7gtxSFZlfuCW6AdQib8Q1onbR0U2h9icP1eRO6wH0AcyJmqZ7USD0uOYncCYIH7ZEE8IicAOPxyb9IA/640?wx_fmt=gif "")  
  
çº¿ç¨‹æ± å®šæ—¶å™¨è¿›ç¨‹æ³¨å…¥æ˜¯ä¸€ç§åˆ©ç”¨ Windows çº¿ç¨‹æ± æ‰§è¡Œ Shellcode çš„æŠ€æœ¯ã€‚ä½¿ç”¨ CreateThreadpoolTimer è¿›è¡Œç»å…¸çš„ DLL æ³¨å…¥ï¼Œä½¿ç”¨åˆæ³•çš„ç³»ç»Ÿçº¿ç¨‹åœ¨å†…å­˜ä¸­è¿è¡Œ Shellcodeï¼Œè¿™ç§æŠ€æœ¯éå¸¸éšè”½ï¼Œè€Œä¸”å¾ˆå®¹æ˜“çªç ´ç°ä»£é˜²å¾¡æœºåˆ¶ã€‚  
  
è¿™ç§æ–¹æ³•å¼•å…¥äº†ä¸€ç§éšç§˜çš„æ‰§è¡Œå‘é‡ï¼Œé¿å…äº†ç»å…¸çš„ API é’©å­ï¼ˆä¾‹å¦‚CreateRemoteThreadã€NtCreateThreadExå’Œ APCï¼‰ï¼Œè¿™ä½¿å¾—å®ƒå¯¹äºçº¢é˜Ÿæ“ä½œå’Œæ¶æ„è½¯ä»¶ç ”ç©¶æå…·å¸å¼•åŠ›ã€‚  
  
  
ğŸ› ï¸ æŠ€æœ¯å®ç°  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/rWGOWg48tafrMzIYYkSzsphGO3QCxd1PS9Y64EDWddk7kC3n4soEMkDpvblUWLd9ueqPLacV9JqMlmg9Rc2YWA/640?wx_fmt=png&from=appmsg "")  
  
ğŸ§© æ ¸å¿ƒç»„ä»¶  
  
ğŸ›   
Â ä¸»æ³¨å…¥å™¨ï¼ˆInjector.cppï¼‰  
- è¿›ç¨‹æšä¸¾å’Œç›®æ ‡é€»è¾‘  
  
- DLL æ³¨å…¥ä½¿ç”¨CreateRemoteThreadå’ŒLoadLibraryW  
  
- é”™è¯¯å¤„ç†å’Œæ‰§è¡ŒçŠ¶æ€æŠ¥å‘Š  
  
â² å®šæ—¶å™¨ DLL ( TimerDLL.cpp)  
- åŸºäºè®¡æ—¶å™¨çš„shellcodeæ‰§è¡Œå®ç°  
  
- TP_CALLBACK_ENVIRONçº¿ç¨‹æ± é…ç½®çš„ç»“æ„è®¾ç½®  
  
- é€šè¿‡å®šæ—¶å™¨å›è°ƒæ‰§è¡Œshellcode  
  
ğŸ“‹Â   
API åºåˆ—  
  

```
OpenProcess()Â // Access the target process
VirtualAllocEx()Â // Allocate memory in remote processÂ 
WriteProcessMemory()Â // Write shellcode or DLL path
CreateRemoteThread()Â // Create a remote thread to execute payload
LoadLibraryW()Â // Load a DLL via thread execution


â±ï¸Â ThreadPoolTimer-BasedAPIs

InitializeThreadpoolEnvironment()Â // Configure threadpool callback environment
CreateThreadpoolTimer()Â // Create a timer object
SetThreadpoolTimer()Â // Schedule the timer for execution
TimerCallback()Â // Callback function that executes shellcode
```

  
  
é¡¹ç›®åœ°å€ï¼š  
  
https://github.com/andreisss/Thread-Pool-Timer-Process-Injection  
  
  
  
æ„Ÿè°¢æ‚¨æŠ½å‡º  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycNnFvFYVgXoExRy0gqCkqvrAghf8KPXnwQaYq77HMsjcVka7kPcBDQw/640?wx_fmt=gif "")  
  
.  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycd5KMTutPwNWA97H5MPISWXLTXp0ibK5LXCBAXX388gY0ibXhWOxoEKBA/640?wx_fmt=gif "")  
  
.  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycU99fZEhvngeeAhFOvhTibttSplYbBpeeLZGgZt41El4icmrBibojkvLNw/640?wx_fmt=gif "")  
  
æ¥é˜…è¯»æœ¬æ–‡  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWge7Mibiad1tV0iaF8zSD5gzicbxDmfZCEL7vuOevN97CwUoUM5MLeKWibWlibSMwbpJ28lVg1yj1rQflyQ/640?wx_fmt=gif "")  
  
**ç‚¹å®ƒï¼Œåˆ†äº«ç‚¹èµåœ¨çœ‹éƒ½åœ¨è¿™é‡Œ**  
  
