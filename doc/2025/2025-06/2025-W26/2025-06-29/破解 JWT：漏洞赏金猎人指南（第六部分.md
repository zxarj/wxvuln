> **åŸæ–‡é“¾æ¥**: https://mp.weixin.qq.com/s?__biz=MzkwOTE5MDY5NA==&mid=2247506847&idx=1&sn=4272d6c554696334581739689d4dadd8

#  ç ´è§£ JWTï¼šæ¼æ´èµé‡‘çŒäººæŒ‡å—ï¼ˆç¬¬å…­éƒ¨åˆ†  
haidragon  å®‰å…¨ç‹—çš„è‡ªæˆ‘ä¿®å…»   2025-06-29 07:40  
  
# å®˜ç½‘ï¼šhttp://securitytech.cc/  
#   
## é€šè¿‡ç®—æ³•æ··æ·†ç»•è¿‡ JWT èº«ä»½éªŒè¯  
  
  
Â   
  
Â â€œæœ‰æ—¶å€™ï¼Œè¿™ä¸æ˜¯ç®—æ³•çš„é”™ï¼Œè€Œæ˜¯å¼€å‘äººå‘˜ç›²ç›®åœ°ä¿¡ä»»äº†ç®—æ³•
```
alg
```

ã€‚â€~ Aditya Bhatt ğŸ§ ğŸ—¿  
  
æ¬¢è¿å›æ¥ï¼Œé»‘å®¢ä»¬ï¼è¿™æ˜¯æˆ‘çš„â€œç ´è§£ JWTâ€ç³»åˆ—çš„ç¬¬å…­éƒ¨åˆ†â€”â€”ä¸€ç«™å¼æŒ‡å—ï¼ŒåŠ©æ‚¨åœ¨ç°å®ä¸–ç•Œçš„æ¼æ´èµé‡‘ç‹©çŒä¸­æŒæ¡ JWT çš„åˆ©ç”¨æŠ€å·§ã€‚  
  
å¦‚æœæ‚¨é”™è¿‡äº†å‰é¢çš„éƒ¨åˆ†ï¼Œè¯·åœ¨è¿™é‡ŒæŸ¥çœ‹ï¼šÂ   
- ç¬¬ä¸€éƒ¨åˆ† â€”â€” JWT åŸºç¡€çŸ¥è¯†å’Œå¼±å¯†é’¥æš´åŠ›ç ´è§£  
- ç¬¬ 2 éƒ¨åˆ† â€” æ— ç®—æ³•æ¼æ´  
- ç¬¬ 3 éƒ¨åˆ† â€” JWKS å…¬é’¥æ··æ·†  
- ç¬¬ 4 éƒ¨åˆ† â€” JKU å¤´éƒ¨æ³¨å…¥  
- ç¬¬ 5 éƒ¨åˆ† â€” é€šè¿‡æ ‡å¤´è¿›è¡Œè·¯å¾„éå†
```
kid
```

  
JWT æ–‡ç« ç´¢å¼•  
  
  
  
  
# ğŸ§  ç®€ä»‹ï¼šç®—æ³•æ··æ·†åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ  
  
åœ¨ JWT ä¸­ï¼Œ
```
alg
```

æ ‡å¤´å®šä¹‰äº†ç”¨äºç­¾åå’ŒéªŒè¯ä»¤ç‰Œçš„ç®—æ³•ã€‚é€šå¸¸
```
RS256
```

ä½¿ç”¨éå¯¹ç§°ç®—æ³•ï¼Œå³æœåŠ¡å™¨ä½¿ç”¨ç§é’¥è¿›è¡Œç­¾åï¼Œä½¿ç”¨å…¬é’¥è¿›è¡ŒéªŒè¯ã€‚  
  
ä½†æ˜¯å¦‚æœæœåŠ¡å™¨ç›²ç›®ä¿¡ä»»
```
alg
```

æ ‡å¤´å¹¶ä¸”ä¸å¼ºåˆ¶æ‰§è¡Œä¸¥æ ¼çš„éªŒè¯......ğŸ‘€æˆ‘ä»¬å¯ä»¥å°†å…¶åˆ‡æ¢åˆ°
```
HS256
```

å¯¹ç§°ç®—æ³•ï¼Œå¹¶ä½¿ç”¨æœåŠ¡å™¨è‡ªå·±çš„å…¬é’¥ä½œä¸º HMAC å¯†é’¥æ¥ä¼ªé€ ä»¤ç‰Œã€‚  
> è¿™å°±æ˜¯ä½ å¦‚ä½•ä»…ä½¿ç”¨å…¬é’¥å’Œä¸€ä¸ªå·å·æ‘¸æ‘¸çš„å¼€å…³æ¥å†’å……ç®¡ç†å‘˜çš„æ–¹æ³•ã€‚ğŸ§™â€â™‚ï¸  
  
  
  
  
JWT èº«ä»½éªŒè¯ç»•è¿‡ ç¬¬ 6 ç¯‡  
  
  
  
  
# ğŸ¯ å®éªŒå®¤ç›®æ ‡  
  
å®éªŒå®¤ï¼šé€šè¿‡ç®—æ³•æ··æ·†ç»•è¿‡ JWT èº«ä»½éªŒè¯éš¾åº¦ï¼šä¸“å®¶ç›®æ ‡ï¼šåˆ©ç”¨ JWT éªŒè¯ä¸­çš„ç®—æ³•æ··æ·†æ¥è·å–ç®¡ç†å‘˜è®¿é—®æƒé™å¹¶åˆ é™¤ç”¨æˆ·
```
carlos
```

ã€‚  
  
  
  
# ğŸ§ª é€æ­¥åˆ©ç”¨ï¼ˆPoCï¼‰  
  
èƒŒæ™¯ï¼šä» Burp Suite çš„ BApp Store å®‰è£… JWT ç¼–è¾‘å™¨æ‰©å±•ï¼Œä»¥ä¾¿è½»æ¾æ“ä½œä»¤ç‰Œã€‚  
  
  
  
  
ğŸ› ï¸è®©æˆ‘ä»¬å¼€å§‹å§â€¦â€¦  
  
  
  
# 1. è¿›å…¥å®éªŒå®¤å¹¶ç™»å½•  
  
å‰å¾€å®éªŒå®¤å¹¶ä½¿ç”¨ä»¥ä¸‹å‡­è¯ç™»å½•ï¼š  
  
Username: wiener Â   
  
Password: peter  
  
  
  
  
  
  
# 2.å°è¯•è®¿é—®/admin  
  
æ‰‹åŠ¨å¯¼èˆªåˆ°
```
/admin
```

ã€‚æ‚¨å°†çœ‹åˆ°å¦‚ä¸‹æ¶ˆæ¯ï¼š  
> â€œä»…ä»¥ç®¡ç†å‘˜èº«ä»½ç™»å½•æ—¶æ‰å¯ä½¿ç”¨ç®¡ç†ç•Œé¢ã€‚â€  
  
  
  
  
  
ç›®å‰è¿˜æ²¡æœ‰ä»€ä¹ˆä»¤äººæƒŠè®¶çš„äº‹æƒ…......ä½†è¿™ç§æƒ…å†µå³å°†æ”¹å˜ã€‚ğŸ§¨  
  
  
  
# 3. å‘é€ /admin åˆ° Repeater  
  
ä½¿ç”¨ Burpæ•è·
```
/admin
```

è¯·æ±‚å¹¶å°†å…¶å‘é€åˆ° Repeaterã€‚æˆ‘ä»¬å¾ˆå¿«å°±ä¼šæ›¿æ¢æ­¤è¯·æ±‚ä¸­çš„ JWTã€‚  
  
  
  
  
  
  
# 4. æ‰¾åˆ°æœåŠ¡å™¨çš„å…¬é’¥  
  
ç°åœ¨åœ¨æ‚¨çš„æµè§ˆå™¨ä¸­ï¼Œè®¿é—®æœåŠ¡å™¨çš„ JWK ç«¯ç‚¹ï¼š  

```
https://<your-lab-id>.web-security-academy.net/jwks.json
```

  
ä»å“åº”ä¸­å¤åˆ¶å…³é”®å¯¹è±¡ï¼ˆå¦‚æœå®ƒåœ¨æ•°ç»„ä¸­ï¼Œåˆ™çœç•¥æ–¹æ‹¬å·ï¼‰ï¼š  

```

```


```
{&#34;kty&#34;:&#34;RSA&#34;,&#34;e&#34;:&#34;AQAB&#34;,&#34;use&#34;:&#34;sig&#34;,&#34;kid&#34;:&#34;8660d963-1b64-4e93-96b2-1bb9fb258620&#34;,&#34;alg&#34;:&#34;RS256&#34;,&#34;n&#34;:&#34;rM3x...&#34;}
```

  
  
  
  
  
  
  
# 5. ç”Ÿæˆæ¶æ„ç­¾åå¯†é’¥  
  
åœ¨ JWT ç¼–è¾‘å™¨ â†’ å¯†é’¥é€‰é¡¹å¡ä¸­ï¼š  
- å•å‡»â€œæ–°å»º RSA å¯†é’¥â€  
- ç²˜è´´å¤åˆ¶çš„ JWK  
- ä¿å­˜  
- å³é”®ç‚¹å‡» â†’ å°†å…¬é’¥å¤åˆ¶ä¸º PEM  
ç°åœ¨ä½ å·²ç»æ‹¥æœ‰äº†ä¸€ä¸ªé—ªäº®çš„ PEM å¯ä»¥ç”¨æ¥æ­¦å™¨äº†ã€‚ğŸ§¨  
  
  
  
  
  
  
# 6. Base64 ç¼–ç å…¬é’¥  
  
è½¬åˆ° Burp çš„è§£ç å™¨ï¼š  
- ç²˜è´´ PEM  
- ç¼–ç ä¸º Base64  
- å¤åˆ¶ç»“æœ  
è¿™å¾ˆå¿«å°±ä¼šæˆä¸ºä½ çš„HMAC ç§˜å¯†äº†ã€‚çœŸçš„ï¼ğŸ˜ˆ  
  
  
  
  
  
  
# 7. ä½¿ç”¨ PEM ä½œä¸ºå¯†é’¥åˆ›å»ºå¯¹ç§°å¯†é’¥  
  
å†æ¬¡è¿”å› JWT ç¼–è¾‘å™¨ â†’ Keys é€‰é¡¹å¡ï¼š  
- å•å‡»â€œæ–°å»ºå¯¹ç§°å¯†é’¥â€  
- å°†å€¼æ›¿æ¢
```
k
```

ä¸º Base64 ç¼–ç çš„ PEM  
- èŠ‚çœ  
è½°éš†éš†â€”â€”æœåŠ¡å™¨çš„å…¬é’¥ç°åœ¨å°±æ˜¯æˆ‘ä»¬çš„ç§˜å¯†äº†ã€‚ğŸ˜  
  
  
  
  
  
  
# 8. ä¿®æ”¹ç®¡ç†å‘˜è®¿é—®æƒé™çš„ JWT  
  
è¿”å› Repeater â†’ JSON Web Token é€‰é¡¹å¡ï¼š  
- è®¾ç½®
```
&#34;alg&#34;
```

ä¸º
```
&#34;HS256&#34;
```

  
- æ›´æ”¹
```
&#34;sub&#34;
```

ä¸º
```
&#34;administrator&#34;
```

  
- ç‚¹å‡»ç­¾å  
- é€‰æ‹©ä¸Šé¢åˆ›å»ºçš„å¯¹ç§°å¯†é’¥  
- å‹¾é€‰ä¸è¦ä¿®æ”¹æ ‡é¢˜æ¡†  
ä½ ç°åœ¨æŒæœ‰çš„æ˜¯ä¸€ä¸ªæ‹¥æœ‰ç¥çº§è®¿é—®æƒé™çš„ä¼ªé€ ä»¤ç‰Œã€‚ğŸ›¡ï¸  
  
  
  
  
  
  
# 9.å‘é€ä»¤ç‰Œ  
  
åœ¨ä¸­ç»§å™¨ä¸­ç‚¹å‡»â€œå‘é€â€ã€‚  
  
ğŸ‰ æˆåŠŸï¼æ‚¨å·²ä»¥ç®¡ç†å‘˜èº«ä»½ç™»å½•â€”â€”æ— éœ€ç§é’¥ï¼Œæ— éœ€æš´åŠ›ç ´è§£ï¼Œæ— éœ€ä»»ä½•å¹²æ‰°ã€‚åªéœ€çº¯ç²¹çš„ JWT é»‘é­”æ³•ã€‚ğŸª„ğŸ’€  
  
  
  
  
  
  
# 10.åˆ é™¤å¡æ´›æ–¯  
  
ç°åœ¨ç»§ç»­å°† URL ä¿®æ”¹ä¸ºï¼š  

```
/admin/delete?username=carlos
```

  
ç‚¹å‡»â€œå‘é€â€ã€‚  
  
  
  
  
å¯æ€œçš„å¡æ´›æ–¯ä»æ¥æ²¡æœ‰æƒ³åˆ°ä¼šå‘ç”Ÿè¿™æ ·çš„äº‹ğŸª¦  
  
  
  
# 11.ç¡®è®¤å®éªŒå®¤å·²è§£å†³  
  
å³é”®â†’åœ¨æµè§ˆå™¨ä¸­æ˜¾ç¤ºâ†’ç²˜è´´è¯·æ±‚URLã€‚  
  
æ‚¨å°†æ”¶åˆ°ä¸€æ¡ç”œèœœçš„æ¶ˆæ¯ï¼Œå°†å®éªŒå®¤æ ‡è®°ä¸ºâœ…å·²è§£å†³ã€‚  
  
  
Â   
  
  
  
  
# ğŸ” åˆšæ‰å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ  
  
è®©æˆ‘ä»¬åˆ†è§£ä¸€ä¸‹ï¼š  
- æœåŠ¡å™¨éœ€è¦ RS256  
- æˆ‘ä»¬å‘é€ HS256  
- æœåŠ¡å™¨ç›²ç›®æ¥å—è¯¥
```
alg
```

å€¼  
- æˆ‘ä»¬ä½¿ç”¨å…¶å…¬é’¥ï¼ˆç”¨äºéªŒè¯ï¼‰ä½œä¸º HMAC å¯†é’¥  
- ğŸ” å®ƒåƒä¸€ä¸ªå¥½çš„æœºå™¨äººä¸€æ ·éªŒè¯äº†ä»¤ç‰Œã€‚æ¸¸æˆç»“æŸã€‚  
# ğŸš¨å®‰å…¨å½±å“  
- æ— éœ€ç§é’¥å³å¯ç»•è¿‡èº«ä»½éªŒè¯  
- ç®¡ç†å‘˜å†’å……  
- ä¸¥é‡æ¼æ´  
- å®Œå…¨è‡ªåŠ¨åŒ–  
- ğŸ§¨ å®é™…åº”ç”¨ä¸­çš„é«˜ä¸¥é‡æ€§ CVSS  
# ğŸ” ç¼“è§£æŠ€å·§  
- å§‹ç»ˆ
```
alg
```

åœ¨åç«¯å¼ºåˆ¶æ‰§è¡Œä¸¥æ ¼çš„å€¼  
- ç¦ç”¨å¤šç§ç®—æ³•çš„æ”¯æŒ  
- æ°¸è¿œä¸è¦ç›¸ä¿¡å®¢æˆ·ç«¯æä¾›çš„åŠ å¯†å†³ç­–æ ‡å¤´  
- ä½¿ç”¨ç»è¿‡å……åˆ†æµ‹è¯•å¹¶å®‰å…¨é…ç½®çš„ JWT åº“  
# ğŸ§  é“­åˆ»æˆ‘å¿ƒçš„æ•™è®­  
- JWT å¹¶éçµä¸¹å¦™è¯â€”â€”ç³Ÿç³•çš„å®ç° = ğŸ’£  
- åˆ‡å‹¿æ··åˆä½¿ç”¨å¯¹ç§°å’Œéå¯¹ç§°ç®—æ³•  
- å¦‚æœä½ æ­£åœ¨ä½¿ç”¨
```
RS256
```

ï¼Œè¯·åƒå¯¹å¾…ä½ çš„å­©å­ä¸€æ ·å¯¹å¾…å®ƒâ€”â€”ä¸å…è®¸è¿›è¡Œ HMAC äº¤æ¢  
- é˜…è¯» RFCâ€”â€”å®ƒä»¬å°†ç§˜å¯†éšè—åœ¨æ˜¾è€Œæ˜“è§çš„åœ°æ–¹  
# Â   
  
  
  
# ğŸ‰ é»‘å®¢å¿«ä¹ & æœ€åçš„è¯  
  
å„ä½ï¼Œç¬¬å…­éƒ¨åˆ†å°±åˆ°è¿™é‡Œäº†ã€‚åˆä¸€ä¸ª JWT é…ç½®é”™è¯¯ï¼Œä½ çš„çº¢é˜Ÿæ­¦å™¨åº“åˆå¤šäº†ä¸€ä¸ªæ¼æ´ã€‚ä¿æŒè­¦æƒ•ï¼Œä¿æŒå¥½å¥‡å¿ƒâ€”â€”å¹¶ä¸”å§‹ç»ˆæµ‹è¯•
```
alg
```

headerï¼Œå°±åƒä½ çš„ä¸‹ä¸€ä¸ªèµé‡‘å–å†³äºå®ƒä¸€æ ·ã€‚  
> ç›´åˆ°ä¸‹ä¸€æ¬¡â€¦â€¦ç»§ç»­æ‰“ç ´ä»¤ç‰Œå¹¶è®°ä¸‹åå­—ã€‚  
  
  
  
  
# ğŸ”“ ä¼ å¥‡ä»¬ï¼Œç¥ä½ ä»¬é»‘å®¢æ„‰å¿«ï¼ğŸ§™â€â™‚ï¸ğŸ—¿  
  
è®©æ‚¨çš„ä»¤ç‰Œå§‹ç»ˆæœ‰æ•ˆï¼Œå¹¶ä¸”æ‚¨çš„ç§˜å¯†å§‹ç»ˆæ³„éœ²ï¼ˆä»…å‘æ‚¨æ³„éœ²ï¼‰ã€‚  
  
  
  
![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERFwEstUwtm1vDJuUhUe81vt6swbj15W6qnwhpKrXqFcarBHtqmnyKNKJoGsr5lOq3BN4uUgV8jic5Q/640?wx_fmt=png&from=appmsg&watermark=1&tp=webp&wxfrom=5&wx_lazy=1 "")  
  
-   
- å…¬ä¼—å·:å®‰å…¨ç‹—çš„è‡ªæˆ‘ä¿®å…»  
  
- vx:2207344074  
  
- http://  
gitee.com/haidragon  
  
- http://  
github.com/haidragon  
  
- bilibili:haidragonx  
  
- ![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERHYgfyicoHWcBVxH85UOBNaPMJPjIWnCTP3EjrhOXhJsryIkR34mCwqetPF7aRmbhnxBbiaicS0rwu6w/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
-   
- ![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERHYgfyicoHWcBVxH85UOBNaPZeRlpCaIfwnM0IM4vnVugkAyDFJlhe1Rkalbz0a282U9iaVU12iaEiahw/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
