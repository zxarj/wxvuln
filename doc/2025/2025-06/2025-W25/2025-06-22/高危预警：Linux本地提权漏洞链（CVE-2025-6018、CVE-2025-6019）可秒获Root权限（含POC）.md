> **原文链接**: https://mp.weixin.qq.com/s?__biz=Mzg4NTg5MDQ0OA==&mid=2247488147&idx=1&sn=b7dcde65044806a8c881b16e905637ee

#  高危预警：Linux本地提权漏洞链（CVE-2025-6018、CVE-2025-6019）可秒获Root权限（含POC）  
原创 道玄安全  道玄网安驿站   2025-06-21 23:00  
  
**“**  
   
一套组合拳，普通账户直通系统最高权限  
。**”**  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/L369x9IF3yPA9bic9zzTydWv4XTTHH2NAiamMp8Kxsh4s2lukPuyuwnia3NiaHkiaU8a3JGFhLvNnYvtLvHTFAd91Rw/640?wx_fmt=png&from=appmsg "")  
  
      
![](https://mmbiz.qpic.cn/sz_mmbiz_png/L369x9IF3yPMwVHx9iaPDKDhBJiajRW2DIdq0Wxe7JcpgKDia3zMfgicaaD6Auwn6Q3GGm2vI0eNh1Qic6OUhHMjE7g/640?wx_fmt=png&from=appmsg "")  
  
  
  
PS：有内网web自动化需求可以私信  
  
  
  
  
01  
  
—  
  
  
  
导语  
  
  
    Linux系统管理员和安全团队请注意！安全研究人员近日披露了两项  
**高度危险且可链式利用**  
的本地权限提升漏洞（CVE-2025-6018 和 CVE-2025-6019），攻击者能够借此在主流Linux发行版上  
**轻松获取完整的root权限**  
。  
  
    这一漏洞链由Qualys威胁研究部门（TRU）发现并验证，其最大威胁在于利用难度低且影响范围广泛，被研究人员称为   
**“具有普遍性的重大风险”**  
。  
  
POC链接：  

```
https://cdn2.qualys.com/2025/06/17/suse15-pam-udisks-lpe.txt
```

  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/L369x9IF3yMDf7emB78IqKD0So0bS9InFCzEXOszZMQmrgNWTked9OdyAHImjibJ1AsHvuepzR6icYzVkJRKV0Ow/640?wx_fmt=png&from=appmsg "")  
## 漏洞链如何运作：从普通用户到root的完整路径  
  
这两个漏洞可被串联利用，形成一条完整的攻击路径：  
### 第一步：CVE-2025-6018（PAM配置缺陷）  
  
**影响范围**  
：openSUSE Leap 15 和 SUSE Linux Enterprise   
  
    该漏洞源于Pluggable Authentication Modules（PAM）的配置缺陷。攻击者通过SSH登录时，可操纵环境变量（如伪造   

```
XDG_SEAT
```

  
 和   

```
XDG_VTNR
```

  
），  
**欺骗系统将其识别为“物理在场用户”**  
（即拥有   

```
allow_active
```

  
 状态）。这一状态本应仅授予实际接触控制台的用户。  
  
    利用此漏洞，攻击者能够绕过polkit策略限制，执行本应保留给物理用户的操作（例如挂载存储设备、重启系统等）。  
### 第二步：CVE-2025-6019（libblockdev/udisks 漏洞）  
  
**影响范围**  
：Ubuntu、Debian、Fedora、openSUSE等大多数主流Linux发行版  
  
    当攻击者获得   

```
allow_active
```

  
 状态后（无论通过CVE-2025-6018还是其他途径），即可利用此漏洞进行  
**最终提权至root**  
。漏洞存在于   
**libblockdev 库**  
中，该库被默认安装的   
**udisks 守护进程**  
调用。  
  
**攻击原理**  
：udisks在响应请求（如调整XFS文件系统大小）时，会使用libblockdev在  

```
/tmp
```

  
下临时挂载文件系统镜像。  
**关键问题在于，此挂载操作未强制执行 nosuid 和 nodev 安全选项**  
。  
  
    攻击者借此制作一个包含  
**SUID-root shell**  
的恶意XFS镜像，通过udisks挂载该镜像后，即可执行此Shell并  
**瞬间获得完整的root权限**  
。  
## 为什么这个漏洞链如此危险？  
1. **利用门槛极低**  
：攻击者只需拥有一个普通的本地用户账号或SSH访问权限，无需物理接触设备，也无需借助其他复杂工具或漏洞。  
  
1. **影响范围极其广泛**  
：  
  
1. CVE-2025-6018 主要影响SUSE家族发行版（openSUSE Leap 15， SLE 15）。  
  
1. **CVE-2025-6019 影响几乎所有主流发行版**  
，包括 Ubuntu， Debian， Fedora， openSUSE 等。  
**udisks服务在98%的企业Linux系统上默认启用**  
，包括服务器环境。  
  
1. **利用速度快，后果严重**  
：Qualys TRU已开发出PoC（概念验证）利用代码，并成功在Ubuntu、Debian、Fedora和openSUSE等系统上实现提权，  
**整个过程仅需几秒钟**  
。获得root权限意味着攻击者可以：  
  
1. 完全控制系统  
  
1. 禁用或绕过EDR（端点检测与响应）等安全防护软件  
  
1. 安装内核级 rootkit 或后门程序实现持久化  
  
1. 修改系统关键配置  
  
1. 以当前系统为跳板，进行横向移动，攻击网络内其他设备  
  
1. **默认组件即可完成攻击**  
：整个攻击链利用的都是Linux发行版中  
**普遍预装且默认启用的组件**  
（PAM， udisks， libblockdev， polkit）。攻击者无需额外安装任何特殊软件。  
  
## 受影响的系统与补丁状态  
- **SUSE/openSUSE**  
：已发布针对CVE-2025-6018和CVE-2025-6019的补丁（6月17日）。  
  
- **Ubuntu**  
：虽然其  
**默认PAM配置可免疫CVE-2025-6018**  
（因   

```
pam_env.so
```

  
 的调用顺序或   

```
user_readenv
```

  
 选项未启用），但   
**CVE-2025-6019 影响所有受支持的Ubuntu版本**  
。Canonical已发布更新的   

```
libblockdev
```

  
 和   

```
udisks2
```

  
 软件包。  
  
- **Debian**  
：已发布更新的   

```
libblockdev
```

  
 和   

```
udisks2
```

  
 软件包。  
  
- **Fedora**  
：补丁正在更新中，建议密切监控官方公告。  
  
## 紧急缓解与修复措施  
1. **立即应用补丁（首选方案）**  
：  
  
1. **SUSE/openSUSE用户**  
：立即安装官方安全更新。  
  
1. **Ubuntu用户**  
：运行以下命令升级关键软件包：  

```
sudo apt update && sudo apt upgrade
```

  
或针对性升级：  

```
# Ubuntu 24.04 (Noble) 及更新版本：
sudo apt update && sudo apt install --only-upgrade libblockdev3 udisks2
# Ubuntu 22.04 (Jammy) 及更旧版本：
sudo apt update && sudo apt install --only-upgrade libblockdev2 udisks2
```:cite[3]
```

  
1. **Debian用户**  
：安装更新的   

```
libblockdev
```

  
 和   

```
udisks2
```

  
 包。  
  
1. **Fedora及其他发行版用户**  
：  
**密切关注供应商安全公告**  
，第一时间打补丁。  
  
1. **临时配置加固（若无法立即打补丁）**  
：  
  
修改polkit规则，  
**提升 org.freedesktop.udisks2.modify-device 操作的鉴权要求**  
，将   

```
allow_active
```

  
 改为   

```
auth_admin
```

  
（需要管理员密码）。在   

```
/etc/polkit-1/rules.d/
```

  
 下创建一个规则文件（如   

```
99-udisks2-mitigation.rules
```

  
），内容如下：  

```
javascript
polkit.addRule(function(action, subject) {
  if (action.id == “org.freedesktop.udisks2.modify-device”) {
    return subject.active ? polkit.Result.AUTH_ADMIN : polkit.Result.NOT_HANDLED;
  }
});
```:cite[1]:cite[3]:cite[8]
此措施可阻断CVE-2025-6019的利用路径，但可能影响合法用户的设备管理操作。
```

  
1. **SUSE用户额外加固**  
：检查并修改PAM配置（尤其是   

```
/etc/pam.d/sshd
```

  
），  
**确保没有在 pam_systemd.so 之前启用 pam_env.so 的 user_readenv=1 选项**  
，以封堵CVE-2025-6018。  
  
1. **加强监控**  
：监控系统中   
**/tmp 目录下异常的环回设备（loop device）挂载行为**  
，这可能是攻击尝试的迹象。  
  
## 结论：立即行动，刻不容缓  
  
    CVE-2025-6018 和 CVE-2025-6019 组成的漏洞链代表了近期最具普遍性和严重性的Linux本地提权威胁之一。它巧妙地利用了Linux认证（PAM）和设备管理（udisks/libblockdev）子系统中的弱点，  
**几乎完全抹平了普通用户与超级管理员（root）之间的安全鸿沟**  
。  
  
    鉴于漏洞利用代码（PoC）的存在和漏洞利用的简便性，  
**所有运行受影响Linux发行版的个人用户、企业及服务器管理员都必须将此威胁视为最高优先级**  
。  
  
    最根本的解决方法是  
**立即应用发行商提供的安全补丁**  
。在补丁部署完成前，务必实施推荐的临时配置加固措施以降低风险。保持警惕，及时关注您所用发行版的安全公告，是防御此类高危漏洞的关键。  
  
免责声明：  
### 本人所有文章均为技术分享，均用于防御为目的的记录，所有操作均在实验环境下进行，请勿用于其他用途，否则后果自负。  
  
第二十七条：任何个人和组织不得从事非法侵入他人网络、干扰他人网络正常功能、窃取网络数据等危害网络安全的活动；不得提供专门用于从事侵入网络、干扰网络正常功能及防护措施、窃取网络数据等危害网络安全活动的程序和工具；明知他人从事危害网络安全的活动，不得为其提供技术支持、广告推广、支付结算等帮助  
  
第十二条：  国家保护公民、法人和其他组织依法使用网络的权利，促进网络接入普及，提升网络服务水平，为社会提供安全、便利的网络服务，保障网络信息依法有序自由流动。  
  
任何个人和组织使用网络应当遵守宪法法律，遵守公共秩序，尊重社会公德，不得危害网络安全，不得利用网络从事危害国家安全、荣誉和利益，煽动颠覆国家政权、推翻社会主义制度，煽动分裂国家、破坏国家统一，宣扬恐怖主义、极端主义，宣扬民族仇恨、民族歧视，传播暴力、淫秽色情信息，编造、传播虚假信息扰乱经济秩序和社会秩序，以及侵害他人名誉、隐私、知识产权和其他合法权益等活动。  
  
第十三条：  国家支持研究开发有利于未成年人健康成长的网络产品和服务，依法惩治利用网络从事危害未成年人身心健康的活动，为未成年人提供安全、健康的网络环境。  
  
  
  
  
  
