#  æˆ‘å¦‚ä½•å…¥ä¾µè·å…°æ”¿åºœï¼šåˆ©ç”¨æ— è¾œå›¾åƒè¿›è¡Œè¿œç¨‹ä»£ç æ‰§è¡Œ   
hai dragon  å®‰å…¨ç‹—çš„è‡ªæˆ‘ä¿®å…»   2025-02-15 23:03  
  
## èµ‹äºˆåŠ¨æœºï¼š  
> åœ¨ä¸€æ¬¡å®‰å…¨ä¼šè®®ä¸Šï¼Œæˆ‘çœ‹åˆ°ä¸€ä¸ªç©¿ç€ T æ¤çš„äººï¼Œä¸Šé¢å†™ç€â€œ**æˆ‘é»‘äº†è·å…°æ”¿åºœï¼Œæˆ‘å¾—åˆ°çš„åªæ˜¯è¿™ä»¶ç³Ÿç³•çš„ T æ¤ã€‚**  
å‡ºäºå¥½å¥‡ï¼Œæˆ‘èµ°è¿‘ä»–ï¼Œé—®ä»–æ˜¯æ€ä¹ˆå¾—åˆ°çš„ã€‚æˆ‘å†³å¿ƒè¦å¾—åˆ°é‚£ä¸ªå¾ˆé…·çš„èµƒç‰©ã€‚  
  
  
  
ç…§ç‰‡ç”±Â   
é˜¿å¾·é‡Œå®‰  
Â onÂ   
Unsplash  
## èŒƒå›´ï¼š  
  
æˆ‘å¼€å§‹å¯»æ‰¾æœºä¼šï¼Œå¹¶å¶ç„¶å‘ç°äº†ä¸€ä»½ç¬¦åˆÂ   
https://gist.github.com/R0X4R/81e6c50c091a20b060afe5c259b58cfa  
Â é”™è¯¯æœç´¢æ¡ä»¶çš„ç½‘ç«™åˆ—è¡¨ã€‚è¿™ä»½æ¸…å•æˆä¸ºæˆ‘çš„èµ·ç‚¹ã€‚  
## ç›®æ ‡ï¼š  
  
æˆ‘ä½¿ç”¨ httpx æ¥è¯„ä¼°åˆ—å‡ºçš„æ¯ä¸ªç½‘ç«™çš„å®æ—¶çŠ¶æ€ã€æŠ€æœ¯å †æ ˆã€HTTP çŠ¶æ€ä»£ç å’Œæ ‡é¢˜ã€‚è¿™ä½¿æˆ‘èƒ½å¤Ÿè·å¾—å¯¹åŸºç¡€è®¾æ–½çš„å®è´µè§è§£ã€‚  
```
```  
  
å½“æˆ‘æ£€æŸ¥è¿”å› 200 OK å“åº”çš„ç½‘ç«™çš„åŠŸèƒ½æ—¶ï¼Œæˆ‘æ³¨æ„åˆ°ä¸€ä¸ªç½‘ç«™æ­£åœ¨ä½¿ç”¨æœåŠ¡ã€‚æˆ‘å°è¯•ä½¿ç”¨ Nuclei è¿›è¡Œæ‰«æã€‚ä½†æ˜¯ï¼Œä½¿ç”¨ Nuclei æœªæ£€æµ‹åˆ°ä»»ä½•æ¼æ´ã€‚GeoServer  
## å‘ç°ï¼š  
  
æˆ‘å‘ç°è¯¥æœåŠ¡å…è®¸æˆ‘è®¿é—®å…¶åŠŸèƒ½ï¼Œè€Œæ— éœ€èº«ä»½éªŒè¯ã€‚æˆ‘å¯åŠ¨ Burp Suite å¹¶å¼€å§‹ä¸åº”ç”¨ç¨‹åºäº¤äº’ï¼Œæ¢æµ‹ç³»ç»Ÿå†…çš„æ¼æ´å’Œæ½œåœ¨çš„åˆ©ç”¨ç‚¹ã€‚  
  
æ‰€ä»¥ï¼Œæˆ‘å¯¹ GeoServer åšäº†ä¸€äº›ç ”ç©¶ã€‚å®ƒåŸºæœ¬ä¸Šæ˜¯ä¸€ä¸ªç”¨äºå…±äº«åœ°ç†ç©ºé—´æ•°æ®çš„å¼€æºæœåŠ¡å™¨ã€‚å®ƒæ”¯æŒÂ **WFSã€WMS**  
å’Œ**WCS**  
Â ç­‰æ ‡å‡†åè®®ã€‚æ­¤å¤–ï¼Œå®ƒè¿˜é™„å¸¦äº†Â **JAI-EXT API**  
ï¼Œè¯¥ API é»˜è®¤å¯ç”¨ï¼Œå¹¶æä¾›ç”¨äº**å›¾åƒå¤„ç†**  
çš„é«˜çº§å¯¹è±¡ã€‚  
  
**JAI-EXT é¡¹ç›®**  
åŒ…å«ä¸€ç§åä¸ºÂ Jiffle  
Â çš„æ˜ å°„ä»£æ•°è¯­è¨€ã€‚Jiffle  
Â æ˜¯ä¸€ç§ç”¨äºå¤„ç†å…‰æ …å›¾åƒçš„ç®€å•è„šæœ¬è¯­è¨€ã€‚å®ƒçš„ä¸»è¦ç›®æ ‡æ˜¯è®©æ‚¨ç”¨æ›´å°‘çš„ä»£ç å®Œæˆæ›´å¤šçš„å·¥ä½œã€‚  
  
ç»è¿‡æ·±å…¥ç ”ç©¶ï¼Œäº 2022 å¹´ 4 æœˆ 13 æ—¥å‘ç°äº† JT-JIFFLE æ‰©å±•çš„æ¼æ´ï¼Œè¢«ç¡®å®šä¸ºÂ **CVE-2022-24816**  
ã€‚  
## å¼€å‘ï¼š  
  
**è¯¥æ¼æ´å­˜åœ¨äº JAI-EXT åº“å¯¹ Jiffle è„šæœ¬ï¼ˆä¸€ç§æ˜ å°„ä»£æ•°è¯­è¨€ï¼‰çš„å¤„ç†ä¸­ã€‚**  
Jiffle è„šæœ¬æ—¨åœ¨åœ¨å—æ§ç¯å¢ƒä¸­å®‰å…¨åœ°ç¼–è¯‘å’Œæ‰§è¡Œã€‚ä½†æ˜¯ï¼Œç”±äºéªŒè¯ä¸å½“ï¼Œå›¾åƒ**æˆ–å…¶ä»–æ•°æ®ä¸­åµŒå…¥çš„æ¶æ„ Jiffle ä»£ç å¯èƒ½ä¼šè¢«æ³¨å…¥å¹¶åœ¨æ˜“å—æ”»å‡»çš„ç³»ç»Ÿä¸Šæ‰§è¡Œã€‚**  
ç„¶åï¼Œè¿™äº›æ¶æ„ä»£ç å¯ä»¥åˆ©ç”¨ JAI-EXT ä½¿ç”¨çš„ Janino Java ç¼–è¯‘å™¨ï¼Œæœ€ç»ˆå¯¼è‡´**å…·æœ‰å®Œæ•´ç³»ç»Ÿæƒé™çš„è¿œç¨‹ä»£ç æ‰§è¡Œ ï¼ˆRCEï¼‰ã€‚**  
  
è¿™ä¸ªè§£é‡Šä¿æŒç®€å•ï¼ŒåŒæ—¶å¼ºè°ƒäº†æ ¸å¿ƒé—®é¢˜ï¼š**ä¸æ­£ç¡®çš„ä»£ç æ³¨å…¥å¯¼è‡´é€šè¿‡ Jiffle è„šæœ¬å’Œ Janino ç¼–è¯‘å™¨è¿›è¡Œ RCEã€‚**  
  
  
https://github.com/geosolutions-it/jai-ext/commit/cb1d6565d38954676b0a366da4f965fef38da1cb  
  
é€šè¿‡æŸ¥çœ‹è¡¥ä¸Â [JAI-EXT-PATCH]ï¼Œå¯ä»¥å¿«é€Ÿç¡®å®šè¯¥æ–¹æ³•ä¸­æ·»åŠ äº† Javadoc æ³¨é‡Šè½¬ä¹‰ã€‚æ­£å¦‚æˆ‘ä»¬åœ¨ä¸Šé¢çœ‹åˆ°çš„ï¼ŒJiffleÂ ä½¿ç”¨æ­¤æ–¹æ³•å°† .it.geosolutions.jaiext.jiffle.parser.node.ScriptwritescriptModelJava source code  
  
ä¸€ç§æ–¹æ³•æ˜¯é¦–å…ˆä½¿ç”¨ WPS æ„å»ºå™¨æ¼”ç¤ºç½‘é¡µåˆ¶ä½œåˆé€‚çš„ WPS XML è¯·æ±‚ï¼š  
  
  
æ­¤æœ‰æ•ˆè´Ÿè½½ä¼šå¯¼è‡´ verbose ï¼šjavax.media.jai.util.ImagingException  
```
```  
  
å½“ JaninoÂ ç¼–è¯‘å™¨é‡åˆ°ä»¥ a å¼€å¤´çš„æœªæ³¨é‡Šè¡Œè€Œä¸æ˜¯é¢„æœŸçš„å…³é”®å­—ï¼ˆå¦‚Â classã€enum æˆ– interfaceï¼‰æ—¶ï¼Œå®ƒä¼šåœ¨å°†æºä»£ç è½¬æ¢ä¸ºå­—èŠ‚ç æ—¶é‡åˆ°å¤±è´¥ã€‚*  
  
è¦å°† Java ä»£ç æ³¨å…¥æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬è¿˜å¿…é¡»é€šè¿‡åŒ…å«å­—ç¬¦ä¸²æ¥çº æ­£å‰©ä½™çš„æ³¨é‡Šã€‚æˆ‘ä»¬çš„ payload å°†é‡‡ç”¨ä»¥ä¸‹å½¢å¼ï¼š/*  
```
```  
  
ç”± Jiffle ç”Ÿæˆçš„ Java ä»£ç ï¼Œå¯ä»¥è¦†ç›–åœ¨ç¨‹åºç»“æŸæ—¶åˆå§‹åŒ– result å˜é‡æ—¶ä½¿ç”¨çš„ Double ç±»ã€‚  
```
```  
  
å½“è®¿é—®æˆ‘ä»¬ä½œçš„ Double ç±»çš„é™æ€å±æ€§ NaN æ—¶ï¼Œå®ƒä¼šå¯åŠ¨é™æ€ä»£ç å—çš„æ‰§è¡Œã€‚ç”¨ä½œæ¦‚å¿µéªŒè¯çš„ Double ç±»æ¦‚è¿°å¦‚ä¸‹ï¼š  
```
```  
  
æ‰§è¡Œå‘½ä»¤å˜å¾—ç®€å•æ˜äº†ã€‚æˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹ Double ç±»æ¥å¯åŠ¨â€œâ€å‘½ä»¤çš„æ‰§è¡Œï¼šcat /etc/passwd  
  
  
cat /etc/passwd  
  
å°†æ­¤ä¸åˆå§‹æœ‰æ•ˆè´Ÿè½½ç›¸ç»“åˆä»¥è½¬ä¹‰ Java æ³¨é‡Šä¼šå¯¼è‡´ä»¥ä¸‹è¯·æ±‚ï¼š  
  
  
æ‰§è¡Œä¸Šè¿°è¯·æ±‚ä¼šå¯¼è‡´å¼‚å¸¸ï¼Œå…¶ä¸­åŒ…å«å·²æ‰§è¡Œå‘½ä»¤çš„è¾“å‡ºï¼šjava.lang.ExceptionInInitializerError  
  
  
/etc/passwd  
  
æˆ‘åˆ›å»ºäº†ä¸€ä¸ª Nuclei æ¨¡æ¿æ¥æ£€æµ‹æ­¤æ¼æ´ï¼Œæ‚¨å¯ä»¥åœ¨æ­¤ GitHub é“¾æ¥ä¸­æ‰¾åˆ°è¯¥æ¨¡æ¿ï¼š  
CVE-2022â€“24816.yaml  
ã€‚  
> æ—¶é—´çº¿ï¼š  
> 2022 å¹´ 12 æœˆ 22 æ—¥æŠ¥å‘Š  
> ç¡®è®¤äº 2022 å¹´ 12 æœˆ 23 æ—¥  
> 2023 å¹´ 3 æœˆ 24 æ—¥è·å¾—èµƒç‰©  
  
  
  
æ„Ÿè°¢æ‚¨èŠ±æ—¶é—´é˜…è¯»æˆ‘çš„åšå®¢ã€‚å¦‚æœæ‚¨è§‰å¾—è¿™äº›å†…å®¹æœ‰å¸®åŠ©æˆ–æœ‰è¶£ï¼Œè¯·è€ƒè™‘ç»™å®ƒæ‹æ‰‹å«å¥½ï¼ğŸ‘ éå¸¸æ„Ÿè°¢æ‚¨çš„æ”¯æŒã€‚  
  
  
  
å…¶å®ƒç›¸å…³è¯¾ç¨‹  
  
  
![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQEREkjoibjFst4F2YTlvkRG4zW4Nlt9pZBgFYgFxfVZFxu83EQnESej7ydiblH1UfHqKX3hBfcm76JiaSA/640?wx_fmt=png&from=appmsg "")  
  
![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQEREkjoibjFst4F2YTlvkRG4zW0h21TYuO94OrIGsD2aHGrUcUYiasibQS5AYJ4a95Ra3zIFIXQ4e8lkFA/640?wx_fmt=png&from=appmsg "")  
  
![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQEREkjoibjFst4F2YTlvkRG4zW6iapnXQ3Wviaiaiap37xFRqNok6BymcTiacnk07OowXYFowAKYfa9zS6gSA/640?wx_fmt=png&from=appmsg "")  
  
![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQEREkjoibjFst4F2YTlvkRG4zWiaJkE3jZRR7znMJDXAlibBzibYaGLMlVvsa1xhlQFyv3viaARicSIII7a9A/640?wx_fmt=png&from=appmsg "")  
#   
# æ–°è¯¾  
  
![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERF572V3vh5I1E9EjgxRc5ESuAcvkZaX6BbMo5zT4SibibbYX1gqb3HTVawSct6Oiau2kvT0PROsNTiaKQ/640?wx_fmt=png&from=appmsg "")  
#   
# è¯¦ç»†ç›®å½•  
# mac/ioså®‰å…¨è§†é¢‘  
  
![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERFbBn3mydWukVkxb7u4ibpOneTvEKRymYhW9KMlUWP1RnaXLuZibvPMdGmrdWVV3AMJya9dNxszgOeA/640?wx_fmt=png&from=appmsg "")  
# QTå¼€å‘åº•å±‚åŸç†ä¸å®‰å…¨é€†å‘è§†é¢‘æ•™ç¨‹  
  
![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERGLucgfllJsyUEFRxtnUNkLfUhNeUCnH7x8VtPq0Q2zxZBdhjqiaibsx0rIbaYWMuIibmk5QtNPzsOSw/640?wx_fmt=png&from=appmsg "")  
  
linuxæ–‡ä»¶ç³»ç»Ÿå­˜å‚¨ä¸æ–‡ä»¶è¿‡æ»¤å®‰å…¨å¼€å‘è§†é¢‘æ•™ç¨‹(2024æœ€æ–°)  
  
![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERHSM6Wk8NAEmbHHUS2brkROr9JOj6WZCwGz4gE4MlibULVefmhRw2dvJd8ZeYnDpRIm0AV1TmIsuEQ/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
linuxé«˜çº§usbå®‰å…¨å¼€å‘ä¸æºç åˆ†æè§†é¢‘æ•™ç¨‹  
  
![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERHCd9Qic4AAIQfFFD7Rabvry4pqowTdAw6HyVbkibwH5NjRTU4Mibeo4JbMRD3XplqCRzg4Kiaib3jchSw/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
**linuxç¨‹åºè®¾è®¡ä¸å®‰å…¨å¼€å‘**  
  
![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERGoVibbKav1DpliaTJ9icDrosqXeWyaMRJdCVWEG0VYLDibSMwUP1L5r9XmLibGkEkSZnXjPD6mWgkib9lA/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
  
****- ![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERHhezg9PuKylWLTBfCjokEH4eXCW471pNuHpGPzUKCkbyticiayoQ5gxMtoR1AX0QS7JJ2v1Miaibv1lA/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
- #   
  
-   
- w  
i  
n  
d  
o  
w  
s  
ç½‘  
ç»œ  
å®‰  
å…¨  
é˜²  
ç«  
å¢™  
ä¸  
è™š  
æ‹Ÿ  
ç½‘  
å¡  
ï¼ˆ  
æ›´  
æ–°  
å®Œ  
æˆ  
ï¼‰  
  
- ![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERE5qcRgQueCyt3U01ySnOUp2wOmiaFhcXibibk6kjPoUhTeftn9aOHJjO6mZIIHRCBqIZ1ok5UjibLMRA/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
- w  
i  
n  
d  
o  
w  
s  
æ–‡  
ä»¶  
è¿‡  
æ»¤  
(  
æ›´  
æ–°  
å®Œ  
æˆ  
)  
  
- ![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERHhezg9PuKylWLTBfCjokEHmvkF91T2mwk3lSlbG5CELC5qbib3qMOgHvow2cvl6ibicVH4KguzibAQOQ/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
- U  
S  
B  
è¿‡  
æ»¤  
(  
æ›´  
æ–°  
å®Œ  
æˆ  
)  
  
- ![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERHhezg9PuKylWLTBfCjokEHv0vyWxLx9Sb68ssCJQwXngPmKDw2HNnvkrcle2picUraHyrTG2sSK7A/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
- æ¸¸  
æˆ  
å®‰  
å…¨  
(  
æ›´  
æ–°  
ä¸­  
)  
  
- ![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERHhezg9PuKylWLTBfCjokEHzEAlXtdkXShqbkibJUKumsvo65lnP6lXVR7nr5hq4PmDZdTIoky8mCg/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
- i  
o  
s  
é€†  
å‘  
  
- ![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERHhezg9PuKylWLTBfCjokEHmjrTM3epTpceRpaWpibzMicNtpMIacEWvJMLpKKkwmA97XsDia4StFr1Q/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
- w  
i  
n  
d  
b  
g  
  
- ![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERECMA4FBVNaHekaDaROKFEibv9VNhRI73qFehic91I5dsr3Jkh6EkHIRTPGibESZicD7IeA5ocHjexHhw/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
- è¿˜  
æœ‰  
å¾ˆ  
å¤š  
å…  
è´¹  
æ•™  
ç¨‹  
(  
é™  
å­¦  
å‘˜  
)  
  
- ![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERHhezg9PuKylWLTBfCjokEHDvveGEwLYBVsps1sH6rGrSnNZtjD2pzCk4EwhH3yeVNibMMSxsW5jkg/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERECMA4FBVNaHekaDaROKFEibR2Viaxgog8I2gicVHoXJODoqtq7tTVGybA8W0rTYaAkLcp8e2ByCd1QQ/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERECMA4FBVNaHekaDaROKFEibDwwqQLTNPnzDQxtQUF6JjxyxDoNGsr6XoNLicwxOeYfFia0whaxu6VXA/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
- ![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQEREEHMPaJ2RMX7CPES3mic42r1Wub102J6lAmEwKIicDfADiajsEReibfvSCbmiaRlGRCQibqfJJia0iak421Q/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
-   
- **windowsæ¶æ„è½¯ä»¶å¼€å‘ä¸å¯¹æŠ—è§†é¢‘æ•™ç¨‹**  
  
-   
- ![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERFPap5AiahwlmRC2MGPDXSULNssTzKQk8b4K3pttYKPjVL4xPVu1WHTmddAZialrGo8nQB3dJfJvlZQ/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
- ![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERHYgfyicoHWcBVxH85UOBNaPMJPjIWnCTP3EjrhOXhJsryIkR34mCwqetPF7aRmbhnxBbiaicS0rwu6w/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
- Â   
  
- ![å›¾ç‰‡](https://mmbiz.qpic.cn/sz_mmbiz_png/vBZcZNVQERHYgfyicoHWcBVxH85UOBNaPZeRlpCaIfwnM0IM4vnVugkAyDFJlhe1Rkalbz0a282U9iaVU12iaEiahw/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
